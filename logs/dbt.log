2021-02-16 21:52:48.573403 (MainThread): Running with dbt=0.18.1
2021-02-16 21:52:48.841922 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.rpc.server.RPCServerTask'>, debug=False, defer=None, exclude=None, host='0.0.0.0', log_cache_events=False, log_format='default', models=None, partial_parse=True, port=8580, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='rpc', write_json=True)
2021-02-16 21:52:48.866292 (MainThread): Tracking: tracking
2021-02-16 21:52:48.866487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc84695c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc696456d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc68ddd3a0>]}
2021-02-16 21:52:48.866801 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=15
2021-02-16 21:52:48.867204 (MainThread): Supported methods: ['cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'status', 'test']
2021-02-16 21:52:48.867490 (MainThread): Send requests to http://localhost:8580/jsonrpc
2021-02-16 21:52:48.872668 (Thread-1): Parsing macros/grant_select_on_schemas.sql
2021-02-16 21:52:48.876273 (Thread-1): Parsing macros/get_custom_schema.sql
2021-02-16 21:52:48.877282 (Thread-1): Parsing macros/adapters.sql
2021-02-16 21:52:48.905796 (Thread-1): Parsing macros/catalog.sql
2021-02-16 21:52:48.907786 (Thread-1): Parsing macros/materializations/table.sql
2021-02-16 21:52:48.911563 (Thread-1): Parsing macros/materializations/merge.sql
2021-02-16 21:52:48.913489 (Thread-1): Parsing macros/materializations/view.sql
2021-02-16 21:52:48.914926 (Thread-1): Parsing macros/materializations/incremental.sql
2021-02-16 21:52:48.924785 (Thread-1): Parsing macros/core.sql
2021-02-16 21:52:48.928366 (Thread-1): Parsing macros/adapters/common.sql
2021-02-16 21:52:48.972632 (Thread-1): Parsing macros/materializations/helpers.sql
2021-02-16 21:52:48.981237 (Thread-1): Parsing macros/materializations/table/table.sql
2021-02-16 21:52:48.987766 (Thread-1): Parsing macros/materializations/seed/seed.sql
2021-02-16 21:52:49.007772 (Thread-1): Parsing macros/materializations/view/view.sql
2021-02-16 21:52:49.014033 (Thread-1): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-16 21:52:49.018839 (Thread-1): Parsing macros/materializations/incremental/helpers.sql
2021-02-16 21:52:49.020665 (Thread-1): Parsing macros/materializations/incremental/incremental.sql
2021-02-16 21:52:49.026556 (Thread-1): Parsing macros/materializations/common/merge.sql
2021-02-16 21:52:49.040022 (Thread-1): Parsing macros/materializations/snapshot/strategies.sql
2021-02-16 21:52:49.056981 (Thread-1): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-16 21:52:49.057684 (Thread-2): handling status request
2021-02-16 21:52:49.059713 (Thread-2): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc68dac610>]}
2021-02-16 21:52:49.061420 (Thread-2): sending response (<Response 185 bytes [200 OK]>) to 10.0.12.71
2021-02-16 21:52:49.062122 (Thread-1): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-16 21:52:49.090143 (Thread-1): Parsing macros/schema_tests/relationships.sql
2021-02-16 21:52:49.092104 (Thread-1): Parsing macros/schema_tests/not_null.sql
2021-02-16 21:52:49.093719 (Thread-1): Parsing macros/schema_tests/unique.sql
2021-02-16 21:52:49.095441 (Thread-1): Parsing macros/schema_tests/accepted_values.sql
2021-02-16 21:52:49.098073 (Thread-1): Parsing macros/etc/get_custom_database.sql
2021-02-16 21:52:49.099797 (Thread-1): Parsing macros/etc/query.sql
2021-02-16 21:52:49.100852 (Thread-1): Parsing macros/etc/datetime.sql
2021-02-16 21:52:49.109570 (Thread-1): Parsing macros/etc/get_custom_alias.sql
2021-02-16 21:52:49.110523 (Thread-1): Parsing macros/etc/is_incremental.sql
2021-02-16 21:52:49.112250 (Thread-1): Parsing macros/etc/get_custom_schema.sql
2021-02-16 21:52:49.120192 (Thread-1): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - jaffleshop

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-16 21:52:49.120519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc68d92520>]}
2021-02-16 21:52:49.168592 (Thread-1): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-0".
2021-02-16 21:52:49.184341 (Thread-1): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-1".
2021-02-16 21:52:49.396468 (Thread-1): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:52:50.330573 (Thread-3): handling status request
2021-02-16 21:52:50.331000 (Thread-3): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc69686d30>]}
2021-02-16 21:52:50.334403 (Thread-3): sending response (<Response 10753 bytes [200 OK]>) to 10.0.45.116
2021-02-16 21:53:13.097832 (MainThread): Connection 'operation.jaffleshop.jaffleshop-on-run-end-1' was properly closed.
2021-02-16 21:53:13.145614 (Thread-4): Got an acceptable cached parse result
2021-02-16 21:53:13.294968 (Thread-4): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:53:13.355983 (Thread-5): handling status request
2021-02-16 21:53:13.356426 (Thread-5): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6823b850>]}
2021-02-16 21:53:13.357381 (Thread-5): sending response (<Response 852 bytes [200 OK]>) to 10.0.2.84
2021-02-16 21:53:21.295250 (Thread-6): Got an acceptable cached parse result
2021-02-16 21:53:21.452641 (Thread-6): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:53:21.454745 (Thread-7): handling status request
2021-02-16 21:53:21.455095 (Thread-7): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63fa7220>]}
2021-02-16 21:53:21.455982 (Thread-7): sending response (<Response 852 bytes [200 OK]>) to 10.0.26.193
2021-02-16 21:53:30.410325 (Thread-8): Got an acceptable cached parse result
2021-02-16 21:53:30.565694 (Thread-9): handling status request
2021-02-16 21:53:30.566097 (Thread-9): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6813dbe0>]}
2021-02-16 21:53:30.566787 (Thread-9): sending response (<Response 185 bytes [200 OK]>) to 10.0.28.71
2021-02-16 21:53:30.607325 (Thread-8): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:53:31.860863 (Thread-10): handling status request
2021-02-16 21:53:31.861287 (Thread-10): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc682cc850>]}
2021-02-16 21:53:31.862218 (Thread-10): sending response (<Response 852 bytes [200 OK]>) to 10.0.23.61
2021-02-16 21:53:39.321436 (Thread-11): Got an acceptable cached parse result
2021-02-16 21:53:39.507168 (Thread-11): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:53:39.521404 (Thread-12): handling status request
2021-02-16 21:53:39.521769 (Thread-12): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc681748b0>]}
2021-02-16 21:53:39.522797 (Thread-12): sending response (<Response 854 bytes [200 OK]>) to 10.0.47.142
2021-02-16 21:54:01.661645 (Thread-13): handling status request
2021-02-16 21:54:01.663363 (Thread-13): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc6808d070>]}
2021-02-16 21:54:01.664258 (Thread-13): sending response (<Response 854 bytes [200 OK]>) to 10.0.4.47
2021-02-16 21:54:07.635255 (Thread-14): Parsing macros/grant_select_on_schemas.sql
2021-02-16 21:54:07.639055 (Thread-14): Parsing macros/get_custom_schema.sql
2021-02-16 21:54:07.640069 (Thread-14): Parsing macros/adapters.sql
2021-02-16 21:54:07.668810 (Thread-14): Parsing macros/catalog.sql
2021-02-16 21:54:07.670798 (Thread-14): Parsing macros/materializations/table.sql
2021-02-16 21:54:07.674659 (Thread-14): Parsing macros/materializations/merge.sql
2021-02-16 21:54:07.676681 (Thread-14): Parsing macros/materializations/view.sql
2021-02-16 21:54:07.678135 (Thread-14): Parsing macros/materializations/incremental.sql
2021-02-16 21:54:07.688080 (Thread-14): Parsing macros/core.sql
2021-02-16 21:54:07.691759 (Thread-14): Parsing macros/adapters/common.sql
2021-02-16 21:54:07.739266 (Thread-14): Parsing macros/materializations/helpers.sql
2021-02-16 21:54:07.748387 (Thread-14): Parsing macros/materializations/table/table.sql
2021-02-16 21:54:07.755008 (Thread-14): Parsing macros/materializations/seed/seed.sql
2021-02-16 21:54:07.777844 (Thread-14): Parsing macros/materializations/view/view.sql
2021-02-16 21:54:07.784118 (Thread-14): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-16 21:54:07.789081 (Thread-14): Parsing macros/materializations/incremental/helpers.sql
2021-02-16 21:54:07.791278 (Thread-14): Parsing macros/materializations/incremental/incremental.sql
2021-02-16 21:54:07.797200 (Thread-15): handling status request
2021-02-16 21:54:07.798719 (Thread-15): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63ebe430>]}
2021-02-16 21:54:07.798914 (Thread-14): Parsing macros/materializations/common/merge.sql
2021-02-16 21:54:07.806153 (Thread-15): sending response (<Response 185 bytes [200 OK]>) to 10.0.28.71
2021-02-16 21:54:07.820547 (Thread-14): Parsing macros/materializations/snapshot/strategies.sql
2021-02-16 21:54:07.837251 (Thread-14): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-16 21:54:07.838994 (Thread-14): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-16 21:54:07.866604 (Thread-14): Parsing macros/schema_tests/relationships.sql
2021-02-16 21:54:07.868555 (Thread-14): Parsing macros/schema_tests/not_null.sql
2021-02-16 21:54:07.870086 (Thread-14): Parsing macros/schema_tests/unique.sql
2021-02-16 21:54:07.871815 (Thread-14): Parsing macros/schema_tests/accepted_values.sql
2021-02-16 21:54:07.874431 (Thread-14): Parsing macros/etc/get_custom_database.sql
2021-02-16 21:54:07.876109 (Thread-14): Parsing macros/etc/query.sql
2021-02-16 21:54:07.877161 (Thread-14): Parsing macros/etc/datetime.sql
2021-02-16 21:54:07.885764 (Thread-14): Parsing macros/etc/get_custom_alias.sql
2021-02-16 21:54:07.886717 (Thread-14): Parsing macros/etc/is_incremental.sql
2021-02-16 21:54:07.888308 (Thread-14): Parsing macros/etc/get_custom_schema.sql
2021-02-16 21:54:08.030741 (Thread-14): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-0".
2021-02-16 21:54:08.036423 (Thread-14): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-1".
2021-02-16 21:54:08.149940 (Thread-14): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:54:09.038068 (Thread-16): handling status request
2021-02-16 21:54:09.038492 (Thread-16): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63f87d60>]}
2021-02-16 21:54:09.041711 (Thread-16): sending response (<Response 9693 bytes [200 OK]>) to 10.0.23.61
2021-02-16 21:54:24.098869 (Thread-17): handling status request
2021-02-16 21:54:24.099328 (Thread-17): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63f3a3a0>]}
2021-02-16 21:54:24.102548 (Thread-17): sending response (<Response 9693 bytes [200 OK]>) to 10.0.23.61
2021-02-16 21:54:29.491498 (MainThread): Connection 'operation.jaffleshop.jaffleshop-on-run-end-1' was properly closed.
2021-02-16 21:54:29.517362 (Thread-18): Parsing macros/grant_select_on_schemas.sql
2021-02-16 21:54:29.520775 (Thread-18): Parsing macros/get_custom_schema.sql
2021-02-16 21:54:29.521757 (Thread-18): Parsing macros/adapters.sql
2021-02-16 21:54:29.551174 (Thread-18): Parsing macros/catalog.sql
2021-02-16 21:54:29.553141 (Thread-18): Parsing macros/materializations/table.sql
2021-02-16 21:54:29.556903 (Thread-18): Parsing macros/materializations/merge.sql
2021-02-16 21:54:29.558813 (Thread-18): Parsing macros/materializations/view.sql
2021-02-16 21:54:29.560264 (Thread-18): Parsing macros/materializations/incremental.sql
2021-02-16 21:54:29.570068 (Thread-18): Parsing macros/core.sql
2021-02-16 21:54:29.573615 (Thread-18): Parsing macros/adapters/common.sql
2021-02-16 21:54:29.616564 (Thread-18): Parsing macros/materializations/helpers.sql
2021-02-16 21:54:29.625644 (Thread-18): Parsing macros/materializations/table/table.sql
2021-02-16 21:54:29.632186 (Thread-18): Parsing macros/materializations/seed/seed.sql
2021-02-16 21:54:29.652165 (Thread-18): Parsing macros/materializations/view/view.sql
2021-02-16 21:54:29.658158 (Thread-18): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-16 21:54:29.662929 (Thread-18): Parsing macros/materializations/incremental/helpers.sql
2021-02-16 21:54:29.668361 (Thread-18): Parsing macros/materializations/incremental/incremental.sql
2021-02-16 21:54:29.674826 (Thread-19): handling status request
2021-02-16 21:54:29.675279 (Thread-18): Parsing macros/materializations/common/merge.sql
2021-02-16 21:54:29.675429 (Thread-19): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63ece610>]}
2021-02-16 21:54:29.690035 (Thread-19): sending response (<Response 185 bytes [200 OK]>) to 10.0.26.193
2021-02-16 21:54:29.690588 (Thread-18): Parsing macros/materializations/snapshot/strategies.sql
2021-02-16 21:54:29.706816 (Thread-18): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-16 21:54:29.708593 (Thread-18): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-16 21:54:29.736942 (Thread-18): Parsing macros/schema_tests/relationships.sql
2021-02-16 21:54:29.738817 (Thread-18): Parsing macros/schema_tests/not_null.sql
2021-02-16 21:54:29.740347 (Thread-18): Parsing macros/schema_tests/unique.sql
2021-02-16 21:54:29.742028 (Thread-18): Parsing macros/schema_tests/accepted_values.sql
2021-02-16 21:54:29.744658 (Thread-18): Parsing macros/etc/get_custom_database.sql
2021-02-16 21:54:29.746262 (Thread-18): Parsing macros/etc/query.sql
2021-02-16 21:54:29.747659 (Thread-18): Parsing macros/etc/datetime.sql
2021-02-16 21:54:29.756634 (Thread-18): Parsing macros/etc/get_custom_alias.sql
2021-02-16 21:54:29.757619 (Thread-18): Parsing macros/etc/is_incremental.sql
2021-02-16 21:54:29.759487 (Thread-18): Parsing macros/etc/get_custom_schema.sql
2021-02-16 21:54:29.798890 (Thread-18): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-0".
2021-02-16 21:54:29.804639 (Thread-18): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-1".
2021-02-16 21:54:29.916954 (Thread-18): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:54:31.014882 (Thread-20): handling status request
2021-02-16 21:54:31.015348 (Thread-20): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63ddb040>]}
2021-02-16 21:54:31.018560 (Thread-20): sending response (<Response 9693 bytes [200 OK]>) to 10.0.47.142
2021-02-16 21:54:43.769257 (Thread-21): handling status request
2021-02-16 21:54:43.769682 (Thread-21): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63f3a070>]}
2021-02-16 21:54:43.772839 (Thread-21): sending response (<Response 9693 bytes [200 OK]>) to 10.0.40.139
2021-02-16 21:54:48.177968 (Thread-22): handling status request
2021-02-16 21:54:48.178384 (Thread-22): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63e703a0>]}
2021-02-16 21:54:48.181568 (Thread-22): sending response (<Response 9693 bytes [200 OK]>) to 10.0.34.81
2021-02-16 21:54:53.304475 (MainThread): Connection 'operation.jaffleshop.jaffleshop-on-run-end-1' was properly closed.
2021-02-16 21:54:53.332616 (Thread-23): Parsing macros/grant_select_on_schemas.sql
2021-02-16 21:54:53.336106 (Thread-23): Parsing macros/get_custom_schema.sql
2021-02-16 21:54:53.337194 (Thread-23): Parsing macros/adapters.sql
2021-02-16 21:54:53.365030 (Thread-23): Parsing macros/catalog.sql
2021-02-16 21:54:53.367030 (Thread-23): Parsing macros/materializations/table.sql
2021-02-16 21:54:53.374813 (Thread-23): Parsing macros/materializations/merge.sql
2021-02-16 21:54:53.378043 (Thread-23): Parsing macros/materializations/view.sql
2021-02-16 21:54:53.380375 (Thread-23): Parsing macros/materializations/incremental.sql
2021-02-16 21:54:53.396783 (Thread-23): Parsing macros/core.sql
2021-02-16 21:54:53.402641 (Thread-23): Parsing macros/adapters/common.sql
2021-02-16 21:54:53.456832 (Thread-23): Parsing macros/materializations/helpers.sql
2021-02-16 21:54:53.465856 (Thread-23): Parsing macros/materializations/table/table.sql
2021-02-16 21:54:53.477937 (Thread-23): Parsing macros/materializations/seed/seed.sql
2021-02-16 21:54:53.498580 (Thread-24): handling status request
2021-02-16 21:54:53.498784 (Thread-23): Parsing macros/materializations/view/view.sql
2021-02-16 21:54:53.499212 (Thread-24): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63ec4130>]}
2021-02-16 21:54:53.506106 (Thread-24): sending response (<Response 185 bytes [200 OK]>) to 10.0.17.191
2021-02-16 21:54:53.506665 (Thread-23): Parsing macros/materializations/view/create_or_replace_view.sql
2021-02-16 21:54:53.511703 (Thread-23): Parsing macros/materializations/incremental/helpers.sql
2021-02-16 21:54:53.513614 (Thread-23): Parsing macros/materializations/incremental/incremental.sql
2021-02-16 21:54:53.520155 (Thread-23): Parsing macros/materializations/common/merge.sql
2021-02-16 21:54:53.539754 (Thread-23): Parsing macros/materializations/snapshot/strategies.sql
2021-02-16 21:54:53.556117 (Thread-23): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-02-16 21:54:53.557881 (Thread-23): Parsing macros/materializations/snapshot/snapshot.sql
2021-02-16 21:54:53.585721 (Thread-23): Parsing macros/schema_tests/relationships.sql
2021-02-16 21:54:53.587610 (Thread-23): Parsing macros/schema_tests/not_null.sql
2021-02-16 21:54:53.589123 (Thread-23): Parsing macros/schema_tests/unique.sql
2021-02-16 21:54:53.590841 (Thread-23): Parsing macros/schema_tests/accepted_values.sql
2021-02-16 21:54:53.593549 (Thread-23): Parsing macros/etc/get_custom_database.sql
2021-02-16 21:54:53.595207 (Thread-23): Parsing macros/etc/query.sql
2021-02-16 21:54:53.596263 (Thread-23): Parsing macros/etc/datetime.sql
2021-02-16 21:54:53.604911 (Thread-23): Parsing macros/etc/get_custom_alias.sql
2021-02-16 21:54:53.605870 (Thread-23): Parsing macros/etc/is_incremental.sql
2021-02-16 21:54:53.607477 (Thread-23): Parsing macros/etc/get_custom_schema.sql
2021-02-16 21:54:53.646119 (Thread-23): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-0".
2021-02-16 21:54:53.652352 (Thread-23): Acquiring new snowflake connection "operation.jaffleshop.jaffleshop-on-run-end-1".
2021-02-16 21:54:53.770817 (Thread-23): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models

2021-02-16 21:54:54.736282 (Thread-25): handling status request
2021-02-16 21:54:54.736709 (Thread-25): Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '430d0d8d-8f78-41cc-82f9-66c2d67bcb7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc63e704f0>]}
2021-02-16 21:54:54.740074 (Thread-25): sending response (<Response 9693 bytes [200 OK]>) to 10.0.1.7
2021-02-16 21:55:56.238808 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc696456d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc84695c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc68dd78b0>]}
2021-02-16 21:55:56.240924 (MainThread): Flushing usage events
2021-02-16 21:55:56.353798 (MainThread): Connection 'operation.jaffleshop.jaffleshop-on-run-end-1' was properly closed.
2021-02-16 21:55:56.361467 (MainThread): Runtime Error
  at path ['name']: 'dbt-poc' does not match '^[^\\d\\W]\\w*$'

Error encountered in /usr/src/develop/user-16228/environment-20170/repository-16369/dbt_project.yml
2021-02-17 23:25:20.293544 (MainThread): Running with dbt=0.18.0
2021-02-17 23:25:21.890616 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-17 23:25:21.892610 (MainThread): Tracking: tracking
2021-02-17 23:25:21.893765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C5700248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C3550FC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C35500C8>]}
2021-02-17 23:25:21.921685 (MainThread): Partial parsing not enabled
2021-02-17 23:25:21.923681 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-17 23:25:21.925675 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-17 23:25:21.929665 (MainThread): Parsing macros\adapters.sql
2021-02-17 23:25:21.994331 (MainThread): Parsing macros\catalog.sql
2021-02-17 23:25:21.997322 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-17 23:25:22.011782 (MainThread): Parsing macros\materializations\merge.sql
2021-02-17 23:25:22.015626 (MainThread): Parsing macros\materializations\table.sql
2021-02-17 23:25:22.021610 (MainThread): Parsing macros\materializations\view.sql
2021-02-17 23:25:22.030252 (MainThread): Parsing macros\core.sql
2021-02-17 23:25:22.037072 (MainThread): Parsing macros\adapters\common.sql
2021-02-17 23:25:22.098596 (MainThread): Parsing macros\etc\datetime.sql
2021-02-17 23:25:22.111482 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-17 23:25:22.113961 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-17 23:25:22.116949 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-17 23:25:22.119941 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-17 23:25:22.121936 (MainThread): Parsing macros\etc\query.sql
2021-02-17 23:25:22.123931 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-17 23:25:22.137898 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-17 23:25:22.157850 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-17 23:25:22.160842 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-17 23:25:22.170818 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-17 23:25:22.199648 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-17 23:25:22.246757 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-17 23:25:22.249748 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-17 23:25:22.273401 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-17 23:25:22.283214 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-17 23:25:22.290192 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-17 23:25:22.299062 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-17 23:25:22.303052 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-17 23:25:22.305051 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-17 23:25:22.308043 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-17 23:25:22.316022 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-17 23:25:22.317019 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51785747-270d-46ef-ac9f-184276eb0b86', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C570E788>]}
2021-02-17 23:25:22.318018 (MainThread): Partial parsing not enabled
2021-02-17 23:25:22.366816 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-17 23:25:22.393709 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-0".
2021-02-17 23:25:22.402675 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-1".
2021-02-17 23:25:22.607655 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 2 operations, 0 seed files, 0 sources
2021-02-17 23:25:22.608652 (MainThread): 
2021-02-17 23:25:22.609647 (MainThread): Acquiring new snowflake connection "master".
2021-02-17 23:25:22.614393 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-17 23:25:22.634232 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-17 23:25:22.634232 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-17 23:25:22.635230 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-17 23:25:24.474837 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.84 seconds
2021-02-17 23:25:24.481362 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-17 23:25:24.756408 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DBT_POC_dbt_[user_name]".
2021-02-17 23:25:24.756408 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "create_DBT_POC_dbt_[user_name]".
2021-02-17 23:25:24.756408 (ThreadPoolExecutor-0_0): Creating schema "DBT_POC.dbt_[user_name]"
2021-02-17 23:25:24.762392 (ThreadPoolExecutor-0_0): Using snowflake connection "create_DBT_POC_dbt_[user_name]".
2021-02-17 23:25:24.762392 (ThreadPoolExecutor-0_0): On create_DBT_POC_dbt_[user_name]: BEGIN
2021-02-17 23:25:24.762392 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2021-02-17 23:25:25.671743 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 1 in 0.91 seconds
2021-02-17 23:25:25.671743 (ThreadPoolExecutor-0_0): Using snowflake connection "create_DBT_POC_dbt_[user_name]".
2021-02-17 23:25:25.671743 (ThreadPoolExecutor-0_0): On create_DBT_POC_dbt_[user_name]: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "create_DBT_POC_dbt_[user_name]"} */
create schema if not exists DBT_POC.dbt_[user_name]
2021-02-17 23:25:25.956772 (ThreadPoolExecutor-0_0): Snowflake query id: 019a5c5d-059e-b34d-0000-40150030207a
2021-02-17 23:25:25.957770 (ThreadPoolExecutor-0_0): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 1 at position 40 unexpected '['.
2021-02-17 23:25:25.957770 (ThreadPoolExecutor-0_0): Error running SQL: macro create_schema
2021-02-17 23:25:25.957770 (ThreadPoolExecutor-0_0): Rolling back transaction.
2021-02-17 23:25:25.957770 (ThreadPoolExecutor-0_0): On create_DBT_POC_dbt_[user_name]: ROLLBACK
2021-02-17 23:25:26.352928 (ThreadPoolExecutor-0_0): On create_DBT_POC_dbt_[user_name]: Close
2021-02-17 23:25:26.618677 (MainThread): Connection 'master' was properly closed.
2021-02-17 23:25:26.618677 (MainThread): Connection 'create_DBT_POC_dbt_[user_name]' was properly closed.
2021-02-17 23:25:26.618677 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C57145C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C596EE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232C5801C88>]}
2021-02-17 23:25:26.618677 (MainThread): Flushing usage events
2021-02-17 23:25:27.111562 (MainThread): Encountered an error:
2021-02-17 23:25:27.111562 (MainThread): Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 40 unexpected '['.
2021-02-17 23:25:27.134501 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 1 at position 40 unexpected '['.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 379, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 394, in before_run
    self.create_schemas(adapter, selected_uids)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 523, in create_schemas
    create_future.result()
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\concurrent\futures\_base.py", line 428, in result
    return self.__get_result()
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\concurrent\futures\_base.py", line 384, in __get_result
    raise self._exception
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\concurrent\futures\thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\utils.py", line 469, in connected
    return func(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 485, in create_schema
    adapter.create_schema(relation)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\impl.py", line 182, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 984, in execute_macro
    result = macro_function(**kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  001003 (42000): SQL compilation error:
  syntax error line 1 at position 40 unexpected '['.

2021-02-17 23:27:13.180024 (MainThread): Running with dbt=0.18.0
2021-02-17 23:27:14.003350 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-17 23:27:14.004334 (MainThread): Tracking: tracking
2021-02-17 23:27:14.004334 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E299E0C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DA7F388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DA7FFC8>]}
2021-02-17 23:27:14.030218 (MainThread): Partial parsing not enabled
2021-02-17 23:27:14.031216 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-17 23:27:14.032213 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-17 23:27:14.035205 (MainThread): Parsing macros\adapters.sql
2021-02-17 23:27:14.074195 (MainThread): Parsing macros\catalog.sql
2021-02-17 23:27:14.077135 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-17 23:27:14.093090 (MainThread): Parsing macros\materializations\merge.sql
2021-02-17 23:27:14.095084 (MainThread): Parsing macros\materializations\table.sql
2021-02-17 23:27:14.100072 (MainThread): Parsing macros\materializations\view.sql
2021-02-17 23:27:14.105058 (MainThread): Parsing macros\core.sql
2021-02-17 23:27:14.109047 (MainThread): Parsing macros\adapters\common.sql
2021-02-17 23:27:14.162895 (MainThread): Parsing macros\etc\datetime.sql
2021-02-17 23:27:14.172907 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-17 23:27:14.174861 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-17 23:27:14.176885 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-17 23:27:14.178883 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-17 23:27:14.180875 (MainThread): Parsing macros\etc\query.sql
2021-02-17 23:27:14.182870 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-17 23:27:14.193466 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-17 23:27:14.210483 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-17 23:27:14.213485 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-17 23:27:14.220491 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-17 23:27:14.246067 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-17 23:27:14.282868 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-17 23:27:14.285484 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-17 23:27:14.305059 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-17 23:27:14.313986 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-17 23:27:14.319992 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-17 23:27:14.327971 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-17 23:27:14.330969 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-17 23:27:14.332959 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-17 23:27:14.334868 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-17 23:27:14.342875 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-17 23:27:14.342875 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ff6fc46f-ed75-404a-8738-c6b23e14effe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DACB088>]}
2021-02-17 23:27:14.344318 (MainThread): Partial parsing not enabled
2021-02-17 23:27:14.393709 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-17 23:27:14.418642 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-0".
2021-02-17 23:27:14.426621 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-1".
2021-02-17 23:27:14.637959 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 2 operations, 0 seed files, 0 sources
2021-02-17 23:27:14.638956 (MainThread): 
2021-02-17 23:27:14.639954 (MainThread): Acquiring new snowflake connection "master".
2021-02-17 23:27:14.644993 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-17 23:27:14.660986 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-17 23:27:14.660986 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-17 23:27:14.660986 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-17 23:27:15.767033 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.11 seconds
2021-02-17 23:27:15.772049 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-17 23:27:16.112804 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-17 23:27:16.120753 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-17 23:27:16.120753 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-17 23:27:16.120753 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-17 23:27:17.113887 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 0.99 seconds
2021-02-17 23:27:17.119872 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-17 23:27:17.392951 (MainThread): Using snowflake connection "master".
2021-02-17 23:27:17.392951 (MainThread): On master: BEGIN
2021-02-17 23:27:17.392951 (MainThread): Opening a new connection, currently in state init
2021-02-17 23:27:18.225673 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-02-17 23:27:18.226671 (MainThread): On master: COMMIT
2021-02-17 23:27:18.226671 (MainThread): Using snowflake connection "master".
2021-02-17 23:27:18.226671 (MainThread): On master: COMMIT
2021-02-17 23:27:18.660044 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-17 23:27:18.660044 (MainThread): On master: Close
2021-02-17 23:27:18.992000 (MainThread): 17:27:18 | Concurrency: 16 threads (target='dev')
2021-02-17 23:27:18.992000 (MainThread): 17:27:18 | 
2021-02-17 23:27:18.998981 (Thread-1): Began running node model.dbtpoc.model
2021-02-17 23:27:18.999978 (Thread-1): 17:27:19 | 1 of 1 START view model dbt_jkolpak.model............................ [RUN]
2021-02-17 23:27:19.000976 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-17 23:27:19.000976 (Thread-1): Compiling model.dbtpoc.model
2021-02-17 23:27:19.015936 (Thread-1): Writing injected SQL for node "model.dbtpoc.model"
2021-02-17 23:27:19.019930 (Thread-1): finished collecting timing info
2021-02-17 23:27:19.055830 (Thread-1): Writing runtime SQL for node "model.dbtpoc.model"
2021-02-17 23:27:19.059819 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-17 23:27:19.059819 (Thread-1): On model.dbtpoc.model: BEGIN
2021-02-17 23:27:19.059819 (Thread-1): Opening a new connection, currently in state init
2021-02-17 23:27:20.087494 (Thread-1): SQL status: SUCCESS 1 in 1.03 seconds
2021-02-17 23:27:20.088491 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-17 23:27:20.088491 (Thread-1): On model.dbtpoc.model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.model"} */

  create or replace  view DBT_POC.dbt_jkolpak.model  as (
    SELECT * FROM table_taco
  );
2021-02-17 23:27:20.328052 (Thread-1): Snowflake query id: 019a5c5f-05f6-304f-0000-40150030302a
2021-02-17 23:27:20.329043 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-17 23:27:20.329043 (Thread-1): finished collecting timing info
2021-02-17 23:27:20.329043 (Thread-1): On model.dbtpoc.model: ROLLBACK
2021-02-17 23:27:20.667211 (Thread-1): On model.dbtpoc.model: Close
2021-02-17 23:27:20.955108 (Thread-1): Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-17 23:27:20.960095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff6fc46f-ed75-404a-8738-c6b23e14effe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DCA2688>]}
2021-02-17 23:27:20.961092 (Thread-1): 17:27:20 | 1 of 1 ERROR creating view model dbt_jkolpak.model................... [ERROR in 1.96s]
2021-02-17 23:27:20.961092 (Thread-1): Finished running node model.dbtpoc.model
2021-02-17 23:27:21.018144 (MainThread): Acquiring new snowflake connection "master".
2021-02-17 23:27:21.018144 (MainThread): Using snowflake connection "master".
2021-02-17 23:27:21.018144 (MainThread): On master: BEGIN
2021-02-17 23:27:21.018144 (MainThread): Opening a new connection, currently in state closed
2021-02-17 23:27:21.927756 (MainThread): SQL status: SUCCESS 1 in 0.91 seconds
2021-02-17 23:27:21.927756 (MainThread): On master: COMMIT
2021-02-17 23:27:21.927756 (MainThread): Using snowflake connection "master".
2021-02-17 23:27:21.927756 (MainThread): On master: COMMIT
2021-02-17 23:27:22.248225 (MainThread): SQL status: SUCCESS 1 in 0.32 seconds
2021-02-17 23:27:22.248225 (MainThread): 17:27:22 | 
2021-02-17 23:27:22.249197 (MainThread): 17:27:22 | Running 2 on-run-end hooks
2021-02-17 23:27:22.250196 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-0
2021-02-17 23:27:22.261165 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-0"
2021-02-17 23:27:22.266184 (MainThread): 17:27:22 | 1 of 2 START hook: dbtpoc.on-run-end.0............................... [RUN]
2021-02-17 23:27:22.267179 (MainThread): 17:27:22 | 1 of 2 OK hook: dbtpoc.on-run-end.0.................................. [OK in 0.00s]
2021-02-17 23:27:22.270145 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-1
2021-02-17 23:27:22.277157 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-1"
2021-02-17 23:27:22.279118 (MainThread): 17:27:22 | 2 of 2 START hook: dbtpoc.on-run-end.1............................... [RUN]
2021-02-17 23:27:22.279118 (MainThread): 17:27:22 | 2 of 2 OK hook: dbtpoc.on-run-end.1.................................. [OK in 0.00s]
2021-02-17 23:27:22.280114 (MainThread): 17:27:22 | 
2021-02-17 23:27:22.290134 (MainThread): On master: Close
2021-02-17 23:27:22.525091 (MainThread): 17:27:22 | 
2021-02-17 23:27:22.525091 (MainThread): 17:27:22 | Finished running 1 view model, 2 hooks in 7.89s.
2021-02-17 23:27:22.526090 (MainThread): Connection 'master' was properly closed.
2021-02-17 23:27:22.526090 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-17 23:27:22.527087 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-17 23:27:22.527087 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-17 23:27:22.531078 (MainThread): 
2021-02-17 23:27:22.531078 (MainThread): Completed with 1 error and 0 warnings:
2021-02-17 23:27:22.532074 (MainThread): 
2021-02-17 23:27:22.533072 (MainThread): Database Error in model model (models\model.sql)
2021-02-17 23:27:22.534068 (MainThread):   002003 (42S02): SQL compilation error:
2021-02-17 23:27:22.536091 (MainThread):   Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-17 23:27:22.537071 (MainThread):   compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-17 23:27:22.540079 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-17 23:27:22.541049 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DF1C848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DE873C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E2DCC4848>]}
2021-02-17 23:27:22.541049 (MainThread): Flushing usage events
2021-02-17 23:39:58.230782 (MainThread): Running with dbt=0.18.0
2021-02-17 23:39:59.916005 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-17 23:39:59.918000 (MainThread): Tracking: tracking
2021-02-17 23:39:59.918000 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138176B0DC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381B71F3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381B71F388>]}
2021-02-17 23:39:59.949950 (MainThread): Partial parsing not enabled
2021-02-17 23:39:59.951911 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-17 23:39:59.952909 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-17 23:39:59.956895 (MainThread): Parsing macros\adapters.sql
2021-02-17 23:40:00.030698 (MainThread): Parsing macros\catalog.sql
2021-02-17 23:40:00.035686 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-17 23:40:00.051643 (MainThread): Parsing macros\materializations\merge.sql
2021-02-17 23:40:00.056629 (MainThread): Parsing macros\materializations\table.sql
2021-02-17 23:40:00.066602 (MainThread): Parsing macros\materializations\view.sql
2021-02-17 23:40:00.079568 (MainThread): Parsing macros\core.sql
2021-02-17 23:40:00.086550 (MainThread): Parsing macros\adapters\common.sql
2021-02-17 23:40:00.159355 (MainThread): Parsing macros\etc\datetime.sql
2021-02-17 23:40:00.172320 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-17 23:40:00.175312 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-17 23:40:00.182294 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-17 23:40:00.191269 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-17 23:40:00.199248 (MainThread): Parsing macros\etc\query.sql
2021-02-17 23:40:00.204235 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-17 23:40:00.232161 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-17 23:40:00.264076 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-17 23:40:00.271056 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-17 23:40:00.292001 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-17 23:40:00.350843 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-17 23:40:00.421654 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-17 23:40:00.427638 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-17 23:40:00.460550 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-17 23:40:00.480496 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-17 23:40:00.499448 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-17 23:40:00.514406 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-17 23:40:00.520390 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-17 23:40:00.525378 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-17 23:40:00.530363 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-17 23:40:00.542332 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-17 23:40:00.543329 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '767539bf-0858-43ac-976c-95bc56efad5c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381B752888>]}
2021-02-17 23:40:00.545323 (MainThread): Partial parsing not enabled
2021-02-17 23:40:00.637078 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-17 23:40:00.683953 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-0".
2021-02-17 23:40:00.695921 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-1".
2021-02-17 23:40:00.996163 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 2 operations, 0 seed files, 0 sources
2021-02-17 23:40:00.998151 (MainThread): 
2021-02-17 23:40:00.999147 (MainThread): Acquiring new snowflake connection "master".
2021-02-17 23:40:01.004134 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-17 23:40:01.040040 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-17 23:40:01.041034 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-17 23:40:01.041034 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-17 23:40:02.483900 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.44 seconds
2021-02-17 23:40:02.499372 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-17 23:40:02.821510 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-17 23:40:02.846443 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-17 23:40:02.847441 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-17 23:40:02.847441 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-17 23:40:04.888700 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 2.04 seconds
2021-02-17 23:40:04.893653 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-17 23:40:05.207814 (MainThread): Using snowflake connection "master".
2021-02-17 23:40:05.207814 (MainThread): On master: BEGIN
2021-02-17 23:40:05.208809 (MainThread): Opening a new connection, currently in state init
2021-02-17 23:40:06.474590 (MainThread): SQL status: SUCCESS 1 in 1.27 seconds
2021-02-17 23:40:06.474590 (MainThread): On master: COMMIT
2021-02-17 23:40:06.474590 (MainThread): Using snowflake connection "master".
2021-02-17 23:40:06.474590 (MainThread): On master: COMMIT
2021-02-17 23:40:07.094770 (MainThread): SQL status: SUCCESS 1 in 0.62 seconds
2021-02-17 23:40:07.095766 (MainThread): On master: Close
2021-02-17 23:40:07.507676 (MainThread): 17:40:07 | Concurrency: 16 threads (target='dev')
2021-02-17 23:40:07.508672 (MainThread): 17:40:07 | 
2021-02-17 23:40:07.521640 (Thread-1): Began running node model.dbtpoc.model
2021-02-17 23:40:07.524631 (Thread-1): 17:40:07 | 1 of 1 START view model dbt_jkolpak.model............................ [RUN]
2021-02-17 23:40:07.526627 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-17 23:40:07.526627 (Thread-1): Compiling model.dbtpoc.model
2021-02-17 23:40:07.574499 (Thread-1): Writing injected SQL for node "model.dbtpoc.model"
2021-02-17 23:40:07.576492 (Thread-1): finished collecting timing info
2021-02-17 23:40:07.633340 (Thread-1): Writing runtime SQL for node "model.dbtpoc.model"
2021-02-17 23:40:07.635335 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-17 23:40:07.635335 (Thread-1): On model.dbtpoc.model: BEGIN
2021-02-17 23:40:07.635335 (Thread-1): Opening a new connection, currently in state init
2021-02-17 23:40:10.241129 (Thread-1): SQL status: SUCCESS 1 in 2.61 seconds
2021-02-17 23:40:10.241129 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-17 23:40:10.241129 (Thread-1): On model.dbtpoc.model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.model"} */

  create or replace  view DBT_POC.dbt_jkolpak.model  as (
    SELECT * FROM table_taco
  );
2021-02-17 23:40:11.062106 (Thread-1): Snowflake query id: 019a5c6c-0542-5577-0000-40150030303e
2021-02-17 23:40:11.062106 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-17 23:40:11.062106 (Thread-1): finished collecting timing info
2021-02-17 23:40:11.063104 (Thread-1): On model.dbtpoc.model: ROLLBACK
2021-02-17 23:40:13.502474 (Thread-1): On model.dbtpoc.model: Close
2021-02-17 23:40:14.770104 (Thread-1): Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-17 23:40:14.794762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '767539bf-0858-43ac-976c-95bc56efad5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381BA1C988>]}
2021-02-17 23:40:14.797754 (Thread-1): 17:40:14 | 1 of 1 ERROR creating view model dbt_jkolpak.model................... [ERROR in 7.27s]
2021-02-17 23:40:14.798751 (Thread-1): Finished running node model.dbtpoc.model
2021-02-17 23:40:14.899484 (MainThread): Acquiring new snowflake connection "master".
2021-02-17 23:40:14.899484 (MainThread): Using snowflake connection "master".
2021-02-17 23:40:14.899484 (MainThread): On master: BEGIN
2021-02-17 23:40:14.899484 (MainThread): Opening a new connection, currently in state closed
2021-02-17 23:40:16.647183 (MainThread): SQL status: SUCCESS 1 in 1.75 seconds
2021-02-17 23:40:16.648178 (MainThread): On master: COMMIT
2021-02-17 23:40:16.648178 (MainThread): Using snowflake connection "master".
2021-02-17 23:40:16.648178 (MainThread): On master: COMMIT
2021-02-17 23:40:18.544161 (MainThread): SQL status: SUCCESS 1 in 1.90 seconds
2021-02-17 23:40:18.544161 (MainThread): 17:40:18 | 
2021-02-17 23:40:18.544161 (MainThread): 17:40:18 | Running 2 on-run-end hooks
2021-02-17 23:40:18.546154 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-0
2021-02-17 23:40:18.575080 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-0"
2021-02-17 23:40:18.585050 (MainThread): 17:40:18 | 1 of 2 START hook: dbtpoc.on-run-end.0............................... [RUN]
2021-02-17 23:40:18.586053 (MainThread): 17:40:18 | 1 of 2 OK hook: dbtpoc.on-run-end.0.................................. [OK in 0.00s]
2021-02-17 23:40:18.588042 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-1
2021-02-17 23:40:18.607989 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-1"
2021-02-17 23:40:18.608987 (MainThread): 17:40:18 | 2 of 2 START hook: dbtpoc.on-run-end.1............................... [RUN]
2021-02-17 23:40:18.609984 (MainThread): 17:40:18 | 2 of 2 OK hook: dbtpoc.on-run-end.1.................................. [OK in 0.00s]
2021-02-17 23:40:18.611979 (MainThread): 17:40:18 | 
2021-02-17 23:40:18.615980 (MainThread): On master: Close
2021-02-17 23:40:19.717397 (MainThread): 17:40:19 | 
2021-02-17 23:40:19.717397 (MainThread): 17:40:19 | Finished running 1 view model, 2 hooks in 18.72s.
2021-02-17 23:40:19.719396 (MainThread): Connection 'master' was properly closed.
2021-02-17 23:40:19.719396 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-17 23:40:19.719396 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-17 23:40:19.719396 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-17 23:40:19.725376 (MainThread): 
2021-02-17 23:40:19.725376 (MainThread): Completed with 1 error and 0 warnings:
2021-02-17 23:40:19.726374 (MainThread): 
2021-02-17 23:40:19.728402 (MainThread): Database Error in model model (models\model.sql)
2021-02-17 23:40:19.729366 (MainThread):   002003 (42S02): SQL compilation error:
2021-02-17 23:40:19.732360 (MainThread):   Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-17 23:40:19.733355 (MainThread):   compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-17 23:40:19.734359 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-17 23:40:19.735351 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381B9EEF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381B81DB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001381BBE78C8>]}
2021-02-17 23:40:19.735351 (MainThread): Flushing usage events
2021-02-18 00:02:36.777839 (MainThread): Running with dbt=0.18.0
2021-02-18 00:02:37.959068 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 00:02:37.960065 (MainThread): Tracking: tracking
2021-02-18 00:02:37.961063 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145977A4AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145977B1B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145977B1C88>]}
2021-02-18 00:02:37.987990 (MainThread): Partial parsing not enabled
2021-02-18 00:02:37.988988 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 00:02:37.989985 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 00:02:37.993975 (MainThread): Parsing macros\adapters.sql
2021-02-18 00:02:38.032054 (MainThread): Parsing macros\catalog.sql
2021-02-18 00:02:38.035028 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 00:02:38.047994 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 00:02:38.051984 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 00:02:38.057967 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 00:02:38.068939 (MainThread): Parsing macros\core.sql
2021-02-18 00:02:38.074926 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 00:02:38.137140 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 00:02:38.148078 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 00:02:38.150073 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 00:02:38.153065 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 00:02:38.156057 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 00:02:38.159049 (MainThread): Parsing macros\etc\query.sql
2021-02-18 00:02:38.161044 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 00:02:38.173011 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 00:02:38.191964 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 00:02:38.194955 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 00:02:38.203930 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 00:02:38.236321 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 00:02:38.274873 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 00:02:38.277864 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 00:02:38.302500 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 00:02:38.312476 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 00:02:38.318459 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 00:02:38.330856 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 00:02:38.335842 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 00:02:38.337837 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 00:02:38.340829 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 00:02:38.349389 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 00:02:38.352246 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '002f25d6-06c8-434c-87c3-df60fbbcca99', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014597706088>]}
2021-02-18 00:02:38.353243 (MainThread): Partial parsing not enabled
2021-02-18 00:02:38.406297 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:02:38.453173 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-0".
2021-02-18 00:02:38.471126 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-1".
2021-02-18 00:02:38.691192 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 2 operations, 0 seed files, 0 sources
2021-02-18 00:02:38.692190 (MainThread): 
2021-02-18 00:02:38.693188 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:02:38.695182 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 00:02:38.713488 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 00:02:38.714452 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 00:02:38.714452 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 00:02:40.136003 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.42 seconds
2021-02-18 00:02:40.147108 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 00:02:40.618208 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:02:40.624609 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:02:40.624609 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 00:02:40.624609 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 00:02:42.157894 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.53 seconds
2021-02-18 00:02:42.162881 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 00:02:42.563326 (MainThread): Using snowflake connection "master".
2021-02-18 00:02:42.564323 (MainThread): On master: BEGIN
2021-02-18 00:02:42.564323 (MainThread): Opening a new connection, currently in state init
2021-02-18 00:02:43.658672 (MainThread): SQL status: SUCCESS 1 in 1.09 seconds
2021-02-18 00:02:43.658672 (MainThread): On master: COMMIT
2021-02-18 00:02:43.658672 (MainThread): Using snowflake connection "master".
2021-02-18 00:02:43.658672 (MainThread): On master: COMMIT
2021-02-18 00:02:44.020789 (MainThread): SQL status: SUCCESS 1 in 0.36 seconds
2021-02-18 00:02:44.021787 (MainThread): On master: Close
2021-02-18 00:02:44.298139 (MainThread): 18:02:44 | Concurrency: 16 threads (target='dev')
2021-02-18 00:02:44.299147 (MainThread): 18:02:44 | 
2021-02-18 00:02:44.305124 (Thread-1): Began running node model.dbtpoc.model
2021-02-18 00:02:44.306121 (Thread-1): 18:02:44 | 1 of 1 START view model dbt_jkolpak.model............................ [RUN]
2021-02-18 00:02:44.307118 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:02:44.307118 (Thread-1): Compiling model.dbtpoc.model
2021-02-18 00:02:44.324148 (Thread-1): Writing injected SQL for node "model.dbtpoc.model"
2021-02-18 00:02:44.325145 (Thread-1): finished collecting timing info
2021-02-18 00:02:44.358155 (Thread-1): Writing runtime SQL for node "model.dbtpoc.model"
2021-02-18 00:02:44.360117 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:02:44.360117 (Thread-1): On model.dbtpoc.model: BEGIN
2021-02-18 00:02:44.360117 (Thread-1): Opening a new connection, currently in state init
2021-02-18 00:02:45.246179 (Thread-1): SQL status: SUCCESS 1 in 0.89 seconds
2021-02-18 00:02:45.246179 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:02:45.246179 (Thread-1): On model.dbtpoc.model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.model"} */

  create or replace  view DBT_POC.dbt_jkolpak.model  as (
    SELECT * FROM table_taco
  );
2021-02-18 00:02:45.540500 (Thread-1): Snowflake query id: 019a5c82-052a-188a-0000-40150030404e
2021-02-18 00:02:45.540500 (Thread-1): Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-18 00:02:45.540500 (Thread-1): finished collecting timing info
2021-02-18 00:02:45.541498 (Thread-1): On model.dbtpoc.model: ROLLBACK
2021-02-18 00:02:46.013221 (Thread-1): On model.dbtpoc.model: Close
2021-02-18 00:02:46.371107 (Thread-1): Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (42S02): SQL compilation error:
Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 27, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 65, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model model (models\model.sql)
  002003 (42S02): SQL compilation error:
  Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
  compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-18 00:02:46.381079 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '002f25d6-06c8-434c-87c3-df60fbbcca99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014597BB3948>]}
2021-02-18 00:02:46.383075 (Thread-1): 18:02:46 | 1 of 1 ERROR creating view model dbt_jkolpak.model................... [ERROR in 2.07s]
2021-02-18 00:02:46.384072 (Thread-1): Finished running node model.dbtpoc.model
2021-02-18 00:02:46.428956 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:02:46.430372 (MainThread): Using snowflake connection "master".
2021-02-18 00:02:46.430372 (MainThread): On master: BEGIN
2021-02-18 00:02:46.430372 (MainThread): Opening a new connection, currently in state closed
2021-02-18 00:02:47.385928 (MainThread): SQL status: SUCCESS 1 in 0.96 seconds
2021-02-18 00:02:47.385928 (MainThread): On master: COMMIT
2021-02-18 00:02:47.385928 (MainThread): Using snowflake connection "master".
2021-02-18 00:02:47.386925 (MainThread): On master: COMMIT
2021-02-18 00:02:47.982988 (MainThread): SQL status: SUCCESS 1 in 0.60 seconds
2021-02-18 00:02:47.982988 (MainThread): 18:02:47 | 
2021-02-18 00:02:47.983962 (MainThread): 18:02:47 | Running 2 on-run-end hooks
2021-02-18 00:02:47.983962 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-0
2021-02-18 00:02:47.996926 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-0"
2021-02-18 00:02:47.999845 (MainThread): 18:02:48 | 1 of 2 START hook: dbtpoc.on-run-end.0............................... [RUN]
2021-02-18 00:02:48.000913 (MainThread): 18:02:48 | 1 of 2 OK hook: dbtpoc.on-run-end.0.................................. [OK in 0.00s]
2021-02-18 00:02:48.002838 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-1
2021-02-18 00:02:48.007824 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-1"
2021-02-18 00:02:48.008821 (MainThread): 18:02:48 | 2 of 2 START hook: dbtpoc.on-run-end.1............................... [RUN]
2021-02-18 00:02:48.009834 (MainThread): 18:02:48 | 2 of 2 OK hook: dbtpoc.on-run-end.1.................................. [OK in 0.00s]
2021-02-18 00:02:48.015808 (MainThread): 18:02:48 | 
2021-02-18 00:02:48.016807 (MainThread): On master: Close
2021-02-18 00:02:48.316495 (MainThread): 18:02:48 | 
2021-02-18 00:02:48.317493 (MainThread): 18:02:48 | Finished running 1 view model, 2 hooks in 9.62s.
2021-02-18 00:02:48.317493 (MainThread): Connection 'master' was properly closed.
2021-02-18 00:02:48.317493 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 00:02:48.317493 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 00:02:48.317493 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-18 00:02:48.322395 (MainThread): 
2021-02-18 00:02:48.324390 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 00:02:48.324390 (MainThread): 
2021-02-18 00:02:48.325387 (MainThread): Database Error in model model (models\model.sql)
2021-02-18 00:02:48.326386 (MainThread):   002003 (42S02): SQL compilation error:
2021-02-18 00:02:48.326386 (MainThread):   Object 'DBT_POC.DBT_JKOLPAK.TABLE_TACO' does not exist or not authorized.
2021-02-18 00:02:48.331370 (MainThread):   compiled SQL at target\run\dbtpoc\models\model.sql
2021-02-18 00:02:48.332370 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 00:02:48.333368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001459791C9C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014597A1AB48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014597A00F48>]}
2021-02-18 00:02:48.333368 (MainThread): Flushing usage events
2021-02-18 00:03:55.647912 (MainThread): Running with dbt=0.18.0
2021-02-18 00:03:56.491396 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 00:03:56.493370 (MainThread): Tracking: tracking
2021-02-18 00:03:56.493370 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA09B1048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4A34A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4A34848>]}
2021-02-18 00:03:56.540254 (MainThread): Partial parsing not enabled
2021-02-18 00:03:56.542248 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 00:03:56.544241 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 00:03:56.549228 (MainThread): Parsing macros\adapters.sql
2021-02-18 00:03:56.598790 (MainThread): Parsing macros\catalog.sql
2021-02-18 00:03:56.601782 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 00:03:56.622726 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 00:03:56.626715 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 00:03:56.632699 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 00:03:56.642281 (MainThread): Parsing macros\core.sql
2021-02-18 00:03:56.652229 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 00:03:56.761442 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 00:03:56.784620 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 00:03:56.788611 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 00:03:56.794594 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 00:03:56.798583 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 00:03:56.803570 (MainThread): Parsing macros\etc\query.sql
2021-02-18 00:03:56.806561 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 00:03:56.828909 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 00:03:56.857185 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 00:03:56.862175 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 00:03:56.873146 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 00:03:56.913544 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 00:03:56.968671 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 00:03:56.973288 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 00:03:57.011362 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 00:03:57.023331 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 00:03:57.032307 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 00:03:57.043278 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 00:03:57.048264 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 00:03:57.050259 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 00:03:57.054250 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 00:03:57.065892 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 00:03:57.075865 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf2826d3-a770-4396-8b9d-d647f6b0f99b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4994D88>]}
2021-02-18 00:03:57.077861 (MainThread): Partial parsing not enabled
2021-02-18 00:03:57.148886 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:03:57.183466 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-0".
2021-02-18 00:03:57.194901 (MainThread): Acquiring new snowflake connection "operation.dbtpoc.dbtpoc-on-run-end-1".
2021-02-18 00:03:57.441995 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 2 operations, 0 seed files, 0 sources
2021-02-18 00:03:57.442991 (MainThread): 
2021-02-18 00:03:57.444986 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:03:57.447977 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 00:03:57.486874 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 00:03:57.487872 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 00:03:57.487872 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 00:03:58.721689 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.23 seconds
2021-02-18 00:03:58.725707 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 00:03:59.076890 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:03:59.084356 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:03:59.084356 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 00:03:59.084356 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 00:04:00.188967 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 5 in 1.10 seconds
2021-02-18 00:04:00.194013 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 00:04:00.548861 (MainThread): Using snowflake connection "master".
2021-02-18 00:04:00.548861 (MainThread): On master: BEGIN
2021-02-18 00:04:00.548861 (MainThread): Opening a new connection, currently in state init
2021-02-18 00:04:01.492313 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-02-18 00:04:01.492313 (MainThread): On master: COMMIT
2021-02-18 00:04:01.492313 (MainThread): Using snowflake connection "master".
2021-02-18 00:04:01.492313 (MainThread): On master: COMMIT
2021-02-18 00:04:02.366263 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-02-18 00:04:02.366263 (MainThread): On master: Close
2021-02-18 00:04:02.651367 (MainThread): 18:04:02 | Concurrency: 16 threads (target='dev')
2021-02-18 00:04:02.651367 (MainThread): 18:04:02 | 
2021-02-18 00:04:02.657345 (Thread-1): Began running node model.dbtpoc.model
2021-02-18 00:04:02.659340 (Thread-1): 18:04:02 | 1 of 1 START view model dbt_jkolpak.model............................ [RUN]
2021-02-18 00:04:02.660373 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:04:02.660373 (Thread-1): Compiling model.dbtpoc.model
2021-02-18 00:04:02.693998 (Thread-1): Writing injected SQL for node "model.dbtpoc.model"
2021-02-18 00:04:02.694982 (Thread-1): finished collecting timing info
2021-02-18 00:04:02.732369 (Thread-1): Writing runtime SQL for node "model.dbtpoc.model"
2021-02-18 00:04:02.734396 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:04:02.734396 (Thread-1): On model.dbtpoc.model: BEGIN
2021-02-18 00:04:02.734396 (Thread-1): Opening a new connection, currently in state init
2021-02-18 00:04:03.725202 (Thread-1): SQL status: SUCCESS 1 in 0.99 seconds
2021-02-18 00:04:03.726230 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:04:03.726230 (Thread-1): On model.dbtpoc.model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.model"} */

  create or replace  view DBT_POC.dbt_jkolpak.model  as (
    SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
  );
2021-02-18 00:04:05.840400 (Thread-1): SQL status: SUCCESS 1 in 2.11 seconds
2021-02-18 00:04:05.841278 (Thread-1): On model.dbtpoc.model: COMMIT
2021-02-18 00:04:05.841278 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:04:05.841278 (Thread-1): On model.dbtpoc.model: COMMIT
2021-02-18 00:04:06.038100 (Thread-1): SQL status: SUCCESS 1 in 0.20 seconds
2021-02-18 00:04:06.048073 (Thread-1): finished collecting timing info
2021-02-18 00:04:06.049071 (Thread-1): On model.dbtpoc.model: Close
2021-02-18 00:04:06.674434 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf2826d3-a770-4396-8b9d-d647f6b0f99b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4E40088>]}
2021-02-18 00:04:06.675431 (Thread-1): 18:04:06 | 1 of 1 OK created view model dbt_jkolpak.model....................... [SUCCESS 1 in 4.01s]
2021-02-18 00:04:06.676395 (Thread-1): Finished running node model.dbtpoc.model
2021-02-18 00:04:06.698127 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:04:06.698127 (MainThread): Using snowflake connection "master".
2021-02-18 00:04:06.698127 (MainThread): On master: BEGIN
2021-02-18 00:04:06.698127 (MainThread): Opening a new connection, currently in state closed
2021-02-18 00:04:07.644873 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 00:04:07.644873 (MainThread): On master: COMMIT
2021-02-18 00:04:07.645871 (MainThread): Using snowflake connection "master".
2021-02-18 00:04:07.645871 (MainThread): On master: COMMIT
2021-02-18 00:04:07.945460 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-18 00:04:07.945460 (MainThread): 18:04:07 | 
2021-02-18 00:04:07.946458 (MainThread): 18:04:07 | Running 2 on-run-end hooks
2021-02-18 00:04:07.946458 (MainThread): Compiling operation.dbtpoc.dbtpoc-on-run-end-0
2021-02-18 00:04:07.967405 (MainThread): Writing injected SQL for node "operation.dbtpoc.dbtpoc-on-run-end-0"
2021-02-18 00:04:07.975389 (MainThread): 18:04:07 | 1 of 2 START hook: dbtpoc.on-run-end.0............................... [RUN]
2021-02-18 00:04:07.976383 (MainThread): Using snowflake connection "master".
2021-02-18 00:04:07.976383 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "master"} */

  
    grant usage on schema dbt_jkolpak to role reporter;
2021-02-18 00:04:08.171952 (MainThread): Snowflake query id: 019a5c84-0543-22b2-0000-40150030209a
2021-02-18 00:04:08.171952 (MainThread): Snowflake error: 002003 (02000): SQL compilation error:
Role 'REPORTER' does not exist or not authorized.
2021-02-18 00:04:08.171952 (MainThread): Database error while running on-run-end
2021-02-18 00:04:08.172948 (MainThread): On master: Close
2021-02-18 00:04:08.658169 (MainThread): Connection 'master' was properly closed.
2021-02-18 00:04:08.658169 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 00:04:08.658169 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 00:04:08.658169 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-18 00:04:08.659166 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4D5B208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4D51188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFA4E43548>]}
2021-02-18 00:04:08.659166 (MainThread): Flushing usage events
2021-02-18 00:04:09.050571 (MainThread): Encountered an error:
2021-02-18 00:04:09.057555 (MainThread): Database Error
  002003 (02000): SQL compilation error:
  Role 'REPORTER' does not exist or not authorized.
2021-02-18 00:04:09.077698 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002003 (02000): SQL compilation error:
Role 'REPORTER' does not exist or not authorized.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 419, in run
    result = self.execute_with_hooks(selected_uids)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 381, in execute_with_hooks
    self.after_run(adapter, res)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 415, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 337, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 320, in run_hooks
    fetch=False)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error
  002003 (02000): SQL compilation error:
  Role 'REPORTER' does not exist or not authorized.

2021-02-18 00:05:02.717336 (MainThread): Running with dbt=0.18.0
2021-02-18 00:05:03.609827 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 00:05:03.610824 (MainThread): Tracking: tracking
2021-02-18 00:05:03.610824 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC5B1B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE8470C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC5BF248>]}
2021-02-18 00:05:03.645736 (MainThread): Partial parsing not enabled
2021-02-18 00:05:03.646734 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 00:05:03.647731 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 00:05:03.650723 (MainThread): Parsing macros\adapters.sql
2021-02-18 00:05:03.696724 (MainThread): Parsing macros\catalog.sql
2021-02-18 00:05:03.698718 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 00:05:03.711684 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 00:05:03.714676 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 00:05:03.720659 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 00:05:03.725646 (MainThread): Parsing macros\core.sql
2021-02-18 00:05:03.730633 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 00:05:03.791659 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 00:05:03.805996 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 00:05:03.807991 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 00:05:03.810983 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 00:05:03.814972 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 00:05:03.818962 (MainThread): Parsing macros\etc\query.sql
2021-02-18 00:05:03.820957 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 00:05:03.837822 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 00:05:03.873725 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 00:05:03.876717 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 00:05:03.889682 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 00:05:03.930499 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 00:05:03.982891 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 00:05:03.985880 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 00:05:04.008753 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 00:05:04.018541 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 00:05:04.025099 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 00:05:04.035736 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 00:05:04.039403 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 00:05:04.041896 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 00:05:04.043919 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 00:05:04.052869 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 00:05:04.060812 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ec98fb6-4c2b-4845-a02b-6b5e93b8b75c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC60B788>]}
2021-02-18 00:05:04.061810 (MainThread): Partial parsing not enabled
2021-02-18 00:05:04.123089 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:05:04.358950 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 00:05:04.359948 (MainThread): 
2021-02-18 00:05:04.360945 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:05:04.364934 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 00:05:04.445543 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 00:05:04.445543 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 00:05:04.445543 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 00:05:06.116758 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.67 seconds
2021-02-18 00:05:06.120779 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 00:05:06.416058 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:05:06.428027 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 00:05:06.428027 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 00:05:06.428027 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 00:05:07.734635 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.31 seconds
2021-02-18 00:05:07.741267 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 00:05:08.134019 (MainThread): Using snowflake connection "master".
2021-02-18 00:05:08.134019 (MainThread): On master: BEGIN
2021-02-18 00:05:08.135015 (MainThread): Opening a new connection, currently in state init
2021-02-18 00:05:09.104840 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-02-18 00:05:09.104840 (MainThread): On master: COMMIT
2021-02-18 00:05:09.105837 (MainThread): Using snowflake connection "master".
2021-02-18 00:05:09.105837 (MainThread): On master: COMMIT
2021-02-18 00:05:09.617874 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-02-18 00:05:09.617874 (MainThread): On master: Close
2021-02-18 00:05:10.117757 (MainThread): 18:05:10 | Concurrency: 16 threads (target='dev')
2021-02-18 00:05:10.118753 (MainThread): 18:05:10 | 
2021-02-18 00:05:10.122550 (Thread-1): Began running node model.dbtpoc.model
2021-02-18 00:05:10.123548 (Thread-1): 18:05:10 | 1 of 1 START view model dbt_jkolpak.model............................ [RUN]
2021-02-18 00:05:10.128534 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 00:05:10.129533 (Thread-1): Compiling model.dbtpoc.model
2021-02-18 00:05:10.150220 (Thread-1): Writing injected SQL for node "model.dbtpoc.model"
2021-02-18 00:05:10.151224 (Thread-1): finished collecting timing info
2021-02-18 00:05:10.194913 (Thread-1): Writing runtime SQL for node "model.dbtpoc.model"
2021-02-18 00:05:10.197906 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:05:10.198903 (Thread-1): On model.dbtpoc.model: BEGIN
2021-02-18 00:05:10.198903 (Thread-1): Opening a new connection, currently in state init
2021-02-18 00:05:11.132062 (Thread-1): SQL status: SUCCESS 1 in 0.93 seconds
2021-02-18 00:05:11.132062 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:05:11.132062 (Thread-1): On model.dbtpoc.model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.model"} */

  create or replace  view DBT_POC.dbt_jkolpak.model  as (
    SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
  );
2021-02-18 00:05:12.180151 (Thread-1): SQL status: SUCCESS 1 in 1.05 seconds
2021-02-18 00:05:12.181118 (Thread-1): On model.dbtpoc.model: COMMIT
2021-02-18 00:05:12.181118 (Thread-1): Using snowflake connection "model.dbtpoc.model".
2021-02-18 00:05:12.181118 (Thread-1): On model.dbtpoc.model: COMMIT
2021-02-18 00:05:12.361572 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-18 00:05:12.373418 (Thread-1): finished collecting timing info
2021-02-18 00:05:12.373418 (Thread-1): On model.dbtpoc.model: Close
2021-02-18 00:05:12.722293 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ec98fb6-4c2b-4845-a02b-6b5e93b8b75c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC7D1B08>]}
2021-02-18 00:05:12.724287 (Thread-1): 18:05:12 | 1 of 1 OK created view model dbt_jkolpak.model....................... [SUCCESS 1 in 2.59s]
2021-02-18 00:05:12.725285 (Thread-1): Finished running node model.dbtpoc.model
2021-02-18 00:05:12.750913 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 00:05:12.750913 (MainThread): Using snowflake connection "master".
2021-02-18 00:05:12.750913 (MainThread): On master: BEGIN
2021-02-18 00:05:12.750913 (MainThread): Opening a new connection, currently in state closed
2021-02-18 00:05:13.790849 (MainThread): SQL status: SUCCESS 1 in 1.04 seconds
2021-02-18 00:05:13.790849 (MainThread): On master: COMMIT
2021-02-18 00:05:13.790849 (MainThread): Using snowflake connection "master".
2021-02-18 00:05:13.790849 (MainThread): On master: COMMIT
2021-02-18 00:05:14.135141 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-02-18 00:05:14.136138 (MainThread): On master: Close
2021-02-18 00:05:14.412341 (MainThread): 18:05:14 | 
2021-02-18 00:05:14.413373 (MainThread): 18:05:14 | Finished running 1 view model in 10.05s.
2021-02-18 00:05:14.413373 (MainThread): Connection 'master' was properly closed.
2021-02-18 00:05:14.414336 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 00:05:14.414336 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 00:05:14.414336 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-18 00:05:14.420320 (MainThread): 
2021-02-18 00:05:14.433967 (MainThread): Completed successfully
2021-02-18 00:05:14.434964 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-18 00:05:14.435964 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC98BD08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEA3EB2C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEC6753C8>]}
2021-02-18 00:05:14.435964 (MainThread): Flushing usage events
2021-02-18 01:24:43.139221 (MainThread): Running with dbt=0.18.0
2021-02-18 01:24:45.377926 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.list.ListTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, output='selector', partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, resource_types=[], rpc_method=None, select=None, selector_name=None, single_threaded=True, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='list', write_json=True)
2021-02-18 01:24:45.379920 (MainThread): Tracking: tracking
2021-02-18 01:24:45.379920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32E9AB3C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32E9ABB88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32E9A12C8>]}
2021-02-18 01:24:45.402564 (MainThread): Partial parsing not enabled
2021-02-18 01:24:45.403642 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:24:45.406552 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:24:45.412537 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:24:45.447122 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:24:45.450149 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:24:45.462605 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:24:45.466695 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:24:45.472731 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:24:45.485058 (MainThread): Parsing macros\core.sql
2021-02-18 01:24:45.490664 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:24:45.549119 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:24:45.560040 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:24:45.561996 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:24:45.565161 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:24:45.571971 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:24:45.577954 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:24:45.581946 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:24:45.610867 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:24:45.665529 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:24:45.672367 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:24:45.687672 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:24:45.711038 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:24:45.743941 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:24:45.746933 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:24:45.769872 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:24:45.778143 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:24:45.785006 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:24:45.802218 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:24:45.810241 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:24:45.815182 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:24:45.821688 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:24:45.837969 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:24:45.860632 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fe5ceade-2a6f-4173-9f41-41fbaacfdd82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32EA096C8>]}
2021-02-18 01:24:45.862391 (MainThread): Partial parsing not enabled
2021-02-18 01:24:45.936651 (MainThread): Acquiring new snowflake connection "model.dbtpoc.model".
2021-02-18 01:24:46.115962 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:24:46.117217 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32EC37808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32EC405C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E32EC40508>]}
2021-02-18 01:24:46.117217 (MainThread): Flushing usage events
2021-02-18 01:24:46.667526 (MainThread): Connection 'model.dbtpoc.model' was properly closed.
2021-02-18 01:38:17.315537 (MainThread): Running with dbt=0.18.0
2021-02-18 01:38:19.510952 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:38:19.535078 (MainThread): Tracking: tracking
2021-02-18 01:38:19.536075 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002154CEB9608>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002155162FE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215516331C8>]}
2021-02-18 01:38:19.579656 (MainThread): Partial parsing not enabled
2021-02-18 01:38:19.580653 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:38:19.580885 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:38:19.585442 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:38:19.658753 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:38:19.666751 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:38:19.692546 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:38:19.699042 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:38:19.711209 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:38:19.726303 (MainThread): Parsing macros\core.sql
2021-02-18 01:38:19.738613 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:38:19.821318 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:38:19.845529 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:38:19.847250 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:38:19.851675 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:38:19.858229 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:38:19.861213 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:38:19.865202 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:38:19.880146 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:38:19.909672 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:38:19.916720 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:38:19.947526 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:38:20.037501 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:38:20.130413 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:38:20.136302 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:38:20.176000 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:38:20.211486 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:38:20.240216 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:38:20.265529 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:38:20.275462 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:38:20.280497 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:38:20.284486 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:38:20.302647 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:38:20.304614 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '70a5e6cb-a33f-4584-9af3-55a6e4e5c144', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021551687F08>]}
2021-02-18 01:38:20.305874 (MainThread): Partial parsing not enabled
2021-02-18 01:38:20.465731 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:20.501670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215517F3188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215517F3148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215517F30C8>]}
2021-02-18 01:38:20.502094 (MainThread): Flushing usage events
2021-02-18 01:38:21.603550 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:38:21.604547 (MainThread): Encountered an error:
2021-02-18 01:38:21.886140 (MainThread): Compilation Error in model DimSupplier (models\DimSupplier.sql)
  unexpected '}', expected ')'
    line 1
      {{ config(materialized='table' }}
2021-02-18 01:38:21.901069 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 1, in template
jinja2.exceptions.TemplateSyntaxError: unexpected '}', expected ')'
  line 1
    {{ config(materialized='table' }}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 575, in get_rendered
    native=native,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model DimSupplier (models\DimSupplier.sql)
  unexpected '}', expected ')'
    line 1
      {{ config(materialized='table' }}

2021-02-18 01:38:31.567052 (MainThread): Running with dbt=0.18.0
2021-02-18 01:38:32.388580 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:38:32.470341 (MainThread): Tracking: tracking
2021-02-18 01:38:32.471337 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0359520C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0399F3308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0399F0788>]}
2021-02-18 01:38:32.506634 (MainThread): Partial parsing not enabled
2021-02-18 01:38:32.507983 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:38:32.508530 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:38:32.511555 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:38:32.550344 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:38:32.553519 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:38:32.565495 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:38:32.568487 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:38:32.573328 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:38:32.578316 (MainThread): Parsing macros\core.sql
2021-02-18 01:38:32.582303 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:38:32.634141 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:38:32.645157 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:38:32.646172 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:38:32.648539 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:38:32.651101 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:38:32.653069 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:38:32.654067 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:38:32.664324 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:38:32.682434 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:38:32.684394 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:38:32.691557 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:38:32.713615 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:38:32.746898 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:38:32.749002 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:38:32.766331 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:38:32.774377 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:38:32.779284 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:38:32.786397 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:38:32.789285 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:38:32.790941 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:38:32.792934 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:38:32.799345 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:38:32.807869 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c47d9d92-9de1-4688-a521-c7f4890d20c7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F0399FCCC8>]}
2021-02-18 01:38:32.808387 (MainThread): Partial parsing not enabled
2021-02-18 01:38:32.852316 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:33.082260 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:38:33.083034 (MainThread): 
2021-02-18 01:38:33.084031 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:38:33.086027 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 01:38:33.135713 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 01:38:33.136743 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 01:38:33.136743 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 01:38:34.491064 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.35 seconds
2021-02-18 01:38:34.501108 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 01:38:34.835575 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:38:34.852644 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:38:34.852644 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 01:38:34.853595 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 01:38:36.130026 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.28 seconds
2021-02-18 01:38:36.146593 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 01:38:36.428947 (MainThread): Using snowflake connection "master".
2021-02-18 01:38:36.428947 (MainThread): On master: BEGIN
2021-02-18 01:38:36.429642 (MainThread): Opening a new connection, currently in state init
2021-02-18 01:38:37.352060 (MainThread): SQL status: SUCCESS 1 in 0.92 seconds
2021-02-18 01:38:37.352060 (MainThread): On master: COMMIT
2021-02-18 01:38:37.353139 (MainThread): Using snowflake connection "master".
2021-02-18 01:38:37.353139 (MainThread): On master: COMMIT
2021-02-18 01:38:37.759448 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-02-18 01:38:37.759448 (MainThread): On master: Close
2021-02-18 01:38:38.077236 (MainThread): 19:38:38 | Concurrency: 16 threads (target='dev')
2021-02-18 01:38:38.078762 (MainThread): 19:38:38 | 
2021-02-18 01:38:38.085254 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 01:38:38.088245 (Thread-1): 19:38:38 | 1 of 1 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 01:38:38.089247 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:38.089247 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 01:38:38.109475 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:38:38.110469 (Thread-1): finished collecting timing info
2021-02-18 01:38:38.144523 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:38:38.146517 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:38.146517 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 01:38:38.146517 (Thread-1): Opening a new connection, currently in state init
2021-02-18 01:38:39.045693 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-02-18 01:38:39.045693 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:39.045693 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 01:38:43.410983 (Thread-1): SQL status: SUCCESS 1 in 4.37 seconds
2021-02-18 01:38:43.414161 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:38:43.414161 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:38:43.414161 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:38:43.579756 (Thread-1): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-18 01:38:43.612599 (Thread-1): finished collecting timing info
2021-02-18 01:38:43.613488 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 01:38:43.859415 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c47d9d92-9de1-4688-a521-c7f4890d20c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F039AE43C8>]}
2021-02-18 01:38:43.861277 (Thread-1): 19:38:43 | 1 of 1 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 5.77s]
2021-02-18 01:38:43.862954 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 01:38:43.927544 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:38:43.928541 (MainThread): Using snowflake connection "master".
2021-02-18 01:38:43.928541 (MainThread): On master: BEGIN
2021-02-18 01:38:43.928541 (MainThread): Opening a new connection, currently in state closed
2021-02-18 01:38:45.793922 (MainThread): SQL status: SUCCESS 1 in 1.87 seconds
2021-02-18 01:38:45.794921 (MainThread): On master: COMMIT
2021-02-18 01:38:45.794921 (MainThread): Using snowflake connection "master".
2021-02-18 01:38:45.795916 (MainThread): On master: COMMIT
2021-02-18 01:38:46.092397 (MainThread): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-18 01:38:46.092397 (MainThread): On master: Close
2021-02-18 01:38:46.345093 (MainThread): 19:38:46 | 
2021-02-18 01:38:46.364947 (MainThread): 19:38:46 | Finished running 1 table model in 13.26s.
2021-02-18 01:38:46.367901 (MainThread): Connection 'master' was properly closed.
2021-02-18 01:38:46.368901 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 01:38:46.369542 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 01:38:46.369706 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:38:46.444372 (MainThread): 
2021-02-18 01:38:46.444719 (MainThread): Completed successfully
2021-02-18 01:38:46.447344 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-18 01:38:46.448304 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F039E45348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F039DCD8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F039AABBC8>]}
2021-02-18 01:38:46.449147 (MainThread): Flushing usage events
2021-02-18 01:41:14.147332 (MainThread): Running with dbt=0.18.0
2021-02-18 01:41:14.888445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:41:14.889929 (MainThread): Tracking: tracking
2021-02-18 01:41:14.889929 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273F7E3FF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FBED1B88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FBED1A08>]}
2021-02-18 01:41:14.909129 (MainThread): Partial parsing not enabled
2021-02-18 01:41:14.910118 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:41:14.910118 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:41:14.913110 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:41:14.943515 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:41:14.945550 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:41:14.954475 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:41:14.956479 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:41:14.960351 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:41:14.964377 (MainThread): Parsing macros\core.sql
2021-02-18 01:41:14.968549 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:41:15.013787 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:41:15.023267 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:41:15.024263 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:41:15.025841 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:41:15.027868 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:41:15.030176 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:41:15.031277 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:41:15.040751 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:41:15.058275 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:41:15.060168 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:41:15.068170 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:41:15.091942 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:41:15.123646 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:41:15.125749 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:41:15.143432 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:41:15.151429 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:41:15.156516 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:41:15.163544 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:41:15.166536 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:41:15.167744 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:41:15.170365 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:41:15.176305 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:41:15.185357 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c846e25-7d40-4554-ac4b-93fab59e6072', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FBF11D08>]}
2021-02-18 01:41:15.186391 (MainThread): Partial parsing not enabled
2021-02-18 01:41:15.229613 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:41:15.247788 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:41:15.437455 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:41:15.438447 (MainThread): 
2021-02-18 01:41:15.438447 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:41:15.444173 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 01:41:15.463389 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 01:41:15.463389 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 01:41:15.464417 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 01:41:16.696772 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.23 seconds
2021-02-18 01:41:16.706368 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 01:41:17.112908 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:41:17.132201 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:41:17.132201 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 01:41:17.133143 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 01:41:18.147616 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.01 seconds
2021-02-18 01:41:18.155160 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 01:41:18.508188 (MainThread): Using snowflake connection "master".
2021-02-18 01:41:18.508454 (MainThread): On master: BEGIN
2021-02-18 01:41:18.508850 (MainThread): Opening a new connection, currently in state init
2021-02-18 01:41:20.135485 (MainThread): SQL status: SUCCESS 1 in 1.63 seconds
2021-02-18 01:41:20.136483 (MainThread): On master: COMMIT
2021-02-18 01:41:20.136483 (MainThread): Using snowflake connection "master".
2021-02-18 01:41:20.136483 (MainThread): On master: COMMIT
2021-02-18 01:41:20.558256 (MainThread): SQL status: SUCCESS 1 in 0.42 seconds
2021-02-18 01:41:20.558256 (MainThread): On master: Close
2021-02-18 01:41:20.846027 (MainThread): 19:41:20 | Concurrency: 16 threads (target='dev')
2021-02-18 01:41:20.871453 (MainThread): 19:41:20 | 
2021-02-18 01:41:20.888615 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 01:41:20.892604 (Thread-1): 19:41:20 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 01:41:20.946412 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:41:20.946412 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 01:41:20.993317 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:41:20.995363 (Thread-1): finished collecting timing info
2021-02-18 01:41:21.088231 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:41:21.092243 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:41:21.093240 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 01:41:21.093240 (Thread-1): Opening a new connection, currently in state init
2021-02-18 01:41:23.042622 (Thread-1): SQL status: SUCCESS 1 in 1.95 seconds
2021-02-18 01:41:23.043788 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:41:23.043788 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 01:41:26.563054 (Thread-1): SQL status: SUCCESS 1 in 3.52 seconds
2021-02-18 01:41:26.565049 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:41:26.566393 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:41:26.566393 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:41:26.844581 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-02-18 01:41:26.898329 (Thread-1): finished collecting timing info
2021-02-18 01:41:26.899642 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 01:41:27.240316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c846e25-7d40-4554-ac4b-93fab59e6072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FC289F88>]}
2021-02-18 01:41:27.243305 (Thread-1): 19:41:27 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 6.29s]
2021-02-18 01:41:27.244689 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 01:41:27.245333 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 01:41:27.248538 (Thread-3): 19:41:27 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 01:41:27.249102 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:41:27.249102 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 01:41:27.284600 (Thread-3): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 01:41:27.287399 (Thread-3): finished collecting timing info
2021-02-18 01:41:27.388333 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:41:27.389328 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY
ORDER BY L.L_ORDERKEY



  -- this filter will only be applied on an incremental run
  where event_time > (select max(event_time) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 01:41:27.389328 (Thread-3): Opening a new connection, currently in state init
2021-02-18 01:41:29.058003 (Thread-3): Snowflake query id: 019a5ce5-0553-d047-0000-4015003030c6
2021-02-18 01:41:29.058180 (Thread-3): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 2 unexpected 'where'.
2021-02-18 01:41:29.058699 (Thread-3): finished collecting timing info
2021-02-18 01:41:29.059222 (Thread-3): On model.dbtpoc.FactLineItem: Close
2021-02-18 01:41:29.290187 (Thread-3): Database Error in model FactLineItem (models\FactLineItem.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 2 unexpected 'where'.
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 31 at position 2 unexpected 'where'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 2 unexpected 'where'.
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:41:29.371493 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c846e25-7d40-4554-ac4b-93fab59e6072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FC1017C8>]}
2021-02-18 01:41:29.375682 (Thread-3): 19:41:29 | 2 of 2 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 2.12s]
2021-02-18 01:41:29.377476 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 01:41:29.473325 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:41:29.474439 (MainThread): Using snowflake connection "master".
2021-02-18 01:41:29.474439 (MainThread): On master: BEGIN
2021-02-18 01:41:29.474439 (MainThread): Opening a new connection, currently in state closed
2021-02-18 01:41:30.798682 (MainThread): SQL status: SUCCESS 1 in 1.32 seconds
2021-02-18 01:41:30.799475 (MainThread): On master: COMMIT
2021-02-18 01:41:30.799475 (MainThread): Using snowflake connection "master".
2021-02-18 01:41:30.800380 (MainThread): On master: COMMIT
2021-02-18 01:41:31.880471 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-18 01:41:31.880471 (MainThread): On master: Close
2021-02-18 01:41:32.414226 (MainThread): 19:41:32 | 
2021-02-18 01:41:32.415511 (MainThread): 19:41:32 | Finished running 1 table model, 1 incremental model in 16.98s.
2021-02-18 01:41:32.415511 (MainThread): Connection 'master' was properly closed.
2021-02-18 01:41:32.416221 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 01:41:32.416327 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 01:41:32.416327 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:41:32.416523 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 01:41:32.428547 (MainThread): 
2021-02-18 01:41:32.430107 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 01:41:32.431058 (MainThread): 
2021-02-18 01:41:32.432058 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 01:41:32.434051 (MainThread):   001003 (42000): SQL compilation error:
2021-02-18 01:41:32.435047 (MainThread):   syntax error line 31 at position 2 unexpected 'where'.
2021-02-18 01:41:32.435047 (MainThread):   compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:41:32.436045 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-02-18 01:41:32.437043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FC0B0A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FBEEE588>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273FC2D4348>]}
2021-02-18 01:41:32.437043 (MainThread): Flushing usage events
2021-02-18 01:42:22.574400 (MainThread): Running with dbt=0.18.0
2021-02-18 01:42:23.487453 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:42:23.489005 (MainThread): Tracking: tracking
2021-02-18 01:42:23.489005 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAD852FE88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC5BF8C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC5BFD48>]}
2021-02-18 01:42:23.510020 (MainThread): Partial parsing not enabled
2021-02-18 01:42:23.511018 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:42:23.512163 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:42:23.514010 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:42:23.549310 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:42:23.551159 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:42:23.564024 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:42:23.567098 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:42:23.572338 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:42:23.576328 (MainThread): Parsing macros\core.sql
2021-02-18 01:42:23.581761 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:42:23.634323 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:42:23.646773 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:42:23.648092 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:42:23.650642 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:42:23.660874 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:42:23.663365 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:42:23.664404 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:42:23.674039 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:42:23.689368 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:42:23.691363 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:42:23.698615 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:42:23.721527 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:42:23.753535 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:42:23.755539 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:42:23.773984 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:42:23.781136 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:42:23.786598 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:42:23.795059 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:42:23.800081 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:42:23.803073 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:42:23.804916 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:42:23.812760 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:42:23.821073 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b8fc81a-afc5-42ec-a97d-0c9bb7f17a1b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC515748>]}
2021-02-18 01:42:23.822072 (MainThread): Partial parsing not enabled
2021-02-18 01:42:23.891100 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:23.979426 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:42:24.193434 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:42:24.194217 (MainThread): 
2021-02-18 01:42:24.195204 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:42:24.199357 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 01:42:24.220345 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 01:42:24.220345 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 01:42:24.220345 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 01:42:25.451720 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.23 seconds
2021-02-18 01:42:25.460696 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 01:42:25.775600 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:42:25.794591 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:42:25.794591 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 01:42:25.795587 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 01:42:26.896058 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.10 seconds
2021-02-18 01:42:26.909370 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 01:42:27.125983 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:27.125983 (MainThread): On master: BEGIN
2021-02-18 01:42:27.125983 (MainThread): Opening a new connection, currently in state init
2021-02-18 01:42:28.074499 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 01:42:28.074499 (MainThread): On master: COMMIT
2021-02-18 01:42:28.075237 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:28.075500 (MainThread): On master: COMMIT
2021-02-18 01:42:28.479831 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-02-18 01:42:28.479831 (MainThread): On master: Close
2021-02-18 01:42:28.777381 (MainThread): 19:42:28 | Concurrency: 16 threads (target='dev')
2021-02-18 01:42:28.778377 (MainThread): 19:42:28 | 
2021-02-18 01:42:28.786401 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 01:42:28.789409 (Thread-1): 19:42:28 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 01:42:28.790804 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:28.791429 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 01:42:28.812408 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:42:28.814369 (Thread-1): finished collecting timing info
2021-02-18 01:42:28.847736 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:42:28.849466 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:28.849466 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 01:42:28.849466 (Thread-1): Opening a new connection, currently in state init
2021-02-18 01:42:29.747387 (Thread-1): SQL status: SUCCESS 1 in 0.90 seconds
2021-02-18 01:42:29.747387 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:29.747387 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 01:42:32.366175 (Thread-1): SQL status: SUCCESS 1 in 2.62 seconds
2021-02-18 01:42:32.368470 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:42:32.369694 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:32.369694 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:42:32.553099 (Thread-1): SQL status: SUCCESS 1 in 0.18 seconds
2021-02-18 01:42:32.569928 (Thread-1): finished collecting timing info
2021-02-18 01:42:32.569928 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 01:42:32.859123 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8fc81a-afc5-42ec-a97d-0c9bb7f17a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC8050C8>]}
2021-02-18 01:42:32.864067 (Thread-1): 19:42:32 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 4.07s]
2021-02-18 01:42:32.865751 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 01:42:32.866546 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 01:42:32.869671 (Thread-3): 19:42:32 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 01:42:32.871733 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:42:32.872732 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 01:42:32.896527 (Thread-3): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 01:42:32.898693 (Thread-3): finished collecting timing info
2021-02-18 01:42:32.938357 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:42:32.938357 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM"
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(L_RECEIPTDATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 01:42:32.938357 (Thread-3): Opening a new connection, currently in state init
2021-02-18 01:42:34.105372 (Thread-3): Snowflake query id: 019a5ce6-0548-a960-0000-4015003030de
2021-02-18 01:42:34.105691 (Thread-3): Snowflake error: 000904 (42000): SQL compilation error: error line 22 at position 58
invalid identifier 'L.L_PARTKEY'
2021-02-18 01:42:34.105691 (Thread-3): finished collecting timing info
2021-02-18 01:42:34.106478 (Thread-3): On model.dbtpoc.FactLineItem: Close
2021-02-18 01:42:34.313119 (Thread-3): Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 22 at position 58
  invalid identifier 'L.L_PARTKEY'
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 22 at position 58
invalid identifier 'L.L_PARTKEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 22 at position 58
  invalid identifier 'L.L_PARTKEY'
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:42:34.322081 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b8fc81a-afc5-42ec-a97d-0c9bb7f17a1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC8104C8>]}
2021-02-18 01:42:34.324129 (Thread-3): 19:42:34 | 2 of 2 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 1.45s]
2021-02-18 01:42:34.327026 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 01:42:34.352357 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:42:34.352357 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:34.352357 (MainThread): On master: BEGIN
2021-02-18 01:42:34.352357 (MainThread): Opening a new connection, currently in state closed
2021-02-18 01:42:35.198134 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-02-18 01:42:35.198134 (MainThread): On master: COMMIT
2021-02-18 01:42:35.198134 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:35.199132 (MainThread): On master: COMMIT
2021-02-18 01:42:35.539529 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-02-18 01:42:35.540253 (MainThread): On master: Close
2021-02-18 01:42:35.848493 (MainThread): 19:42:35 | 
2021-02-18 01:42:35.849440 (MainThread): 19:42:35 | Finished running 1 table model, 1 incremental model in 11.65s.
2021-02-18 01:42:35.850364 (MainThread): Connection 'master' was properly closed.
2021-02-18 01:42:35.850364 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 01:42:35.850364 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 01:42:35.850364 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:42:35.850364 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 01:42:35.863058 (MainThread): 
2021-02-18 01:42:35.863970 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 01:42:35.865067 (MainThread): 
2021-02-18 01:42:35.866051 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 01:42:35.867218 (MainThread):   000904 (42000): SQL compilation error: error line 22 at position 58
2021-02-18 01:42:35.867527 (MainThread):   invalid identifier 'L.L_PARTKEY'
2021-02-18 01:42:35.868044 (MainThread):   compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:42:35.869042 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-02-18 01:42:35.869042 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC859F48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC5F1388>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DADC9C9D88>]}
2021-02-18 01:42:35.870478 (MainThread): Flushing usage events
2021-02-18 01:42:50.902431 (MainThread): Running with dbt=0.18.0
2021-02-18 01:42:51.608424 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:42:51.619487 (MainThread): Tracking: tracking
2021-02-18 01:42:51.619487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478F817508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002478F817308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247919C1D08>]}
2021-02-18 01:42:51.641071 (MainThread): Partial parsing not enabled
2021-02-18 01:42:51.642146 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:42:51.643063 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:42:51.645057 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:42:51.679125 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:42:51.681000 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:42:51.693190 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:42:51.696138 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:42:51.701059 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:42:51.705953 (MainThread): Parsing macros\core.sql
2021-02-18 01:42:51.711509 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:42:51.761262 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:42:51.771315 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:42:51.773272 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:42:51.775267 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:42:51.777299 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:42:51.778295 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:42:51.780487 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:42:51.789581 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:42:51.806526 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:42:51.808543 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:42:51.815294 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:42:51.840354 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:42:51.871534 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:42:51.873568 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:42:51.891729 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:42:51.898430 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:42:51.904474 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:42:51.910333 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:42:51.913325 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:42:51.915332 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:42:51.917337 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:42:51.924172 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:42:51.932070 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ded9441-cdf0-460b-942f-ec574540c691', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791A41988>]}
2021-02-18 01:42:51.933069 (MainThread): Partial parsing not enabled
2021-02-18 01:42:51.979498 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:52.000317 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:42:52.175743 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:42:52.176951 (MainThread): 
2021-02-18 01:42:52.177698 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:42:52.181237 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 01:42:52.200292 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 01:42:52.200292 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 01:42:52.200292 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 01:42:53.571343 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.37 seconds
2021-02-18 01:42:53.580390 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 01:42:54.594379 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:42:54.604269 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:42:54.604269 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 01:42:54.604269 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 01:42:56.189660 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.59 seconds
2021-02-18 01:42:56.201238 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 01:42:56.572160 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:56.572160 (MainThread): On master: BEGIN
2021-02-18 01:42:56.573103 (MainThread): Opening a new connection, currently in state init
2021-02-18 01:42:57.520197 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 01:42:57.520197 (MainThread): On master: COMMIT
2021-02-18 01:42:57.520197 (MainThread): Using snowflake connection "master".
2021-02-18 01:42:57.521167 (MainThread): On master: COMMIT
2021-02-18 01:42:57.964524 (MainThread): SQL status: SUCCESS 1 in 0.44 seconds
2021-02-18 01:42:57.964524 (MainThread): On master: Close
2021-02-18 01:42:58.276436 (MainThread): 19:42:58 | Concurrency: 16 threads (target='dev')
2021-02-18 01:42:58.277627 (MainThread): 19:42:58 | 
2021-02-18 01:42:58.295728 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 01:42:58.298673 (Thread-1): 19:42:58 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 01:42:58.303227 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:58.303227 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 01:42:58.325390 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:42:58.326432 (Thread-1): finished collecting timing info
2021-02-18 01:42:58.362492 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:42:58.364486 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:58.364486 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 01:42:58.364486 (Thread-1): Opening a new connection, currently in state init
2021-02-18 01:42:59.145099 (Thread-1): SQL status: SUCCESS 1 in 0.78 seconds
2021-02-18 01:42:59.145099 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:42:59.145099 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 01:43:02.446416 (Thread-1): SQL status: SUCCESS 1 in 3.30 seconds
2021-02-18 01:43:02.449089 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:43:02.450257 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:43:02.450394 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:43:02.733457 (Thread-1): SQL status: SUCCESS 1 in 0.28 seconds
2021-02-18 01:43:02.765768 (Thread-1): finished collecting timing info
2021-02-18 01:43:02.765768 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 01:43:03.121707 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ded9441-cdf0-460b-942f-ec574540c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791BD3348>]}
2021-02-18 01:43:03.124765 (Thread-1): 19:43:03 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 4.82s]
2021-02-18 01:43:03.126688 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 01:43:03.128519 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 01:43:03.131677 (Thread-3): 19:43:03 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 01:43:03.134671 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:43:03.135596 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 01:43:03.164462 (Thread-3): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 01:43:03.167053 (Thread-3): finished collecting timing info
2021-02-18 01:43:03.214707 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:43:03.214707 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(L_RECEIPTDATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 01:43:03.215151 (Thread-3): Opening a new connection, currently in state init
2021-02-18 01:43:06.122295 (Thread-3): Snowflake query id: 019a5ce7-0572-2c84-0000-4015003030ea
2021-02-18 01:43:06.122295 (Thread-3): Snowflake error: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(L.L_RECEIPTDATE)] can only appear in having or select clause
2021-02-18 01:43:06.123213 (Thread-3): finished collecting timing info
2021-02-18 01:43:06.123213 (Thread-3): On model.dbtpoc.FactLineItem: Close
2021-02-18 01:43:06.674039 (Thread-3): Database Error in model FactLineItem (models\FactLineItem.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(L.L_RECEIPTDATE)] can only appear in having or select clause
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002036 (42601): SQL compilation error:
Subquery containing correlated aggregate function [MAX(L.L_RECEIPTDATE)] can only appear in having or select clause

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  002036 (42601): SQL compilation error:
  Subquery containing correlated aggregate function [MAX(L.L_RECEIPTDATE)] can only appear in having or select clause
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:43:06.680551 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ded9441-cdf0-460b-942f-ec574540c691', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791C037C8>]}
2021-02-18 01:43:06.682524 (Thread-3): 19:43:06 | 2 of 2 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 3.55s]
2021-02-18 01:43:06.684519 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 01:43:06.785069 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:43:06.785069 (MainThread): Using snowflake connection "master".
2021-02-18 01:43:06.786100 (MainThread): On master: BEGIN
2021-02-18 01:43:06.786100 (MainThread): Opening a new connection, currently in state closed
2021-02-18 01:43:08.066220 (MainThread): SQL status: SUCCESS 1 in 1.28 seconds
2021-02-18 01:43:08.066220 (MainThread): On master: COMMIT
2021-02-18 01:43:08.067238 (MainThread): Using snowflake connection "master".
2021-02-18 01:43:08.067238 (MainThread): On master: COMMIT
2021-02-18 01:43:08.693855 (MainThread): SQL status: SUCCESS 1 in 0.63 seconds
2021-02-18 01:43:08.694792 (MainThread): On master: Close
2021-02-18 01:43:09.072267 (MainThread): 19:43:09 | 
2021-02-18 01:43:09.073096 (MainThread): 19:43:09 | Finished running 1 table model, 1 incremental model in 16.90s.
2021-02-18 01:43:09.074071 (MainThread): Connection 'master' was properly closed.
2021-02-18 01:43:09.075087 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 01:43:09.075087 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 01:43:09.075087 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:43:09.075087 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 01:43:09.094439 (MainThread): 
2021-02-18 01:43:09.095434 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 01:43:09.096432 (MainThread): 
2021-02-18 01:43:09.096432 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 01:43:09.098427 (MainThread):   002036 (42601): SQL compilation error:
2021-02-18 01:43:09.098427 (MainThread):   Subquery containing correlated aggregate function [MAX(L.L_RECEIPTDATE)] can only appear in having or select clause
2021-02-18 01:43:09.099424 (MainThread):   compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 01:43:09.100562 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-02-18 01:43:09.101563 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791C18F88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791A919C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024791C791C8>]}
2021-02-18 01:43:09.101563 (MainThread): Flushing usage events
2021-02-18 01:44:23.742005 (MainThread): Running with dbt=0.18.0
2021-02-18 01:44:24.393589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 01:44:24.393589 (MainThread): Tracking: tracking
2021-02-18 01:44:24.393589 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FE62411C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA2D3288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA2D3148>]}
2021-02-18 01:44:24.417731 (MainThread): Partial parsing not enabled
2021-02-18 01:44:24.418758 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 01:44:24.419675 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 01:44:24.421832 (MainThread): Parsing macros\adapters.sql
2021-02-18 01:44:24.452190 (MainThread): Parsing macros\catalog.sql
2021-02-18 01:44:24.454307 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 01:44:24.463839 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 01:44:24.465374 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 01:44:24.469600 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 01:44:24.474276 (MainThread): Parsing macros\core.sql
2021-02-18 01:44:24.477449 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 01:44:24.524221 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 01:44:24.533201 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 01:44:24.534193 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 01:44:24.536198 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 01:44:24.538190 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 01:44:24.540178 (MainThread): Parsing macros\etc\query.sql
2021-02-18 01:44:24.541176 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 01:44:24.552159 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 01:44:24.568110 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 01:44:24.570126 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 01:44:24.577099 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 01:44:24.600166 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 01:44:24.631100 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 01:44:24.633098 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 01:44:24.650042 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 01:44:24.657050 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 01:44:24.661926 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 01:44:24.669320 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 01:44:24.671905 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 01:44:24.674331 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 01:44:24.675911 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 01:44:24.682886 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 01:44:24.697759 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c217089c-a12e-4d5b-9d5a-cba0b8424638', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA327B48>]}
2021-02-18 01:44:24.698756 (MainThread): Partial parsing not enabled
2021-02-18 01:44:24.743665 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:44:24.762658 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:24.924284 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 01:44:24.925282 (MainThread): 
2021-02-18 01:44:24.925282 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:44:24.929133 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 01:44:24.944296 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 01:44:24.945293 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 01:44:24.945293 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 01:44:26.163387 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.22 seconds
2021-02-18 01:44:26.171662 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 01:44:26.434142 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:44:26.447147 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 01:44:26.448144 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 01:44:26.448144 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 01:44:27.473078 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.02 seconds
2021-02-18 01:44:27.480254 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 01:44:27.711037 (MainThread): Using snowflake connection "master".
2021-02-18 01:44:27.711577 (MainThread): On master: BEGIN
2021-02-18 01:44:27.711577 (MainThread): Opening a new connection, currently in state init
2021-02-18 01:44:28.590077 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-02-18 01:44:28.590077 (MainThread): On master: COMMIT
2021-02-18 01:44:28.590077 (MainThread): Using snowflake connection "master".
2021-02-18 01:44:28.590077 (MainThread): On master: COMMIT
2021-02-18 01:44:28.983781 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-18 01:44:28.983781 (MainThread): On master: Close
2021-02-18 01:44:29.410399 (MainThread): 19:44:29 | Concurrency: 16 threads (target='dev')
2021-02-18 01:44:29.411398 (MainThread): 19:44:29 | 
2021-02-18 01:44:29.419539 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 01:44:29.422932 (Thread-1): 19:44:29 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 01:44:29.424532 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:44:29.424532 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 01:44:29.454579 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:44:29.454579 (Thread-1): finished collecting timing info
2021-02-18 01:44:29.491133 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 01:44:29.492721 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:44:29.492721 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 01:44:29.492721 (Thread-1): Opening a new connection, currently in state init
2021-02-18 01:44:30.640738 (Thread-1): SQL status: SUCCESS 1 in 1.15 seconds
2021-02-18 01:44:30.641735 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:44:30.641735 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 01:44:32.957318 (Thread-1): SQL status: SUCCESS 1 in 2.32 seconds
2021-02-18 01:44:32.960310 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:44:32.960310 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 01:44:32.960310 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 01:44:33.198854 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-02-18 01:44:33.225875 (Thread-1): finished collecting timing info
2021-02-18 01:44:33.225875 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 01:44:33.456906 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c217089c-a12e-4d5b-9d5a-cba0b8424638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA6DB9C8>]}
2021-02-18 01:44:33.459898 (Thread-1): 19:44:33 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 4.03s]
2021-02-18 01:44:33.462992 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 01:44:33.463885 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 01:44:33.466008 (Thread-3): 19:44:33 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 01:44:33.467006 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:33.467006 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 01:44:33.487764 (Thread-3): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 01:44:33.489275 (Thread-3): finished collecting timing info
2021-02-18 01:44:33.528441 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:33.528441 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 01:44:33.528441 (Thread-3): Opening a new connection, currently in state init
2021-02-18 01:44:36.892927 (Thread-3): SQL status: SUCCESS 1 in 3.36 seconds
2021-02-18 01:44:36.913068 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:36.913068 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
2021-02-18 01:44:37.158455 (Thread-3): SQL status: SUCCESS 13 in 0.25 seconds
2021-02-18 01:44:37.170422 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:37.171417 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 01:44:37.498289 (Thread-3): SQL status: SUCCESS 13 in 0.33 seconds
2021-02-18 01:44:37.508748 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:37.509068 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 01:44:37.686509 (Thread-3): SQL status: SUCCESS 13 in 0.18 seconds
2021-02-18 01:44:37.711043 (Thread-3): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 01:44:37.712518 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:37.712518 (Thread-3): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 01:44:38.009611 (Thread-3): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-18 01:44:38.009611 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:38.009611 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */


        insert into DBT_POC.dbt_jkolpak.FactLineItem ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
        (
            select "ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY"
            from DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
        );
2021-02-18 01:44:38.410034 (Thread-3): SQL status: SUCCESS 0 in 0.40 seconds
2021-02-18 01:44:38.412308 (Thread-3): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 01:44:38.413309 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 01:44:38.413309 (Thread-3): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 01:44:38.731323 (Thread-3): SQL status: SUCCESS 1 in 0.32 seconds
2021-02-18 01:44:38.739387 (Thread-3): finished collecting timing info
2021-02-18 01:44:38.740369 (Thread-3): On model.dbtpoc.FactLineItem: Close
2021-02-18 01:44:39.022780 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c217089c-a12e-4d5b-9d5a-cba0b8424638', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA509E88>]}
2021-02-18 01:44:39.025771 (Thread-3): 19:44:39 | 2 of 2 OK created incremental model dbt_jkolpak.FactLineItem......... [SUCCESS 0 in 5.55s]
2021-02-18 01:44:39.029015 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 01:44:39.103042 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 01:44:39.103042 (MainThread): Using snowflake connection "master".
2021-02-18 01:44:39.103042 (MainThread): On master: BEGIN
2021-02-18 01:44:39.103042 (MainThread): Opening a new connection, currently in state closed
2021-02-18 01:44:40.207212 (MainThread): SQL status: SUCCESS 1 in 1.10 seconds
2021-02-18 01:44:40.207212 (MainThread): On master: COMMIT
2021-02-18 01:44:40.208209 (MainThread): Using snowflake connection "master".
2021-02-18 01:44:40.208209 (MainThread): On master: COMMIT
2021-02-18 01:44:40.611566 (MainThread): SQL status: SUCCESS 1 in 0.40 seconds
2021-02-18 01:44:40.612564 (MainThread): On master: Close
2021-02-18 01:44:40.870642 (MainThread): 19:44:40 | 
2021-02-18 01:44:40.872637 (MainThread): 19:44:40 | Finished running 1 table model, 1 incremental model in 15.95s.
2021-02-18 01:44:40.873714 (MainThread): Connection 'master' was properly closed.
2021-02-18 01:44:40.874037 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 01:44:40.874037 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 01:44:40.874037 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 01:44:40.874628 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 01:44:40.892579 (MainThread): 
2021-02-18 01:44:40.893795 (MainThread): Completed successfully
2021-02-18 01:44:40.895388 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2021-02-18 01:44:40.896572 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA762A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA2BF908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FEA390148>]}
2021-02-18 01:44:40.896792 (MainThread): Flushing usage events
2021-02-18 02:03:07.333428 (MainThread): Running with dbt=0.18.0
2021-02-18 02:03:08.739965 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:03:08.741238 (MainThread): Tracking: tracking
2021-02-18 02:03:08.741484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C429D83348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C425CE1208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C429D750C8>]}
2021-02-18 02:03:08.761993 (MainThread): Partial parsing not enabled
2021-02-18 02:03:08.763220 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:03:08.764297 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:03:08.767035 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:03:08.801003 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:03:08.803535 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:03:08.814436 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:03:08.817736 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:03:08.823364 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:03:08.831539 (MainThread): Parsing macros\core.sql
2021-02-18 02:03:08.837375 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:03:08.885318 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:03:08.895887 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:03:08.897767 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:03:08.900461 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:03:08.903442 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:03:08.905845 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:03:08.907686 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:03:08.918672 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:03:08.936017 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:03:08.938885 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:03:08.948347 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:03:08.974715 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:03:09.007490 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:03:09.009750 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:03:09.029896 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:03:09.038924 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:03:09.045126 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:03:09.052900 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:03:09.057397 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:03:09.059392 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:03:09.061865 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:03:09.068488 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:03:09.076546 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b303a3c1-edd8-4df1-b5ed-e39d84768a92', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C429DA37C8>]}
2021-02-18 02:03:09.078541 (MainThread): Partial parsing not enabled
2021-02-18 02:03:09.124604 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:03:09.148431 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:09.446596 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:03:09.447345 (MainThread): 
2021-02-18 02:03:09.448335 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:03:09.452324 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:03:09.471804 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:03:09.471804 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:03:09.471804 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:03:10.993684 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.52 seconds
2021-02-18 02:03:11.003347 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:03:11.257661 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:03:11.272656 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:03:11.273653 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:03:11.273653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:03:12.324109 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.05 seconds
2021-02-18 02:03:12.339073 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:03:12.628375 (MainThread): Using snowflake connection "master".
2021-02-18 02:03:12.629274 (MainThread): On master: BEGIN
2021-02-18 02:03:12.629274 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:03:13.568485 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-02-18 02:03:13.568485 (MainThread): On master: COMMIT
2021-02-18 02:03:13.568485 (MainThread): Using snowflake connection "master".
2021-02-18 02:03:13.569482 (MainThread): On master: COMMIT
2021-02-18 02:03:13.948431 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-02-18 02:03:13.948431 (MainThread): On master: Close
2021-02-18 02:03:14.267691 (MainThread): 20:03:14 | Concurrency: 16 threads (target='dev')
2021-02-18 02:03:14.269190 (MainThread): 20:03:14 | 
2021-02-18 02:03:14.276667 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 02:03:14.278703 (Thread-1): 20:03:14 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 02:03:14.281698 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:03:14.281698 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 02:03:14.297641 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 02:03:14.298643 (Thread-1): finished collecting timing info
2021-02-18 02:03:14.329773 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 02:03:14.331758 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:03:14.331758 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 02:03:14.331758 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:03:15.188139 (Thread-1): SQL status: SUCCESS 1 in 0.86 seconds
2021-02-18 02:03:15.189136 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:03:15.189136 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 02:03:19.592993 (Thread-1): SQL status: SUCCESS 1 in 4.40 seconds
2021-02-18 02:03:19.595984 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 02:03:19.595984 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:03:19.595984 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 02:03:19.905624 (Thread-1): SQL status: SUCCESS 1 in 0.31 seconds
2021-02-18 02:03:19.933625 (Thread-1): finished collecting timing info
2021-02-18 02:03:19.934559 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 02:03:20.235334 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b303a3c1-edd8-4df1-b5ed-e39d84768a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C429FC6AC8>]}
2021-02-18 02:03:20.237775 (Thread-1): 20:03:20 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 5.95s]
2021-02-18 02:03:20.239261 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 02:03:20.240258 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:03:20.243301 (Thread-3): 20:03:20 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:03:20.246242 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:20.246242 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:03:20.268218 (Thread-3): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:03:20.269779 (Thread-3): finished collecting timing info
2021-02-18 02:03:20.296404 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:20.296404 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , CONCAT(L_ORDERKEY, L_LINENUMBER) AS ORDER_LINE_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:03:20.296404 (Thread-3): Opening a new connection, currently in state init
2021-02-18 02:03:22.154496 (Thread-3): SQL status: SUCCESS 1 in 1.86 seconds
2021-02-18 02:03:22.177436 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:22.177436 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
2021-02-18 02:03:22.562498 (Thread-3): SQL status: SUCCESS 14 in 0.39 seconds
2021-02-18 02:03:22.572398 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:22.572398 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:03:22.749401 (Thread-3): SQL status: SUCCESS 13 in 0.18 seconds
2021-02-18 02:03:22.758718 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:22.758718 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:03:22.971327 (Thread-3): SQL status: SUCCESS 13 in 0.21 seconds
2021-02-18 02:03:23.017794 (Thread-3): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:03:23.020787 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:23.020787 (Thread-3): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:03:23.190835 (Thread-3): SQL status: SUCCESS 1 in 0.17 seconds
2021-02-18 02:03:23.190835 (Thread-3): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:03:23.191709 (Thread-3): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

        
        
    

    

    merge into DBT_POC.dbt_jkolpak.FactLineItem as DBT_INTERNAL_DEST
        using DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.ORDER_LINE_KEY = DBT_INTERNAL_DEST.ORDER_LINE_KEY
        

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","LINE_NUMBER" = DBT_INTERNAL_SOURCE."LINE_NUMBER","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","EXTENDED_PRICE" = DBT_INTERNAL_SOURCE."EXTENDED_PRICE","LINE_DISCOUNT" = DBT_INTERNAL_SOURCE."LINE_DISCOUNT","LINE_TAX" = DBT_INTERNAL_SOURCE."LINE_TAX","LINE_RETURN_FLAG" = DBT_INTERNAL_SOURCE."LINE_RETURN_FLAG","LINE_SHIP_DATE" = DBT_INTERNAL_SOURCE."LINE_SHIP_DATE","LINE_RECEIPT_DATE" = DBT_INTERNAL_SOURCE."LINE_RECEIPT_DATE","LINE_COMMITDATE" = DBT_INTERNAL_SOURCE."LINE_COMMITDATE","SHIP_RECEIPT_LAG" = DBT_INTERNAL_SOURCE."SHIP_RECEIPT_LAG","LINE_PART_KEY" = DBT_INTERNAL_SOURCE."LINE_PART_KEY","LINE_SUPPLIER_KEY" = DBT_INTERNAL_SOURCE."LINE_SUPPLIER_KEY"
    

    when not matched then insert
        ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
    values
        ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
2021-02-18 02:03:23.426865 (Thread-3): Snowflake query id: 019a5cfb-0530-b7fc-0000-4015003041d2
2021-02-18 02:03:23.427591 (Thread-3): Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 49
invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
2021-02-18 02:03:23.427591 (Thread-3): finished collecting timing info
2021-02-18 02:03:23.427591 (Thread-3): On model.dbtpoc.FactLineItem: ROLLBACK
2021-02-18 02:03:23.675109 (Thread-3): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:03:24.007777 (Thread-3): Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 4 at position 49
  invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 4 at position 49
invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 4 at position 49
  invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:03:24.075066 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b303a3c1-edd8-4df1-b5ed-e39d84768a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C42A19E188>]}
2021-02-18 02:03:24.077409 (Thread-3): 20:03:24 | 2 of 2 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 3.83s]
2021-02-18 02:03:24.079055 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:03:24.166911 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:03:24.167912 (MainThread): Using snowflake connection "master".
2021-02-18 02:03:24.167912 (MainThread): On master: BEGIN
2021-02-18 02:03:24.167912 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:03:25.250428 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-18 02:03:25.251184 (MainThread): On master: COMMIT
2021-02-18 02:03:25.251485 (MainThread): Using snowflake connection "master".
2021-02-18 02:03:25.251485 (MainThread): On master: COMMIT
2021-02-18 02:03:25.735836 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-02-18 02:03:25.735836 (MainThread): On master: Close
2021-02-18 02:03:26.069638 (MainThread): 20:03:26 | 
2021-02-18 02:03:26.070047 (MainThread): 20:03:26 | Finished running 1 table model, 1 incremental model in 16.62s.
2021-02-18 02:03:26.071003 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:03:26.071964 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:03:26.071964 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:03:26.071964 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 02:03:26.071964 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:03:26.083043 (MainThread): 
2021-02-18 02:03:26.083931 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:03:26.084927 (MainThread): 
2021-02-18 02:03:26.085925 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:03:26.087007 (MainThread):   000904 (42000): SQL compilation error: error line 4 at position 49
2021-02-18 02:03:26.093904 (MainThread):   invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
2021-02-18 02:03:26.093904 (MainThread):   compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:03:26.094901 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-02-18 02:03:26.095899 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C42A273448>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C429D5AC48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C42A294F08>]}
2021-02-18 02:03:26.095899 (MainThread): Flushing usage events
2021-02-18 02:04:47.686435 (MainThread): Running with dbt=0.18.0
2021-02-18 02:04:48.696283 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:04:48.697274 (MainThread): Tracking: tracking
2021-02-18 02:04:48.698374 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60669EE08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B60669EA88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6066A00C8>]}
2021-02-18 02:04:48.719524 (MainThread): Partial parsing not enabled
2021-02-18 02:04:48.720355 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:04:48.721419 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:04:48.724491 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:04:48.755272 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:04:48.758253 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:04:48.768269 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:04:48.771219 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:04:48.776205 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:04:48.780232 (MainThread): Parsing macros\core.sql
2021-02-18 02:04:48.785541 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:04:48.841924 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:04:48.856416 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:04:48.858108 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:04:48.861129 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:04:48.863972 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:04:48.865967 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:04:48.868434 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:04:48.880926 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:04:48.898878 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:04:48.902054 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:04:48.913009 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:04:48.943909 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:04:48.981256 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:04:48.984306 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:04:49.004901 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:04:49.017018 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:04:49.025154 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:04:49.036249 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:04:49.039831 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:04:49.043304 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:04:49.046613 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:04:49.055308 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:04:49.064382 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f436aeda-d872-4ac8-8afa-33e6c54c2012', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B606703608>]}
2021-02-18 02:04:49.066371 (MainThread): Partial parsing not enabled
2021-02-18 02:04:49.119687 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:04:49.138115 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:04:49.317584 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:04:49.318582 (MainThread): 
2021-02-18 02:04:49.319580 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:04:49.323915 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:04:49.344499 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:04:49.344499 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:04:49.344499 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:04:50.585455 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.24 seconds
2021-02-18 02:04:50.593696 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:04:50.841278 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:04:50.850126 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:04:50.850126 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:04:50.851100 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:04:51.972260 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.12 seconds
2021-02-18 02:04:51.988216 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:04:52.251190 (MainThread): Using snowflake connection "master".
2021-02-18 02:04:52.251190 (MainThread): On master: BEGIN
2021-02-18 02:04:52.252230 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:04:53.203444 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 02:04:53.204436 (MainThread): On master: COMMIT
2021-02-18 02:04:53.204436 (MainThread): Using snowflake connection "master".
2021-02-18 02:04:53.204436 (MainThread): On master: COMMIT
2021-02-18 02:04:53.570453 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:04:53.570453 (MainThread): On master: Close
2021-02-18 02:04:53.825035 (MainThread): 20:04:53 | Concurrency: 16 threads (target='dev')
2021-02-18 02:04:53.826017 (MainThread): 20:04:53 | 
2021-02-18 02:04:53.834825 (Thread-1): Began running node model.dbtpoc.DimSupplier
2021-02-18 02:04:53.837816 (Thread-1): 20:04:53 | 1 of 2 START table model dbt_jkolpak.DimSupplier..................... [RUN]
2021-02-18 02:04:53.839810 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:04:53.840808 (Thread-1): Compiling model.dbtpoc.DimSupplier
2021-02-18 02:04:53.863898 (Thread-1): Writing injected SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 02:04:53.864742 (Thread-1): finished collecting timing info
2021-02-18 02:04:53.897692 (Thread-1): Writing runtime SQL for node "model.dbtpoc.DimSupplier"
2021-02-18 02:04:53.900647 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:04:53.900647 (Thread-1): On model.dbtpoc.DimSupplier: BEGIN
2021-02-18 02:04:53.900647 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:04:55.835811 (Thread-1): SQL status: SUCCESS 1 in 1.94 seconds
2021-02-18 02:04:55.835811 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:04:55.835811 (Thread-1): On model.dbtpoc.DimSupplier: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.DimSupplier"} */


      create or replace transient table DBT_POC.dbt_jkolpak.DimSupplier  as
      (

SELECT S_SUPPKEY AS SUPPLIER_KEY
    , S_NAME AS SUPPLIER_NAME
    , S_ADDRESS AS SUPPLIER_ADDRESS
    , S_PHONE AS SUPPLIER_PHONE_NUMBER
    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE
    , S_COMMENT AS SUPPLIER_COMMENT
    , N.N_NAME AS SUPPLIER_NATION
    , R.R_NAME AS SUPPLIER_REGION
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."SUPPLIER" S
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."NATION" N ON S.S_NATIONKEY = N.N_NATIONKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."REGION" R ON N.N_REGIONKEY = R.R_REGIONKEY
      );
2021-02-18 02:04:58.308631 (Thread-1): SQL status: SUCCESS 1 in 2.47 seconds
2021-02-18 02:04:58.310625 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 02:04:58.311622 (Thread-1): Using snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:04:58.311622 (Thread-1): On model.dbtpoc.DimSupplier: COMMIT
2021-02-18 02:04:58.472187 (Thread-1): SQL status: SUCCESS 1 in 0.16 seconds
2021-02-18 02:04:58.507420 (Thread-1): finished collecting timing info
2021-02-18 02:04:58.507648 (Thread-1): On model.dbtpoc.DimSupplier: Close
2021-02-18 02:04:58.768341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f436aeda-d872-4ac8-8afa-33e6c54c2012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6068B5E88>]}
2021-02-18 02:04:58.770151 (Thread-1): 20:04:58 | 1 of 2 OK created table model dbt_jkolpak.DimSupplier................ [SUCCESS 1 in 4.93s]
2021-02-18 02:04:58.773117 (Thread-1): Finished running node model.dbtpoc.DimSupplier
2021-02-18 02:04:58.774113 (Thread-3): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:04:58.777104 (Thread-3): 20:04:58 | 2 of 2 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:04:58.778103 (Thread-3): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:04:58.779099 (Thread-3): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:04:58.849067 (Thread-3): finished collecting timing info
2021-02-18 02:04:58.850019 (Thread-3): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 5, in top-level template code
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 475, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 387, in _compile_node
    node,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
2021-02-18 02:04:58.868087 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f436aeda-d872-4ac8-8afa-33e6c54c2012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6068C7EC8>]}
2021-02-18 02:04:58.869091 (Thread-3): 20:04:58 | 2 of 2 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 0.09s]
2021-02-18 02:04:58.870066 (Thread-3): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:04:58.890425 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:04:58.891458 (MainThread): Using snowflake connection "master".
2021-02-18 02:04:58.891458 (MainThread): On master: BEGIN
2021-02-18 02:04:58.891458 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:04:59.841793 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 02:04:59.841793 (MainThread): On master: COMMIT
2021-02-18 02:04:59.841793 (MainThread): Using snowflake connection "master".
2021-02-18 02:04:59.842781 (MainThread): On master: COMMIT
2021-02-18 02:05:00.208520 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:05:00.208520 (MainThread): On master: Close
2021-02-18 02:05:00.466045 (MainThread): 20:05:00 | 
2021-02-18 02:05:00.466963 (MainThread): 20:05:00 | Finished running 1 table model, 1 incremental model in 11.15s.
2021-02-18 02:05:00.467986 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:05:00.467986 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:05:00.467986 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:05:00.467986 (MainThread): Connection 'model.dbtpoc.DimSupplier' was properly closed.
2021-02-18 02:05:00.468956 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:05:00.489791 (MainThread): 
2021-02-18 02:05:00.490800 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:05:00.491786 (MainThread): 
2021-02-18 02:05:00.492785 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:05:00.493782 (MainThread):   'dbt_utils' is undefined
2021-02-18 02:05:00.494784 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-02-18 02:05:00.496773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B606893208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6066A05C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B606ADA948>]}
2021-02-18 02:05:00.497139 (MainThread): Flushing usage events
2021-02-18 02:10:29.759246 (MainThread): Running with dbt=0.18.0
2021-02-18 02:10:31.002114 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:10:31.019452 (MainThread): Tracking: tracking
2021-02-18 02:10:31.020642 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBA60B2C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FB8722088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBC7C0708>]}
2021-02-18 02:10:31.044702 (MainThread): Partial parsing not enabled
2021-02-18 02:10:31.045728 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:10:31.047688 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:10:31.050779 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:10:31.083783 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:10:31.086356 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:10:31.096808 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:10:31.099794 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:10:31.103783 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:10:31.108855 (MainThread): Parsing macros\core.sql
2021-02-18 02:10:31.113574 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:10:31.160607 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:10:31.171762 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:10:31.173535 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:10:31.175115 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:10:31.178303 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:10:31.179649 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:10:31.181648 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:10:31.192705 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:10:31.213028 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:10:31.216783 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:10:31.226823 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:10:31.250938 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:10:31.288955 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:10:31.291947 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:10:31.310064 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:10:31.320973 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:10:31.327287 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:10:31.335828 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:10:31.340035 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:10:31.341711 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:10:31.344219 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:10:31.351746 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:10:31.358512 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd691c4f4-9ba5-4f92-b14f-adb4811969aa', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBC79BE88>]}
2021-02-18 02:10:31.360508 (MainThread): Partial parsing not enabled
2021-02-18 02:10:31.413273 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:10:31.437000 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:10:31.443152 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBC970148>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBC970EC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023FBC970C08>]}
2021-02-18 02:10:31.443152 (MainThread): Flushing usage events
2021-02-18 02:10:31.950821 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:10:31.950821 (MainThread): Encountered an error:
2021-02-18 02:10:31.951824 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined
2021-02-18 02:10:31.964884 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 5, in top-level template code
jinja2.exceptions.UndefinedError: 'surrogate_key' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined

2021-02-18 02:11:41.789961 (MainThread): Running with dbt=0.18.0
2021-02-18 02:11:42.596086 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:11:42.597357 (MainThread): Tracking: tracking
2021-02-18 02:11:42.597357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFD13308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFD13188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFD21FC8>]}
2021-02-18 02:11:42.619008 (MainThread): Partial parsing not enabled
2021-02-18 02:11:42.619800 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:11:42.620782 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:11:42.623019 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:11:42.655938 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:11:42.657508 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:11:42.668414 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:11:42.670583 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:11:42.674679 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:11:42.679178 (MainThread): Parsing macros\core.sql
2021-02-18 02:11:42.682914 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:11:42.736474 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:11:42.745990 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:11:42.747049 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:11:42.748975 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:11:42.751362 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:11:42.752965 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:11:42.754890 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:11:42.767861 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:11:42.782819 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:11:42.785960 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:11:42.794847 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:11:42.832124 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:11:42.868211 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:11:42.870204 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:11:42.890740 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:11:42.898482 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:11:42.904754 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:11:42.911731 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:11:42.915008 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:11:42.916984 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:11:42.919170 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:11:42.928253 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:11:42.930183 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9df8c6f9-df96-49dc-9774-93c0e4e50d4f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFD206C8>]}
2021-02-18 02:11:42.931180 (MainThread): Partial parsing not enabled
2021-02-18 02:11:42.982728 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:11:43.006909 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:11:43.013531 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFEE9A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFEE9A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BFFEE9048>]}
2021-02-18 02:11:43.013531 (MainThread): Flushing usage events
2021-02-18 02:11:43.400081 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:11:43.400081 (MainThread): Encountered an error:
2021-02-18 02:11:43.401462 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined
2021-02-18 02:11:43.411971 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
jinja2.exceptions.UndefinedError: 'surrogate_key' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined

2021-02-18 02:11:56.412621 (MainThread): Running with dbt=0.18.0
2021-02-18 02:11:57.187683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:11:57.188598 (MainThread): Tracking: tracking
2021-02-18 02:11:57.188598 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CBCE4AC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CDE82348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CDE90788>]}
2021-02-18 02:11:57.211150 (MainThread): Partial parsing not enabled
2021-02-18 02:11:57.212187 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:11:57.213147 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:11:57.215078 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:11:57.247805 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:11:57.251034 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:11:57.260769 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:11:57.263762 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:11:57.267841 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:11:57.273029 (MainThread): Parsing macros\core.sql
2021-02-18 02:11:57.277874 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:11:57.332964 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:11:57.343940 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:11:57.345972 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:11:57.348306 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:11:57.350995 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:11:57.353204 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:11:57.353986 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:11:57.366205 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:11:57.383395 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:11:57.385588 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:11:57.391842 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:11:57.416783 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:11:57.448308 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:11:57.450291 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:11:57.467865 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:11:57.474921 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:11:57.480904 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:11:57.488001 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:11:57.545091 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:11:57.549761 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:11:57.556098 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:11:57.577021 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:11:57.592090 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15c4d719-d914-44be-816f-587e7c4b39d3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CBCCF148>]}
2021-02-18 02:11:57.594144 (MainThread): Partial parsing not enabled
2021-02-18 02:11:57.645864 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:11:57.664710 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:11:57.671687 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CE059C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CE059C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000227CE059608>]}
2021-02-18 02:11:57.671938 (MainThread): Flushing usage events
2021-02-18 02:11:58.048056 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:11:58.049053 (MainThread): Encountered an error:
2021-02-18 02:11:58.049590 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined
2021-02-18 02:11:58.054040 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
jinja2.exceptions.UndefinedError: 'surrogate_key' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'surrogate_key' is undefined

2021-02-18 02:13:19.286791 (MainThread): Running with dbt=0.18.0
2021-02-18 02:13:20.130373 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:13:20.131371 (MainThread): Tracking: tracking
2021-02-18 02:13:20.131371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D46C349C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D48DD0F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D48DE06C8>]}
2021-02-18 02:13:20.152180 (MainThread): Partial parsing not enabled
2021-02-18 02:13:20.153001 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:13:20.154009 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:13:20.156167 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:13:20.187150 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:13:20.189042 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:13:20.198706 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:13:20.200699 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:13:20.205027 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:13:20.208883 (MainThread): Parsing macros\core.sql
2021-02-18 02:13:20.213913 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:13:20.260754 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:13:20.270202 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:13:20.271100 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:13:20.272774 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:13:20.274803 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:13:20.277835 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:13:20.278975 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:13:20.288603 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:13:20.306208 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:13:20.308210 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:13:20.315913 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:13:20.339906 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:13:20.371939 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:13:20.373966 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:13:20.393905 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:13:20.401764 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:13:20.408070 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:13:20.415277 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:13:20.418381 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:13:20.419475 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:13:20.422346 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:13:20.429546 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:13:20.436629 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e5245869-0d37-4fc5-bd53-e92bd3b44cd6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D48E161C8>]}
2021-02-18 02:13:20.438838 (MainThread): Partial parsing not enabled
2021-02-18 02:13:20.490255 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:13:20.513704 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:13:20.738715 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:13:20.740676 (MainThread): 
2021-02-18 02:13:20.740676 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:13:20.743667 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:13:20.766607 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:13:20.766607 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:13:20.766607 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:13:22.134876 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.37 seconds
2021-02-18 02:13:22.140569 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:13:22.429387 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:13:22.447119 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:13:22.448071 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:13:22.448071 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:13:24.578056 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 2.13 seconds
2021-02-18 02:13:24.585026 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:13:24.822710 (MainThread): Using snowflake connection "master".
2021-02-18 02:13:24.823002 (MainThread): On master: BEGIN
2021-02-18 02:13:24.823077 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:13:25.723167 (MainThread): SQL status: SUCCESS 1 in 0.90 seconds
2021-02-18 02:13:25.723167 (MainThread): On master: COMMIT
2021-02-18 02:13:25.723167 (MainThread): Using snowflake connection "master".
2021-02-18 02:13:25.723167 (MainThread): On master: COMMIT
2021-02-18 02:13:26.308986 (MainThread): SQL status: SUCCESS 1 in 0.59 seconds
2021-02-18 02:13:26.310090 (MainThread): On master: Close
2021-02-18 02:13:26.574405 (MainThread): 20:13:26 | Concurrency: 16 threads (target='dev')
2021-02-18 02:13:26.574925 (MainThread): 20:13:26 | 
2021-02-18 02:13:26.590001 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:13:26.592579 (Thread-1): 20:13:26 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:13:26.593128 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:13:26.593128 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:13:26.617661 (Thread-1): finished collecting timing info
2021-02-18 02:13:26.618923 (Thread-1): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 5, in top-level template code
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 475, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 387, in _compile_node
    node,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
2021-02-18 02:13:26.627768 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5245869-0d37-4fc5-bd53-e92bd3b44cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D48FFCA88>]}
2021-02-18 02:13:26.629623 (Thread-1): 20:13:26 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 0.03s]
2021-02-18 02:13:26.630590 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:13:26.690014 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:13:26.691011 (MainThread): Using snowflake connection "master".
2021-02-18 02:13:26.691011 (MainThread): On master: BEGIN
2021-02-18 02:13:26.691011 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:13:27.739944 (MainThread): SQL status: SUCCESS 1 in 1.05 seconds
2021-02-18 02:13:27.739944 (MainThread): On master: COMMIT
2021-02-18 02:13:27.740529 (MainThread): Using snowflake connection "master".
2021-02-18 02:13:27.740948 (MainThread): On master: COMMIT
2021-02-18 02:13:28.051044 (MainThread): SQL status: SUCCESS 1 in 0.31 seconds
2021-02-18 02:13:28.051044 (MainThread): On master: Close
2021-02-18 02:13:28.348698 (MainThread): 20:13:28 | 
2021-02-18 02:13:28.350351 (MainThread): 20:13:28 | Finished running 1 incremental model in 7.61s.
2021-02-18 02:13:28.350351 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:13:28.350351 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:13:28.351849 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:13:28.351849 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:13:28.360018 (MainThread): 
2021-02-18 02:13:28.367858 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:13:28.368858 (MainThread): 
2021-02-18 02:13:28.369853 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:13:28.370851 (MainThread):   'dbt_utils' is undefined
2021-02-18 02:13:28.371850 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:13:28.372846 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D49026488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D490266C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014D48FFC288>]}
2021-02-18 02:13:28.373842 (MainThread): Flushing usage events
2021-02-18 02:13:41.544143 (MainThread): Running with dbt=0.18.0
2021-02-18 02:13:42.568407 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:13:42.588025 (MainThread): Tracking: tracking
2021-02-18 02:13:42.588947 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D776483248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D776483048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77648F688>]}
2021-02-18 02:13:42.633020 (MainThread): Partial parsing not enabled
2021-02-18 02:13:42.634032 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:13:42.635067 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:13:42.637939 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:13:42.681903 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:13:42.684962 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:13:42.702982 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:13:42.707989 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:13:42.714033 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:13:42.722652 (MainThread): Parsing macros\core.sql
2021-02-18 02:13:42.730325 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:13:42.803017 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:13:42.817035 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:13:42.818993 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:13:42.821987 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:13:42.823980 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:13:42.825772 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:13:42.827768 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:13:42.838955 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:13:42.870908 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:13:42.873899 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:13:42.886608 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:13:42.931878 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:13:42.974815 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:13:42.976893 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:13:42.997580 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:13:43.008005 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:13:43.013057 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:13:43.021192 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:13:43.024275 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:13:43.026974 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:13:43.029966 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:13:43.037914 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:13:43.040870 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'db5448e7-3c52-4e8e-9a20-dfb84b752789', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7763D63C8>]}
2021-02-18 02:13:43.041867 (MainThread): Partial parsing not enabled
2021-02-18 02:13:43.093791 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:13:43.176832 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:13:43.191594 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77664EE48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77664E548>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D77665C148>]}
2021-02-18 02:13:43.192814 (MainThread): Flushing usage events
2021-02-18 02:13:43.734936 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:13:43.734936 (MainThread): Encountered an error:
2021-02-18 02:13:43.736011 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'pretty_time' is undefined
2021-02-18 02:13:43.741915 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 6, in top-level template code
jinja2.exceptions.UndefinedError: 'pretty_time' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'pretty_time' is undefined

2021-02-18 02:14:38.813205 (MainThread): Running with dbt=0.18.0
2021-02-18 02:14:40.101826 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:14:40.102824 (MainThread): Tracking: tracking
2021-02-18 02:14:40.104065 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026731B64B48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672FC71308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733D02E48>]}
2021-02-18 02:14:40.126818 (MainThread): Partial parsing not enabled
2021-02-18 02:14:40.128036 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:14:40.128846 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:14:40.130807 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:14:40.163878 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:14:40.168207 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:14:40.179761 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:14:40.182086 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:14:40.188064 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:14:40.194921 (MainThread): Parsing macros\core.sql
2021-02-18 02:14:40.201613 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:14:40.265294 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:14:40.283953 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:14:40.286945 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:14:40.290934 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:14:40.294923 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:14:40.298913 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:14:40.302082 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:14:40.322575 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:14:40.344641 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:14:40.347633 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:14:40.355064 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:14:40.388512 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:14:40.445997 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:14:40.449102 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:14:40.482276 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:14:40.497697 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:14:40.508970 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:14:40.520712 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:14:40.524954 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:14:40.528281 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:14:40.531267 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:14:40.537928 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:14:40.544904 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2ed8bf5f-4be5-4de7-9d78-5ab117420c9f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733D100C8>]}
2021-02-18 02:14:40.545893 (MainThread): Partial parsing not enabled
2021-02-18 02:14:40.592956 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:14:40.613792 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:14:40.807511 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 145 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:14:40.807925 (MainThread): 
2021-02-18 02:14:40.808922 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:14:40.810917 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:14:40.827067 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:14:40.827067 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:14:40.827067 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:14:42.040840 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.21 seconds
2021-02-18 02:14:42.046134 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:14:42.352920 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:14:42.378095 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:14:42.379082 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:14:42.379082 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:14:44.542738 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 2.16 seconds
2021-02-18 02:14:44.555104 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:14:44.829157 (MainThread): Using snowflake connection "master".
2021-02-18 02:14:44.829157 (MainThread): On master: BEGIN
2021-02-18 02:14:44.829157 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:14:46.066672 (MainThread): SQL status: SUCCESS 1 in 1.24 seconds
2021-02-18 02:14:46.066672 (MainThread): On master: COMMIT
2021-02-18 02:14:46.066672 (MainThread): Using snowflake connection "master".
2021-02-18 02:14:46.066672 (MainThread): On master: COMMIT
2021-02-18 02:14:46.497865 (MainThread): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-18 02:14:46.497865 (MainThread): On master: Close
2021-02-18 02:14:46.716628 (MainThread): 20:14:46 | Concurrency: 16 threads (target='dev')
2021-02-18 02:14:46.717625 (MainThread): 20:14:46 | 
2021-02-18 02:14:46.724774 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:14:46.727224 (Thread-1): 20:14:46 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:14:46.728223 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:14:46.728223 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:14:46.813904 (Thread-1): finished collecting timing info
2021-02-18 02:14:46.815891 (Thread-1): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 5, in top-level template code
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 407, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 270, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\compile.py", line 23, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 475, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\compilation.py", line 387, in _compile_node
    node,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 501, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  'dbt_utils' is undefined
2021-02-18 02:14:46.830098 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed8bf5f-4be5-4de7-9d78-5ab117420c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733F3BEC8>]}
2021-02-18 02:14:46.833094 (Thread-1): 20:14:46 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 0.10s]
2021-02-18 02:14:46.835085 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:14:46.926942 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:14:46.926942 (MainThread): Using snowflake connection "master".
2021-02-18 02:14:46.927939 (MainThread): On master: BEGIN
2021-02-18 02:14:46.927939 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:14:48.011877 (MainThread): SQL status: SUCCESS 1 in 1.08 seconds
2021-02-18 02:14:48.011877 (MainThread): On master: COMMIT
2021-02-18 02:14:48.012934 (MainThread): Using snowflake connection "master".
2021-02-18 02:14:48.012934 (MainThread): On master: COMMIT
2021-02-18 02:14:48.378099 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:14:48.378568 (MainThread): On master: Close
2021-02-18 02:14:48.709682 (MainThread): 20:14:48 | 
2021-02-18 02:14:48.710733 (MainThread): 20:14:48 | Finished running 1 incremental model in 7.90s.
2021-02-18 02:14:48.711633 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:14:48.711633 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:14:48.712635 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:14:48.712635 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:14:48.724911 (MainThread): 
2021-02-18 02:14:48.726054 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:14:48.727901 (MainThread): 
2021-02-18 02:14:48.728937 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:14:48.729935 (MainThread):   'dbt_utils' is undefined
2021-02-18 02:14:48.731890 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:14:48.732887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733E021C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733D93708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026733DE6C48>]}
2021-02-18 02:14:48.733887 (MainThread): Flushing usage events
2021-02-18 02:16:22.682108 (MainThread): Running with dbt=0.18.0
2021-02-18 02:16:23.376889 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='deps', write_json=True)
2021-02-18 02:16:23.377865 (MainThread): Tracking: tracking
2021-02-18 02:16:23.377865 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDF81C0CC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDF7B527C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC30E348>]}
2021-02-18 02:16:23.379880 (MainThread): Set downloads directory='C:\Users\jkolpak\AppData\Local\Temp\dbt-downloads-q1fv62an'
2021-02-18 02:16:23.380847 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2021-02-18 02:16:23.852389 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2021-02-18 02:16:23.852389 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-02-18 02:16:24.133821 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-02-18 02:16:24.158060 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.1.24.json
2021-02-18 02:16:24.504009 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.1.24.json 200
2021-02-18 02:16:24.509589 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2021-02-18 02:16:24.780095 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2021-02-18 02:16:24.803059 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.1.24.json
2021-02-18 02:16:25.080115 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils/0.1.24.json 200
2021-02-18 02:16:25.082278 (MainThread): Installing fishtown-analytics/dbt_utils@0.1.24
2021-02-18 02:16:26.009736 (MainThread):   Installed from version 0.1.24

2021-02-18 02:16:26.010843 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '57b3057f-dc09-4d40-b66b-6f7c03ed68a8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC2C9A88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC448348>]}
2021-02-18 02:16:26.011697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC2FE288>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC4872C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDFC2E72C8>]}
2021-02-18 02:16:26.011697 (MainThread): Flushing usage events
2021-02-18 02:16:41.426104 (MainThread): Running with dbt=0.18.0
2021-02-18 02:16:42.134295 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:16:42.157668 (MainThread): Tracking: tracking
2021-02-18 02:16:42.157668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF16D0908>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF16D0948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF168A7C8>]}
2021-02-18 02:16:42.227558 (MainThread): Partial parsing not enabled
2021-02-18 02:16:42.228553 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:16:42.229554 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:16:42.231822 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:16:42.265676 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:16:42.267693 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:16:42.277570 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:16:42.279563 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:16:42.284139 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:16:42.290146 (MainThread): Parsing macros\core.sql
2021-02-18 02:16:42.294326 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:16:42.343831 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:16:42.352985 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:16:42.353982 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:16:42.356314 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:16:42.358305 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:16:42.361260 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:16:42.362258 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:16:42.372858 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:16:42.389614 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:16:42.391672 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:16:42.398505 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:16:42.422798 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:16:42.457548 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:16:42.460204 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:16:42.478900 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:16:42.486922 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:16:42.492845 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:16:42.499741 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:16:42.502696 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:16:42.504935 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:16:42.507684 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:16:42.514917 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:16:42.521437 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:16:42.530153 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:16:42.540887 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:16:42.545783 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:16:42.550798 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:16:42.553956 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:16:42.555959 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:16:42.558775 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:16:42.559771 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:16:42.561772 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:16:42.565850 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:16:42.567825 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:16:42.568844 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:16:42.570838 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:16:42.571836 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:16:42.575017 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:16:42.577774 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:16:42.578983 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:16:42.580979 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:16:42.584619 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:16:42.585597 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:16:42.611908 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:16:42.612876 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:16:42.613902 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:16:42.616895 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:16:42.618996 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:16:42.619856 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:16:42.621060 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:16:42.622906 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:16:42.625916 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:16:42.627992 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:16:42.630988 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:16:42.633976 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:16:42.635815 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:16:42.637132 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:16:42.638071 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:16:42.641226 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:16:42.644039 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:16:42.645864 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:16:42.653044 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:16:42.657356 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:16:42.658981 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:16:42.660668 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:16:42.667546 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:16:42.675930 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdea1c20-6d08-4d80-ad59-965e1a3cbc2a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1768748>]}
2021-02-18 02:16:42.676901 (MainThread): Partial parsing not enabled
2021-02-18 02:16:42.723929 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:16:42.743766 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:16:42.756896 (MainThread): * Deprecation Warning: The "adapter_macro" macro has been deprecated. Instead,
use the `adapter.dispatch` method to find a macro and call the result.
adapter_macro was called for: dbt_utils.type_string
2021-02-18 02:16:42.757902 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fdea1c20-6d08-4d80-ad59-965e1a3cbc2a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1955B48>]}
2021-02-18 02:16:43.216027 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:16:43.218014 (MainThread): 
2021-02-18 02:16:43.219009 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:16:43.222000 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:16:43.245337 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:16:43.246047 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:16:43.246047 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:16:44.315972 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.07 seconds
2021-02-18 02:16:44.321940 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:16:44.587017 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:16:44.600157 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:16:44.600157 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:16:44.600157 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:16:45.552944 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.95 seconds
2021-02-18 02:16:45.560040 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:16:45.806845 (MainThread): Using snowflake connection "master".
2021-02-18 02:16:45.807417 (MainThread): On master: BEGIN
2021-02-18 02:16:45.807417 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:16:46.597895 (MainThread): SQL status: SUCCESS 1 in 0.79 seconds
2021-02-18 02:16:46.597895 (MainThread): On master: COMMIT
2021-02-18 02:16:46.598893 (MainThread): Using snowflake connection "master".
2021-02-18 02:16:46.598893 (MainThread): On master: COMMIT
2021-02-18 02:16:46.972860 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:16:46.973462 (MainThread): On master: Close
2021-02-18 02:16:47.215649 (MainThread): 20:16:47 | Concurrency: 16 threads (target='dev')
2021-02-18 02:16:47.216599 (MainThread): 20:16:47 | 
2021-02-18 02:16:47.225577 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:16:47.229582 (Thread-1): 20:16:47 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:16:47.232555 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:16:47.233553 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:16:47.274949 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:16:47.277903 (Thread-1): finished collecting timing info
2021-02-18 02:16:47.330815 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:16:47.330815 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , 

    md5(cast(
  
    
    coalesce(cast(['L_ORDERKEY', 'L_LINENUMBER'] as 
  
    varchar

), '')


 as 
  
    varchar

))
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:16:47.330815 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:16:48.418709 (Thread-1): Snowflake query id: 019a5d08-05d3-0df7-0000-4015003031e6
2021-02-18 02:16:48.418709 (Thread-1): Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 18 unexpected '['.
syntax error line 11 at position 47 unexpected ']'.
syntax error line 22 at position 1 unexpected ')'.
2021-02-18 02:16:48.419699 (Thread-1): finished collecting timing info
2021-02-18 02:16:48.420697 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:16:48.564716 (Thread-1): Database Error in model FactLineItem (models\FactLineItem.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 18 unexpected '['.
  syntax error line 11 at position 47 unexpected ']'.
  syntax error line 22 at position 1 unexpected ')'.
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 001003 (42000): SQL compilation error:
syntax error line 11 at position 18 unexpected '['.
syntax error line 11 at position 47 unexpected ']'.
syntax error line 22 at position 1 unexpected ')'.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 18 unexpected '['.
  syntax error line 11 at position 47 unexpected ']'.
  syntax error line 22 at position 1 unexpected ')'.
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 02:16:48.636014 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdea1c20-6d08-4d80-ad59-965e1a3cbc2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1D6CD08>]}
2021-02-18 02:16:48.638065 (Thread-1): 20:16:48 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 1.40s]
2021-02-18 02:16:48.639926 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:16:48.650135 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:16:48.650444 (MainThread): Using snowflake connection "master".
2021-02-18 02:16:48.650444 (MainThread): On master: BEGIN
2021-02-18 02:16:48.650444 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:16:49.518757 (MainThread): SQL status: SUCCESS 1 in 0.87 seconds
2021-02-18 02:16:49.519317 (MainThread): On master: COMMIT
2021-02-18 02:16:49.519553 (MainThread): Using snowflake connection "master".
2021-02-18 02:16:49.520001 (MainThread): On master: COMMIT
2021-02-18 02:16:49.972355 (MainThread): SQL status: SUCCESS 1 in 0.45 seconds
2021-02-18 02:16:49.972355 (MainThread): On master: Close
2021-02-18 02:16:50.198260 (MainThread): 20:16:50 | 
2021-02-18 02:16:50.199184 (MainThread): 20:16:50 | Finished running 1 incremental model in 6.98s.
2021-02-18 02:16:50.200141 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:16:50.201136 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:16:50.201136 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:16:50.201136 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:16:50.211715 (MainThread): 
2021-02-18 02:16:50.215768 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:16:50.217764 (MainThread): 
2021-02-18 02:16:50.219060 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:16:50.220757 (MainThread):   001003 (42000): SQL compilation error:
2021-02-18 02:16:50.222749 (MainThread):   syntax error line 11 at position 18 unexpected '['.
2021-02-18 02:16:50.223794 (MainThread):   syntax error line 11 at position 47 unexpected ']'.
2021-02-18 02:16:50.224314 (MainThread):   syntax error line 22 at position 1 unexpected ')'.
2021-02-18 02:16:50.225305 (MainThread):   compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 02:16:50.226404 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:16:50.230688 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1E9F248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1D66C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FF1B90D48>]}
2021-02-18 02:16:50.230688 (MainThread): Flushing usage events
2021-02-18 02:17:10.634276 (MainThread): Running with dbt=0.18.0
2021-02-18 02:17:11.563411 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:17:11.563411 (MainThread): Tracking: tracking
2021-02-18 02:17:11.564409 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CCC948C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9C8C0FF88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CCCA2D48>]}
2021-02-18 02:17:11.597698 (MainThread): Partial parsing not enabled
2021-02-18 02:17:11.598720 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:17:11.599704 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:17:11.601702 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:17:11.637443 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:17:11.640392 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:17:11.652541 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:17:11.655639 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:17:11.661087 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:17:11.665860 (MainThread): Parsing macros\core.sql
2021-02-18 02:17:11.670575 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:17:11.792224 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:17:11.801988 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:17:11.803485 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:17:11.805024 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:17:11.808086 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:17:11.810011 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:17:11.811145 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:17:11.821479 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:17:11.837977 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:17:11.839972 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:17:11.848083 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:17:11.873935 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:17:11.910747 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:17:11.913699 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:17:11.933349 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:17:11.941120 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:17:11.947279 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:17:11.953605 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:17:11.956728 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:17:11.958723 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:17:11.960717 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:17:11.965006 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:17:11.968617 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:17:11.971554 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:17:11.977525 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:17:11.979478 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:17:11.982501 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:17:11.984671 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:17:11.985665 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:17:11.987441 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:17:11.988441 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:17:11.990405 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:17:11.993396 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:17:11.995081 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:17:11.995938 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:17:11.998049 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:17:11.999082 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:17:12.002125 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:17:12.004662 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:17:12.007632 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:17:12.008629 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:17:12.012961 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:17:12.013905 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:17:12.040123 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:17:12.041126 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:17:12.043115 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:17:12.046110 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:17:12.048209 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:17:12.049217 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:17:12.050286 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:17:12.051211 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:17:12.055057 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:17:12.057018 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:17:12.060010 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:17:12.063670 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:17:12.064679 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:17:12.065680 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:17:12.066714 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:17:12.070217 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:17:12.073209 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:17:12.074789 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:17:12.082882 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:17:12.086896 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:17:12.089028 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:17:12.089772 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:17:12.097805 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:17:12.098802 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0dfa78d6-ad28-4e4e-81d6-87e2b7ee5f78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CCD7F608>]}
2021-02-18 02:17:12.099800 (MainThread): Partial parsing not enabled
2021-02-18 02:17:12.149867 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:17:12.175914 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:12.187316 (MainThread): * Deprecation Warning: The "adapter_macro" macro has been deprecated. Instead,
use the `adapter.dispatch` method to find a macro and call the result.
adapter_macro was called for: dbt_utils.type_string
2021-02-18 02:17:12.187900 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0dfa78d6-ad28-4e4e-81d6-87e2b7ee5f78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CCEF9D88>]}
2021-02-18 02:17:12.473420 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:17:12.474418 (MainThread): 
2021-02-18 02:17:12.474418 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:17:12.477510 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:17:12.496996 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:17:12.496996 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:17:12.496996 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:17:13.652023 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.16 seconds
2021-02-18 02:17:13.656947 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:17:13.896237 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:17:13.910045 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:17:13.911096 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:17:13.911353 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:17:14.868456 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.96 seconds
2021-02-18 02:17:14.883041 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:17:15.166459 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:15.167479 (MainThread): On master: BEGIN
2021-02-18 02:17:15.167479 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:17:16.104723 (MainThread): SQL status: SUCCESS 1 in 0.94 seconds
2021-02-18 02:17:16.104723 (MainThread): On master: COMMIT
2021-02-18 02:17:16.105598 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:16.105598 (MainThread): On master: COMMIT
2021-02-18 02:17:16.496097 (MainThread): SQL status: SUCCESS 1 in 0.39 seconds
2021-02-18 02:17:16.496097 (MainThread): On master: Close
2021-02-18 02:17:16.898857 (MainThread): 20:17:16 | Concurrency: 16 threads (target='dev')
2021-02-18 02:17:16.900325 (MainThread): 20:17:16 | 
2021-02-18 02:17:16.915858 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:17:16.918774 (Thread-1): 20:17:16 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:17:16.919804 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:16.920767 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:17:16.959172 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:17:16.960398 (Thread-1): finished collecting timing info
2021-02-18 02:17:17.008053 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:17.008967 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , 

    
        
    

    md5(cast(
  
    
    coalesce(cast(L_ORDERKEY as 
  
    varchar

), '') || '-' || coalesce(cast(L_LINENUMBER as 
  
    varchar

), '')


 as 
  
    varchar

))
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:17:17.008967 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:17:18.253843 (Thread-1): Snowflake query id: 019a5d09-05d3-fe23-0000-40150030215e
2021-02-18 02:17:18.255111 (Thread-1): Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
2021-02-18 02:17:18.255111 (Thread-1): finished collecting timing info
2021-02-18 02:17:18.256659 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:17:18.528882 (Thread-1): Database Error in model FactLineItem (models\FactLineItem.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 002022 (42601): SQL compilation error:
Missing column specification

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 33, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 02:17:18.538690 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dfa78d6-ad28-4e4e-81d6-87e2b7ee5f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD3786C8>]}
2021-02-18 02:17:18.541505 (Thread-1): 20:17:18 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 1.62s]
2021-02-18 02:17:18.543395 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:17:18.636913 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:17:18.637911 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:18.637911 (MainThread): On master: BEGIN
2021-02-18 02:17:18.637911 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:17:19.890868 (MainThread): SQL status: SUCCESS 1 in 1.25 seconds
2021-02-18 02:17:19.890980 (MainThread): On master: COMMIT
2021-02-18 02:17:19.890980 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:19.891866 (MainThread): On master: COMMIT
2021-02-18 02:17:20.299974 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-02-18 02:17:20.301068 (MainThread): On master: Close
2021-02-18 02:17:20.605044 (MainThread): 20:17:20 | 
2021-02-18 02:17:20.606026 (MainThread): 20:17:20 | Finished running 1 incremental model in 8.13s.
2021-02-18 02:17:20.607024 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:17:20.607024 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:17:20.607024 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:17:20.607024 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:17:20.617047 (MainThread): 
2021-02-18 02:17:20.626588 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:17:20.627584 (MainThread): 
2021-02-18 02:17:20.627584 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:17:20.629579 (MainThread):   002022 (42601): SQL compilation error:
2021-02-18 02:17:20.630645 (MainThread):   Missing column specification
2021-02-18 02:17:20.641894 (MainThread):   compiled SQL at target\compiled\dbtpoc\models\FactLineItem.sql
2021-02-18 02:17:20.642851 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:17:20.643847 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD4ECD88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD4AB4C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9CD166CC8>]}
2021-02-18 02:17:20.643847 (MainThread): Flushing usage events
2021-02-18 02:17:42.812471 (MainThread): Running with dbt=0.18.0
2021-02-18 02:17:43.494801 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:17:43.495550 (MainThread): Tracking: tracking
2021-02-18 02:17:43.495550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEDFDD1348>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE3E653C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE3E71988>]}
2021-02-18 02:17:43.527537 (MainThread): Partial parsing not enabled
2021-02-18 02:17:43.528821 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:17:43.529531 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:17:43.532280 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:17:43.564683 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:17:43.567609 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:17:43.577814 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:17:43.579837 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:17:43.584140 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:17:43.589260 (MainThread): Parsing macros\core.sql
2021-02-18 02:17:43.593352 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:17:43.638936 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:17:43.648617 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:17:43.649614 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:17:43.651713 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:17:43.653574 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:17:43.655573 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:17:43.657605 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:17:43.676784 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:17:43.692613 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:17:43.694732 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:17:43.701770 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:17:43.723703 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:17:43.760893 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:17:43.762690 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:17:43.781811 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:17:43.788825 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:17:43.794677 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:17:43.802648 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:17:43.805822 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:17:43.806851 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:17:43.808845 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:17:43.813848 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:17:43.815977 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:17:43.818796 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:17:43.824936 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:17:43.826828 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:17:43.829772 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:17:43.831762 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:17:43.832857 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:17:43.833791 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:17:43.835666 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:17:43.836683 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:17:43.839679 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:17:43.841638 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:17:43.842797 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:17:43.844539 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:17:43.845534 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:17:43.848760 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:17:43.850793 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:17:43.852355 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:17:43.854389 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:17:43.857328 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:17:43.858326 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:17:43.885567 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:17:43.887594 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:17:43.888589 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:17:43.892045 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:17:43.892763 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:17:43.893577 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:17:43.895605 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:17:43.896359 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:17:43.900174 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:17:43.902344 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:17:43.906162 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:17:43.908187 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:17:43.909206 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:17:43.911224 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:17:43.912176 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:17:43.915324 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:17:43.917758 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:17:43.919784 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:17:43.927574 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:17:43.931595 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:17:43.932593 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:17:43.934628 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:17:43.941174 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:17:43.950154 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2bd1e2a7-ca2f-4b5a-abf4-7661ead71b23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE3EEC608>]}
2021-02-18 02:17:43.951152 (MainThread): Partial parsing not enabled
2021-02-18 02:17:43.998418 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:17:44.016690 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:44.025679 (MainThread): * Deprecation Warning: The "adapter_macro" macro has been deprecated. Instead,
use the `adapter.dispatch` method to find a macro and call the result.
adapter_macro was called for: dbt_utils.type_string
2021-02-18 02:17:44.076227 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2bd1e2a7-ca2f-4b5a-abf4-7661ead71b23', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE3F20448>]}
2021-02-18 02:17:44.334916 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:17:44.336911 (MainThread): 
2021-02-18 02:17:44.336911 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:17:44.338921 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:17:44.355651 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:17:44.356629 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:17:44.356629 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:17:45.449658 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.09 seconds
2021-02-18 02:17:45.460567 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:17:45.681249 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:17:45.690817 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:17:45.690817 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:17:45.691808 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:17:46.922596 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.23 seconds
2021-02-18 02:17:46.935050 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:17:47.238713 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:47.238713 (MainThread): On master: BEGIN
2021-02-18 02:17:47.238713 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:17:48.480016 (MainThread): SQL status: SUCCESS 1 in 1.24 seconds
2021-02-18 02:17:48.480124 (MainThread): On master: COMMIT
2021-02-18 02:17:48.481014 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:48.481137 (MainThread): On master: COMMIT
2021-02-18 02:17:48.856236 (MainThread): SQL status: SUCCESS 1 in 0.38 seconds
2021-02-18 02:17:48.857230 (MainThread): On master: Close
2021-02-18 02:17:49.175252 (MainThread): 20:17:49 | Concurrency: 16 threads (target='dev')
2021-02-18 02:17:49.176358 (MainThread): 20:17:49 | 
2021-02-18 02:17:49.188363 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:17:49.190356 (Thread-1): 20:17:49 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:17:49.191569 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:49.191569 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:17:49.227846 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:17:49.228842 (Thread-1): finished collecting timing info
2021-02-18 02:17:49.284132 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:49.284259 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , 

    
        
    

    md5(cast(
  
    
    coalesce(cast(L_ORDERKEY as 
  
    varchar

), '') || '-' || coalesce(cast(L_LINENUMBER as 
  
    varchar

), '')


 as 
  
    varchar

)) AS ORDER_LINE_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:17:49.284259 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:17:52.564240 (Thread-1): SQL status: SUCCESS 1 in 3.28 seconds
2021-02-18 02:17:52.586505 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:52.586505 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
2021-02-18 02:17:52.854646 (Thread-1): SQL status: SUCCESS 14 in 0.27 seconds
2021-02-18 02:17:52.866686 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:52.866686 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:17:53.265132 (Thread-1): SQL status: SUCCESS 13 in 0.40 seconds
2021-02-18 02:17:53.274008 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:53.274993 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:17:53.468871 (Thread-1): SQL status: SUCCESS 13 in 0.19 seconds
2021-02-18 02:17:53.505692 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:17:53.508720 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:53.508720 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:17:53.701529 (Thread-1): SQL status: SUCCESS 1 in 0.19 seconds
2021-02-18 02:17:53.702852 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:17:53.702852 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

        
        
    

    

    merge into DBT_POC.dbt_jkolpak.FactLineItem as DBT_INTERNAL_DEST
        using DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.ORDER_LINE_KEY = DBT_INTERNAL_DEST.ORDER_LINE_KEY
        

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","LINE_NUMBER" = DBT_INTERNAL_SOURCE."LINE_NUMBER","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","EXTENDED_PRICE" = DBT_INTERNAL_SOURCE."EXTENDED_PRICE","LINE_DISCOUNT" = DBT_INTERNAL_SOURCE."LINE_DISCOUNT","LINE_TAX" = DBT_INTERNAL_SOURCE."LINE_TAX","LINE_RETURN_FLAG" = DBT_INTERNAL_SOURCE."LINE_RETURN_FLAG","LINE_SHIP_DATE" = DBT_INTERNAL_SOURCE."LINE_SHIP_DATE","LINE_RECEIPT_DATE" = DBT_INTERNAL_SOURCE."LINE_RECEIPT_DATE","LINE_COMMITDATE" = DBT_INTERNAL_SOURCE."LINE_COMMITDATE","SHIP_RECEIPT_LAG" = DBT_INTERNAL_SOURCE."SHIP_RECEIPT_LAG","LINE_PART_KEY" = DBT_INTERNAL_SOURCE."LINE_PART_KEY","LINE_SUPPLIER_KEY" = DBT_INTERNAL_SOURCE."LINE_SUPPLIER_KEY"
    

    when not matched then insert
        ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
    values
        ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
2021-02-18 02:17:54.082984 (Thread-1): Snowflake query id: 019a5d09-0548-7d69-0000-401500302166
2021-02-18 02:17:54.083981 (Thread-1): Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 49
invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
2021-02-18 02:17:54.083981 (Thread-1): finished collecting timing info
2021-02-18 02:17:54.084589 (Thread-1): On model.dbtpoc.FactLineItem: ROLLBACK
2021-02-18 02:17:54.410665 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:17:54.666636 (Thread-1): Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 4 at position 49
  invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 000904 (42000): SQL compilation error: error line 4 at position 49
invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  000904 (42000): SQL compilation error: error line 4 at position 49
  invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:17:54.674886 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2bd1e2a7-ca2f-4b5a-abf4-7661ead71b23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE43829C8>]}
2021-02-18 02:17:54.677962 (Thread-1): 20:17:54 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 5.48s]
2021-02-18 02:17:54.680899 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:17:54.728177 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:17:54.729213 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:54.729213 (MainThread): On master: BEGIN
2021-02-18 02:17:54.729213 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:17:55.555751 (MainThread): SQL status: SUCCESS 1 in 0.83 seconds
2021-02-18 02:17:55.555751 (MainThread): On master: COMMIT
2021-02-18 02:17:55.555751 (MainThread): Using snowflake connection "master".
2021-02-18 02:17:55.556649 (MainThread): On master: COMMIT
2021-02-18 02:17:56.136714 (MainThread): SQL status: SUCCESS 1 in 0.58 seconds
2021-02-18 02:17:56.136714 (MainThread): On master: Close
2021-02-18 02:17:56.388531 (MainThread): 20:17:56 | 
2021-02-18 02:17:56.389528 (MainThread): 20:17:56 | Finished running 1 incremental model in 12.05s.
2021-02-18 02:17:56.389528 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:17:56.389528 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:17:56.389528 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:17:56.389528 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:17:56.395925 (MainThread): 
2021-02-18 02:17:56.397732 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:17:56.399699 (MainThread): 
2021-02-18 02:17:56.399699 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:17:56.402582 (MainThread):   000904 (42000): SQL compilation error: error line 4 at position 49
2021-02-18 02:17:56.412404 (MainThread):   invalid identifier 'DBT_INTERNAL_DEST.ORDER_LINE_KEY'
2021-02-18 02:17:56.413259 (MainThread):   compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:17:56.414200 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:17:56.416266 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE4612888>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE432B948>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FEE46702C8>]}
2021-02-18 02:17:56.416266 (MainThread): Flushing usage events
2021-02-18 02:20:12.995465 (MainThread): Running with dbt=0.18.0
2021-02-18 02:20:13.850058 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:20:13.850604 (MainThread): Tracking: tracking
2021-02-18 02:20:13.851053 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363C850D88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363C850D08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363C846788>]}
2021-02-18 02:20:13.889412 (MainThread): Partial parsing not enabled
2021-02-18 02:20:13.890465 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:20:13.891401 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:20:13.893943 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:20:13.928617 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:20:13.930626 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:20:13.942729 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:20:13.945798 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:20:13.949717 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:20:13.953854 (MainThread): Parsing macros\core.sql
2021-02-18 02:20:13.957865 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:20:14.003518 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:20:14.013570 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:20:14.014380 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:20:14.016373 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:20:14.018356 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:20:14.020345 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:20:14.021924 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:20:14.031451 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:20:14.045549 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:20:14.048502 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:20:14.058060 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:20:14.085233 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:20:14.124031 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:20:14.126020 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:20:14.148708 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:20:14.157577 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:20:14.166174 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:20:14.174769 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:20:14.178726 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:20:14.181016 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:20:14.183539 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:20:14.189486 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:20:14.192657 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:20:14.196623 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:20:14.203624 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:20:14.207656 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:20:14.210964 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:20:14.213539 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:20:14.215829 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:20:14.217620 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:20:14.219611 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:20:14.221352 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:20:14.225858 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:20:14.227726 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:20:14.228702 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:20:14.231274 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:20:14.233491 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:20:14.236661 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:20:14.239504 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:20:14.242590 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:20:14.244634 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:20:14.249610 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:20:14.251848 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:20:14.279026 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:20:14.279616 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:20:14.281647 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:20:14.284676 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:20:14.285707 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:20:14.286700 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:20:14.288695 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:20:14.289826 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:20:14.292838 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:20:14.295877 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:20:14.298870 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:20:14.301586 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:20:14.302798 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:20:14.303770 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:20:14.304785 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:20:14.307749 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:20:14.310854 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:20:14.312821 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:20:14.320778 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:20:14.325259 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:20:14.327281 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:20:14.328275 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:20:14.335853 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:20:14.350960 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99fcf643-e0c0-4513-a77e-0025710a80b0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363C9100C8>]}
2021-02-18 02:20:14.352477 (MainThread): Partial parsing not enabled
2021-02-18 02:20:14.403170 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:20:14.421602 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:14.425603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363CAE2C48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363CAE2C08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002363CAE2648>]}
2021-02-18 02:20:14.426639 (MainThread): Flushing usage events
2021-02-18 02:20:14.840367 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:20:14.840367 (MainThread): Encountered an error:
2021-02-18 02:20:14.841483 (MainThread): Compilation Error in model FactLineItem (models\FactLineItem.sql)
  unexpected ','
    line 3
      --, unique_key='ORDER_LINE_KEY'
2021-02-18 02:20:14.866867 (MainThread): Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 496, in catch_jinja
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: unexpected ','
  line 3
    --, unique_key='ORDER_LINE_KEY'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\perf_utils.py", line 31, in get_full_manifest
    adapter.connections.set_query_header,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 348, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 204, in load
    self.parse_project(project, macro_manifest, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 177, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\manifest.py", line 133, in parse_with_cache
    parser.parse_file(block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 429, in parse_file
    self.parse_node(file_block)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 402, in parse_node
    self.render_update(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 377, in render_update
    self.render_with_context(node, config)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\parser\base.py", line 289, in render_with_context
    parsed_node.raw_sql, context, parsed_node, capture_macros=True
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 575, in get_rendered
    native=native,
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model FactLineItem (models\FactLineItem.sql)
  unexpected ','
    line 3
      --, unique_key='ORDER_LINE_KEY'

2021-02-18 02:20:29.197558 (MainThread): Running with dbt=0.18.0
2021-02-18 02:20:29.858613 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:20:29.859527 (MainThread): Tracking: tracking
2021-02-18 02:20:29.860403 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB23F4F08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6541848>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB65442C8>]}
2021-02-18 02:20:29.896317 (MainThread): Partial parsing not enabled
2021-02-18 02:20:29.897312 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:20:29.898651 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:20:29.902234 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:20:29.938568 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:20:29.941277 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:20:29.952423 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:20:29.955407 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:20:29.959683 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:20:29.963690 (MainThread): Parsing macros\core.sql
2021-02-18 02:20:29.967879 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:20:30.017526 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:20:30.027149 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:20:30.028157 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:20:30.030170 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:20:30.032186 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:20:30.034209 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:20:30.035204 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:20:30.044795 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:20:30.060945 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:20:30.062939 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:20:30.072156 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:20:30.097140 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:20:30.128946 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:20:30.130968 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:20:30.150025 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:20:30.158233 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:20:30.163474 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:20:30.170683 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:20:30.174063 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:20:30.175578 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:20:30.177740 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:20:30.182660 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:20:30.185542 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:20:30.188712 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:20:30.193655 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:20:30.196669 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:20:30.199654 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:20:30.201644 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:20:30.202637 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:20:30.203632 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:20:30.205722 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:20:30.206858 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:20:30.209770 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:20:30.210810 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:20:30.212713 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:20:30.214732 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:20:30.215706 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:20:30.218488 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:20:30.220549 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:20:30.222474 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:20:30.224462 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:20:30.227792 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:20:30.228588 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:20:30.254832 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:20:30.256877 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:20:30.258915 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:20:30.261184 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:20:30.263174 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:20:30.264371 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:20:30.264919 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:20:30.266606 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:20:30.271193 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:20:30.273707 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:20:30.277294 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:20:30.280232 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:20:30.281425 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:20:30.282437 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:20:30.283433 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:20:30.286962 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:20:30.289518 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:20:30.291658 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:20:30.299566 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:20:30.303479 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:20:30.305455 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:20:30.307030 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:20:30.314771 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:20:30.322518 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6a45212-210e-49f6-bf8b-372c431750e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB65ADC88>]}
2021-02-18 02:20:30.323515 (MainThread): Partial parsing not enabled
2021-02-18 02:20:30.371433 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:20:30.390556 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:30.400356 (MainThread): * Deprecation Warning: The "adapter_macro" macro has been deprecated. Instead,
use the `adapter.dispatch` method to find a macro and call the result.
adapter_macro was called for: dbt_utils.type_string
2021-02-18 02:20:30.401352 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c6a45212-210e-49f6-bf8b-372c431750e3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB67D3F08>]}
2021-02-18 02:20:30.785807 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:20:30.788195 (MainThread): 
2021-02-18 02:20:30.789131 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:20:30.792835 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:20:30.815326 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:20:30.815326 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:20:30.816319 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:20:32.026546 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.21 seconds
2021-02-18 02:20:32.031613 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:20:32.296214 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:20:32.327148 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:20:32.328146 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:20:32.328146 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:20:33.628658 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.30 seconds
2021-02-18 02:20:33.640576 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:20:33.878047 (MainThread): Using snowflake connection "master".
2021-02-18 02:20:33.878047 (MainThread): On master: BEGIN
2021-02-18 02:20:33.878047 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:20:34.851556 (MainThread): SQL status: SUCCESS 1 in 0.97 seconds
2021-02-18 02:20:34.851556 (MainThread): On master: COMMIT
2021-02-18 02:20:34.852550 (MainThread): Using snowflake connection "master".
2021-02-18 02:20:34.852664 (MainThread): On master: COMMIT
2021-02-18 02:20:35.260055 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-02-18 02:20:35.260055 (MainThread): On master: Close
2021-02-18 02:20:35.537068 (MainThread): 20:20:35 | Concurrency: 16 threads (target='dev')
2021-02-18 02:20:35.538062 (MainThread): 20:20:35 | 
2021-02-18 02:20:35.548732 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:20:35.551148 (Thread-1): 20:20:35 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:20:35.552143 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:35.553147 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:20:35.587953 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:20:35.589172 (Thread-1): finished collecting timing info
2021-02-18 02:20:35.637761 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:35.637761 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , 

    
        
    

    md5(cast(
  
    
    coalesce(cast(L_ORDERKEY as 
  
    varchar

), '') || '-' || coalesce(cast(L_LINENUMBER as 
  
    varchar

), '')


 as 
  
    varchar

)) AS ORDER_LINE_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:20:35.638757 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:20:37.356801 (Thread-1): SQL status: SUCCESS 1 in 1.72 seconds
2021-02-18 02:20:37.377221 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:37.377777 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
2021-02-18 02:20:37.649537 (Thread-1): SQL status: SUCCESS 14 in 0.27 seconds
2021-02-18 02:20:37.659169 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:37.659944 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:20:37.918003 (Thread-1): SQL status: SUCCESS 13 in 0.26 seconds
2021-02-18 02:20:37.929150 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:37.930146 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:20:38.221720 (Thread-1): SQL status: SUCCESS 13 in 0.29 seconds
2021-02-18 02:20:38.254116 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:20:38.255724 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:38.256709 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:20:38.630275 (Thread-1): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:20:38.630275 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:38.630275 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */


        insert into DBT_POC.dbt_jkolpak.FactLineItem ("ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
        (
            select "ORDER_KEY", "LINE_NUMBER", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY"
            from DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
        );
2021-02-18 02:20:39.005748 (Thread-1): SQL status: SUCCESS 0 in 0.37 seconds
2021-02-18 02:20:39.007681 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:20:39.007681 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:20:39.007681 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:20:39.438956 (Thread-1): SQL status: SUCCESS 1 in 0.43 seconds
2021-02-18 02:20:39.510681 (Thread-1): finished collecting timing info
2021-02-18 02:20:39.510681 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:20:39.959066 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6a45212-210e-49f6-bf8b-372c431750e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6C33988>]}
2021-02-18 02:20:39.961294 (Thread-1): 20:20:39 | 1 of 1 OK created incremental model dbt_jkolpak.FactLineItem......... [SUCCESS 0 in 4.41s]
2021-02-18 02:20:39.963522 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:20:39.980558 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:20:39.981553 (MainThread): Using snowflake connection "master".
2021-02-18 02:20:39.981553 (MainThread): On master: BEGIN
2021-02-18 02:20:39.981553 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:20:40.876225 (MainThread): SQL status: SUCCESS 1 in 0.89 seconds
2021-02-18 02:20:40.877221 (MainThread): On master: COMMIT
2021-02-18 02:20:40.877221 (MainThread): Using snowflake connection "master".
2021-02-18 02:20:40.877221 (MainThread): On master: COMMIT
2021-02-18 02:20:41.519239 (MainThread): SQL status: SUCCESS 1 in 0.64 seconds
2021-02-18 02:20:41.519239 (MainThread): On master: Close
2021-02-18 02:20:41.899187 (MainThread): 20:20:41 | 
2021-02-18 02:20:41.900212 (MainThread): 20:20:41 | Finished running 1 incremental model in 11.11s.
2021-02-18 02:20:41.901211 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:20:41.901211 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:20:41.902500 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:20:41.902500 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:20:41.916599 (MainThread): 
2021-02-18 02:20:41.918159 (MainThread): Completed successfully
2021-02-18 02:20:41.919482 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-18 02:20:41.922465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6C32708>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6BED188>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCB6A1E808>]}
2021-02-18 02:20:41.923131 (MainThread): Flushing usage events
2021-02-18 02:21:05.011141 (MainThread): Running with dbt=0.18.0
2021-02-18 02:21:05.765060 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:21:05.780247 (MainThread): Tracking: tracking
2021-02-18 02:21:05.780963 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF5B84C88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7D23088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7D30788>]}
2021-02-18 02:21:05.821207 (MainThread): Partial parsing not enabled
2021-02-18 02:21:05.822312 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:21:05.823231 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:21:05.826215 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:21:05.869981 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:21:05.872020 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:21:05.884322 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:21:05.886989 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:21:05.892066 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:21:05.896045 (MainThread): Parsing macros\core.sql
2021-02-18 02:21:05.901098 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:21:05.956982 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:21:05.968297 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:21:05.970418 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:21:05.972401 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:21:05.975441 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:21:05.978861 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:21:05.980507 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:21:05.996100 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:21:06.032098 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:21:06.034272 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:21:06.049737 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:21:06.073067 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:21:06.104832 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:21:06.106822 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:21:06.126770 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:21:06.133778 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:21:06.139671 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:21:06.146821 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:21:06.150193 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:21:06.152004 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:21:06.154814 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:21:06.159965 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:21:06.163065 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:21:06.166018 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:21:06.172143 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:21:06.174159 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:21:06.177143 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:21:06.179132 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:21:06.180219 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:21:06.182088 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:21:06.183285 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:21:06.184345 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:21:06.187365 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:21:06.189358 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:21:06.190403 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:21:06.192385 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:21:06.193379 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:21:06.195958 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:21:06.197943 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:21:06.200050 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:21:06.202038 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:21:06.205541 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:21:06.206537 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:21:06.232568 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:21:06.233648 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:21:06.235687 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:21:06.238671 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:21:06.240314 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:21:06.241751 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:21:06.242744 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:21:06.244734 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:21:06.247718 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:21:06.250265 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:21:06.252825 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:21:06.255809 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:21:06.256904 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:21:06.258834 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:21:06.259937 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:21:06.262954 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:21:06.265196 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:21:06.267027 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:21:06.275495 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:21:06.279069 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:21:06.280954 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:21:06.281944 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:21:06.290100 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:21:06.297712 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1f55274-81fb-4309-8c22-67fd380c0862', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7DFAC88>]}
2021-02-18 02:21:06.298678 (MainThread): Partial parsing not enabled
2021-02-18 02:21:06.348272 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:21:06.368062 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:21:06.380517 (MainThread): * Deprecation Warning: The "adapter_macro" macro has been deprecated. Instead,
use the `adapter.dispatch` method to find a macro and call the result.
adapter_macro was called for: dbt_utils.type_string
2021-02-18 02:21:06.382385 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1f55274-81fb-4309-8c22-67fd380c0862', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7DFF3C8>]}
2021-02-18 02:21:06.648040 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:21:06.648793 (MainThread): 
2021-02-18 02:21:06.649777 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:21:06.650871 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:21:06.671159 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:21:06.671159 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:21:06.671159 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:21:07.820353 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.15 seconds
2021-02-18 02:21:07.825581 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:21:08.098793 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:21:08.107834 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:21:08.108898 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:21:08.108898 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:21:09.013879 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.90 seconds
2021-02-18 02:21:09.026308 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:21:09.291057 (MainThread): Using snowflake connection "master".
2021-02-18 02:21:09.291057 (MainThread): On master: BEGIN
2021-02-18 02:21:09.291057 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:21:10.491518 (MainThread): SQL status: SUCCESS 1 in 1.20 seconds
2021-02-18 02:21:10.491518 (MainThread): On master: COMMIT
2021-02-18 02:21:10.492707 (MainThread): Using snowflake connection "master".
2021-02-18 02:21:10.492707 (MainThread): On master: COMMIT
2021-02-18 02:21:11.003360 (MainThread): SQL status: SUCCESS 1 in 0.51 seconds
2021-02-18 02:21:11.004355 (MainThread): On master: Close
2021-02-18 02:21:11.899625 (MainThread): 20:21:11 | Concurrency: 16 threads (target='dev')
2021-02-18 02:21:11.911600 (MainThread): 20:21:11 | 
2021-02-18 02:21:11.928569 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:21:11.933460 (Thread-1): 20:21:11 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:21:11.967564 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:21:11.968534 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:21:12.037294 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:21:12.039826 (Thread-1): finished collecting timing info
2021-02-18 02:21:12.197843 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:21:12.204842 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:21:12.204842 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:21:12.205797 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:21:13.384305 (Thread-1): SQL status: SUCCESS 1 in 1.18 seconds
2021-02-18 02:21:13.385299 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:21:13.385299 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */


      create or replace transient table DBT_POC.dbt_jkolpak.FactLineItem  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , 

    
        
    

    md5(cast(
  
    
    coalesce(cast(L_ORDERKEY as 
  
    varchar

), '') || '-' || coalesce(cast(L_LINENUMBER as 
  
    varchar

), '')


 as 
  
    varchar

)) AS ORDER_LINE_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY


      );
2021-02-18 02:21:14.930397 (Thread-1): Snowflake query id: 019a5d0d-055b-6c42-0000-40150030505a
2021-02-18 02:21:14.930397 (Thread-1): Snowflake error: 100038 (22018): Numeric value 'Supplier#000015001' is not recognized
2021-02-18 02:21:14.930397 (Thread-1): finished collecting timing info
2021-02-18 02:21:14.931393 (Thread-1): On model.dbtpoc.FactLineItem: ROLLBACK
2021-02-18 02:21:15.167738 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:21:15.408510 (Thread-1): Database Error in model FactLineItem (models\FactLineItem.sql)
  100038 (22018): Numeric value 'Supplier#000015001' is not recognized
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 100038 (22018): Numeric value 'Supplier#000015001' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  100038 (22018): Numeric value 'Supplier#000015001' is not recognized
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:21:15.417459 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1f55274-81fb-4309-8c22-67fd380c0862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF840C208>]}
2021-02-18 02:21:15.419448 (Thread-1): 20:21:15 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 3.45s]
2021-02-18 02:21:15.421438 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:21:15.473672 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:21:15.473672 (MainThread): Using snowflake connection "master".
2021-02-18 02:21:15.473672 (MainThread): On master: BEGIN
2021-02-18 02:21:15.473672 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:21:16.419992 (MainThread): SQL status: SUCCESS 1 in 0.95 seconds
2021-02-18 02:21:16.419992 (MainThread): On master: COMMIT
2021-02-18 02:21:16.420988 (MainThread): Using snowflake connection "master".
2021-02-18 02:21:16.420988 (MainThread): On master: COMMIT
2021-02-18 02:21:16.713526 (MainThread): SQL status: SUCCESS 1 in 0.29 seconds
2021-02-18 02:21:16.714880 (MainThread): On master: Close
2021-02-18 02:21:17.010552 (MainThread): 20:21:17 | 
2021-02-18 02:21:17.011539 (MainThread): 20:21:17 | Finished running 1 incremental model in 10.36s.
2021-02-18 02:21:17.011539 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:21:17.011539 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:21:17.011539 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:21:17.011539 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:21:17.016961 (MainThread): 
2021-02-18 02:21:17.017508 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:21:17.017508 (MainThread): 
2021-02-18 02:21:17.019496 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:21:17.020490 (MainThread):   100038 (22018): Numeric value 'Supplier#000015001' is not recognized
2021-02-18 02:21:17.020490 (MainThread):   compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:21:17.021484 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:21:17.022489 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF81F1E08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF7FCA208>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AFF8568508>]}
2021-02-18 02:21:17.023480 (MainThread): Flushing usage events
2021-02-18 02:23:03.232025 (MainThread): Running with dbt=0.18.0
2021-02-18 02:23:03.996627 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:23:03.996627 (MainThread): Tracking: tracking
2021-02-18 02:23:03.997624 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257C3308>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257C0E88>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7257B6948>]}
2021-02-18 02:23:04.030343 (MainThread): Partial parsing not enabled
2021-02-18 02:23:04.030746 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:23:04.031800 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:23:04.033958 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:23:04.065276 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:23:04.067141 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:23:04.078077 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:23:04.080074 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:23:04.084207 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:23:04.089211 (MainThread): Parsing macros\core.sql
2021-02-18 02:23:04.093827 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:23:04.140971 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:23:04.149771 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:23:04.150950 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:23:04.153004 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:23:04.155120 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:23:04.157144 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:23:04.157652 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:23:04.167262 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:23:04.183912 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:23:04.185925 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:23:04.193726 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:23:04.219845 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:23:04.253918 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:23:04.255912 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:23:04.273654 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:23:04.280867 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:23:04.286501 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:23:04.292974 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:23:04.296074 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:23:04.297606 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:23:04.299582 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:23:04.304816 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:23:04.306811 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:23:04.310336 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:23:04.316118 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:23:04.318679 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:23:04.322080 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:23:04.322945 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:23:04.324972 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:23:04.325969 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:23:04.327963 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:23:04.328960 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:23:04.332036 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:23:04.333249 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:23:04.334256 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:23:04.336252 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:23:04.337259 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:23:04.340263 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:23:04.342508 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:23:04.344342 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:23:04.345316 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:23:04.349308 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:23:04.350305 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:23:04.374977 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:23:04.376274 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:23:04.377968 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:23:04.380990 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:23:04.382072 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:23:04.383064 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:23:04.384092 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:23:04.386249 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:23:04.389104 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:23:04.392160 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:23:04.394139 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:23:04.397193 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:23:04.398099 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:23:04.400092 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:23:04.401089 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:23:04.404074 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:23:04.407511 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:23:04.409204 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:23:04.417237 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:23:04.421132 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:23:04.423093 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:23:04.424099 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:23:04.431140 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:23:04.435098 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9d4a46ef-c862-45f5-a7c3-8193407b35e6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72587F1C8>]}
2021-02-18 02:23:04.436095 (MainThread): Partial parsing not enabled
2021-02-18 02:23:04.488083 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:23:04.508402 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:04.775426 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:23:04.776956 (MainThread): 
2021-02-18 02:23:04.776956 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:23:04.779128 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:23:04.796410 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:23:04.796410 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:23:04.796410 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:23:06.002074 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.21 seconds
2021-02-18 02:23:06.008056 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:23:06.256158 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:23:06.271618 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:23:06.271618 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:23:06.272198 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:23:07.759268 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.49 seconds
2021-02-18 02:23:07.766178 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:23:08.038188 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:08.038188 (MainThread): On master: BEGIN
2021-02-18 02:23:08.039130 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:23:09.071117 (MainThread): SQL status: SUCCESS 1 in 1.03 seconds
2021-02-18 02:23:09.072118 (MainThread): On master: COMMIT
2021-02-18 02:23:09.072448 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:09.072448 (MainThread): On master: COMMIT
2021-02-18 02:23:09.679242 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-02-18 02:23:09.680240 (MainThread): On master: Close
2021-02-18 02:23:10.213044 (MainThread): 20:23:10 | Concurrency: 16 threads (target='dev')
2021-02-18 02:23:10.214456 (MainThread): 20:23:10 | 
2021-02-18 02:23:10.228970 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:23:10.233533 (Thread-1): 20:23:10 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:23:10.234818 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:10.235453 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:23:10.264804 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:23:10.266191 (Thread-1): finished collecting timing info
2021-02-18 02:23:10.311430 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:23:10.312995 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:10.313993 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:23:10.313993 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:23:11.425674 (Thread-1): SQL status: SUCCESS 1 in 1.11 seconds
2021-02-18 02:23:11.425674 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:11.425674 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */


      create or replace transient table DBT_POC.dbt_jkolpak.FactLineItem  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , CONCAT(L_ORDERKEY, L_LINENUMBER) AS LINE_ORDER_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY


      );
2021-02-18 02:23:13.837966 (Thread-1): Snowflake query id: 019a5d0f-0540-dc07-0000-401500303266
2021-02-18 02:23:13.837966 (Thread-1): Snowflake error: 100038 (22018): Numeric value 'Supplier#000015001' is not recognized
2021-02-18 02:23:13.837966 (Thread-1): finished collecting timing info
2021-02-18 02:23:13.839166 (Thread-1): On model.dbtpoc.FactLineItem: ROLLBACK
2021-02-18 02:23:14.015701 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:23:14.491260 (Thread-1): Database Error in model FactLineItem (models\FactLineItem.sql)
  100038 (22018): Numeric value 'Supplier#000015001' is not recognized
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 161, in exception_handler
    yield
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 78, in add_query
    cursor.execute(sql, bindings)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\cursor.py", line 596, in execute
    errvalue)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 123, in errorhandler_wrapper
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\snowflake\connector\errors.py", line 88, in default_errorhandler
    done_format_msg=error_value.get('done_format_msg'))
snowflake.connector.errors.ProgrammingError: 100038 (22018): Numeric value 'Supplier#000015001' is not recognized

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 120, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\base\impl.py", line 227, in execute
    fetch=fetch
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 123, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 312, in add_query
    abridge_sql_log=abridge_sql_log
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\sql\connections.py", line 86, in add_query
    return connection, cursor
  File "C:\Users\jkolpak\AppData\Local\Continuum\anaconda3\lib\contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\jkolpak\dbt-venv\lib\site-packages\dbt\adapters\snowflake\connections.py", line 178, in exception_handler
    raise DatabaseException(msg)
dbt.exceptions.DatabaseException: Database Error in model FactLineItem (models\FactLineItem.sql)
  100038 (22018): Numeric value 'Supplier#000015001' is not recognized
  compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:23:14.500234 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d4a46ef-c862-45f5-a7c3-8193407b35e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A725F7EA48>]}
2021-02-18 02:23:14.501986 (Thread-1): 20:23:14 | 1 of 1 ERROR creating incremental model dbt_jkolpak.FactLineItem..... [ERROR in 4.27s]
2021-02-18 02:23:14.504122 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:23:14.566232 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:23:14.566232 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:14.566232 (MainThread): On master: BEGIN
2021-02-18 02:23:14.566232 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:23:15.675974 (MainThread): SQL status: SUCCESS 1 in 1.11 seconds
2021-02-18 02:23:15.675974 (MainThread): On master: COMMIT
2021-02-18 02:23:15.676971 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:15.676971 (MainThread): On master: COMMIT
2021-02-18 02:23:16.047770 (MainThread): SQL status: SUCCESS 1 in 0.37 seconds
2021-02-18 02:23:16.047770 (MainThread): On master: Close
2021-02-18 02:23:16.316685 (MainThread): 20:23:16 | 
2021-02-18 02:23:16.318644 (MainThread): 20:23:16 | Finished running 1 incremental model in 11.54s.
2021-02-18 02:23:16.319671 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:23:16.319671 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:23:16.319671 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:23:16.320638 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:23:16.332165 (MainThread): 
2021-02-18 02:23:16.333105 (MainThread): Completed with 1 error and 0 warnings:
2021-02-18 02:23:16.336100 (MainThread): 
2021-02-18 02:23:16.337367 (MainThread): Database Error in model FactLineItem (models\FactLineItem.sql)
2021-02-18 02:23:16.338284 (MainThread):   100038 (22018): Numeric value 'Supplier#000015001' is not recognized
2021-02-18 02:23:16.350325 (MainThread):   compiled SQL at target\run\dbtpoc\models\FactLineItem.sql
2021-02-18 02:23:16.352381 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-02-18 02:23:16.353465 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A725F7C248>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A725E54A08>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A72607EB48>]}
2021-02-18 02:23:16.354493 (MainThread): Flushing usage events
2021-02-18 02:23:33.564973 (MainThread): Running with dbt=0.18.0
2021-02-18 02:23:34.233437 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:23:34.234513 (MainThread): Tracking: tracking
2021-02-18 02:23:34.234513 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0613FFC8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A1D4488>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A1D42C8>]}
2021-02-18 02:23:34.266288 (MainThread): Partial parsing not enabled
2021-02-18 02:23:34.267236 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:23:34.268233 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:23:34.270197 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:23:34.300171 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:23:34.302355 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:23:34.312166 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:23:34.315043 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:23:34.319045 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:23:34.322946 (MainThread): Parsing macros\core.sql
2021-02-18 02:23:34.326968 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:23:34.372221 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:23:34.381269 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:23:34.382292 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:23:34.384288 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:23:34.386283 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:23:34.387858 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:23:34.388886 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:23:34.398723 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:23:34.414039 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:23:34.415038 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:23:34.422203 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:23:34.444357 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:23:34.476134 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:23:34.478127 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:23:34.495237 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:23:34.504252 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:23:34.509526 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:23:34.517146 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:23:34.519928 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:23:34.521837 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:23:34.523867 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:23:34.527844 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:23:34.531213 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:23:34.534243 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:23:34.539225 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:23:34.542217 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:23:34.545139 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:23:34.546134 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:23:34.548303 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:23:34.550092 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:23:34.551089 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:23:34.552669 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:23:34.555654 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:23:34.556737 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:23:34.557649 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:23:34.560211 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:23:34.561267 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:23:34.564230 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:23:34.566225 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:23:34.568344 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:23:34.569220 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:23:34.573267 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:23:34.574132 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:23:34.602005 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:23:34.602200 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:23:34.605016 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:23:34.607839 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:23:34.608798 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:23:34.610991 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:23:34.612092 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:23:34.612998 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:23:34.616454 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:23:34.619092 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:23:34.622090 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:23:34.624161 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:23:34.625186 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:23:34.627251 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:23:34.628249 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:23:34.631942 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:23:34.634535 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:23:34.637244 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:23:34.645520 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:23:34.650506 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:23:34.653006 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:23:34.654036 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:23:34.661021 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:23:34.668567 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3dc5f0a2-62d5-4059-9971-55e3865139da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A267CC8>]}
2021-02-18 02:23:34.670520 (MainThread): Partial parsing not enabled
2021-02-18 02:23:34.719115 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:23:34.736272 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:35.059354 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:23:35.060196 (MainThread): 
2021-02-18 02:23:35.061194 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:23:35.062231 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:23:35.078696 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:23:35.078696 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:23:35.078696 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:23:36.280123 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.20 seconds
2021-02-18 02:23:36.285853 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:23:36.538804 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:23:36.546322 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:23:36.546322 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:23:36.546322 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:23:37.491910 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 0.95 seconds
2021-02-18 02:23:37.504592 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:23:37.753167 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:37.753167 (MainThread): On master: BEGIN
2021-02-18 02:23:37.753167 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:23:38.599741 (MainThread): SQL status: SUCCESS 1 in 0.85 seconds
2021-02-18 02:23:38.599741 (MainThread): On master: COMMIT
2021-02-18 02:23:38.599741 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:38.599741 (MainThread): On master: COMMIT
2021-02-18 02:23:39.074914 (MainThread): SQL status: SUCCESS 1 in 0.48 seconds
2021-02-18 02:23:39.076210 (MainThread): On master: Close
2021-02-18 02:23:39.321870 (MainThread): 20:23:39 | Concurrency: 16 threads (target='dev')
2021-02-18 02:23:39.322866 (MainThread): 20:23:39 | 
2021-02-18 02:23:39.330828 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:23:39.333869 (Thread-1): 20:23:39 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:23:39.336050 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:39.336122 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:23:39.358928 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:23:39.360059 (Thread-1): finished collecting timing info
2021-02-18 02:23:39.410232 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:23:39.412104 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:39.412104 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:23:39.412104 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:23:40.325086 (Thread-1): SQL status: SUCCESS 1 in 0.91 seconds
2021-02-18 02:23:40.325086 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:40.325086 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */


      create or replace transient table DBT_POC.dbt_jkolpak.FactLineItem  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , CONCAT(L_ORDERKEY, L_LINENUMBER) AS LINE_ORDER_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_KEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY


      );
2021-02-18 02:23:52.181622 (Thread-1): SQL status: SUCCESS 1 in 11.86 seconds
2021-02-18 02:23:52.183243 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:23:52.184232 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:23:52.184232 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:23:52.403646 (Thread-1): SQL status: SUCCESS 1 in 0.22 seconds
2021-02-18 02:23:52.425001 (Thread-1): finished collecting timing info
2021-02-18 02:23:52.425001 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:23:52.664417 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc5f0a2-62d5-4059-9971-55e3865139da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A80D788>]}
2021-02-18 02:23:52.667389 (Thread-1): 20:23:52 | 1 of 1 OK created incremental model dbt_jkolpak.FactLineItem......... [SUCCESS 1 in 13.33s]
2021-02-18 02:23:52.669382 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:23:52.727998 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:23:52.727998 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:52.728996 (MainThread): On master: BEGIN
2021-02-18 02:23:52.729072 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:23:53.847203 (MainThread): SQL status: SUCCESS 1 in 1.12 seconds
2021-02-18 02:23:53.848269 (MainThread): On master: COMMIT
2021-02-18 02:23:53.848269 (MainThread): Using snowflake connection "master".
2021-02-18 02:23:53.848269 (MainThread): On master: COMMIT
2021-02-18 02:23:54.188057 (MainThread): SQL status: SUCCESS 1 in 0.34 seconds
2021-02-18 02:23:54.188902 (MainThread): On master: Close
2021-02-18 02:23:54.438655 (MainThread): 20:23:54 | 
2021-02-18 02:23:54.439532 (MainThread): 20:23:54 | Finished running 1 incremental model in 19.38s.
2021-02-18 02:23:54.440045 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:23:54.441043 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:23:54.441043 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:23:54.441043 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:23:54.449394 (MainThread): 
2021-02-18 02:23:54.452414 (MainThread): Completed successfully
2021-02-18 02:23:54.453569 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-18 02:23:54.454562 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A2A34C8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A205508>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D0A67F288>]}
2021-02-18 02:23:54.455562 (MainThread): Flushing usage events
2021-02-18 02:24:39.631207 (MainThread): Running with dbt=0.18.0
2021-02-18 02:24:40.311348 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['FactLineItem'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\jkolpak\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-02-18 02:24:40.325001 (MainThread): Tracking: tracking
2021-02-18 02:24:40.325542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892B5E3088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892B5E3048>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892B5F13C8>]}
2021-02-18 02:24:40.360096 (MainThread): Partial parsing not enabled
2021-02-18 02:24:40.361144 (MainThread): Parsing macros\get_custom_schema.sql
2021-02-18 02:24:40.362193 (MainThread): Parsing macros\grant_select_on_schemas.sql
2021-02-18 02:24:40.364472 (MainThread): Parsing macros\adapters.sql
2021-02-18 02:24:40.396556 (MainThread): Parsing macros\catalog.sql
2021-02-18 02:24:40.398919 (MainThread): Parsing macros\materializations\incremental.sql
2021-02-18 02:24:40.409859 (MainThread): Parsing macros\materializations\merge.sql
2021-02-18 02:24:40.412418 (MainThread): Parsing macros\materializations\table.sql
2021-02-18 02:24:40.416594 (MainThread): Parsing macros\materializations\view.sql
2021-02-18 02:24:40.421414 (MainThread): Parsing macros\core.sql
2021-02-18 02:24:40.425582 (MainThread): Parsing macros\adapters\common.sql
2021-02-18 02:24:40.473015 (MainThread): Parsing macros\etc\datetime.sql
2021-02-18 02:24:40.481911 (MainThread): Parsing macros\etc\get_custom_alias.sql
2021-02-18 02:24:40.482572 (MainThread): Parsing macros\etc\get_custom_database.sql
2021-02-18 02:24:40.484329 (MainThread): Parsing macros\etc\get_custom_schema.sql
2021-02-18 02:24:40.487297 (MainThread): Parsing macros\etc\is_incremental.sql
2021-02-18 02:24:40.488233 (MainThread): Parsing macros\etc\query.sql
2021-02-18 02:24:40.490197 (MainThread): Parsing macros\materializations\helpers.sql
2021-02-18 02:24:40.499354 (MainThread): Parsing macros\materializations\common\merge.sql
2021-02-18 02:24:40.513847 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2021-02-18 02:24:40.515602 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2021-02-18 02:24:40.522786 (MainThread): Parsing macros\materializations\seed\seed.sql
2021-02-18 02:24:40.544227 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2021-02-18 02:24:40.575479 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2021-02-18 02:24:40.577657 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2021-02-18 02:24:40.596694 (MainThread): Parsing macros\materializations\table\table.sql
2021-02-18 02:24:40.603901 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2021-02-18 02:24:40.609088 (MainThread): Parsing macros\materializations\view\view.sql
2021-02-18 02:24:40.615994 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2021-02-18 02:24:40.618880 (MainThread): Parsing macros\schema_tests\not_null.sql
2021-02-18 02:24:40.620234 (MainThread): Parsing macros\schema_tests\relationships.sql
2021-02-18 02:24:40.623023 (MainThread): Parsing macros\schema_tests\unique.sql
2021-02-18 02:24:40.626917 (MainThread): Parsing macros\cross_db_utils\concat.sql
2021-02-18 02:24:40.629908 (MainThread): Parsing macros\cross_db_utils\current_timestamp.sql
2021-02-18 02:24:40.633009 (MainThread): Parsing macros\cross_db_utils\datatypes.sql
2021-02-18 02:24:40.638441 (MainThread): Parsing macros\cross_db_utils\dateadd.sql
2021-02-18 02:24:40.641824 (MainThread): Parsing macros\cross_db_utils\datediff.sql
2021-02-18 02:24:40.643854 (MainThread): Parsing macros\cross_db_utils\date_trunc.sql
2021-02-18 02:24:40.645843 (MainThread): Parsing macros\cross_db_utils\except.sql
2021-02-18 02:24:40.646857 (MainThread): Parsing macros\cross_db_utils\hash.sql
2021-02-18 02:24:40.648835 (MainThread): Parsing macros\cross_db_utils\identifer.sql
2021-02-18 02:24:40.649833 (MainThread): Parsing macros\cross_db_utils\intersect.sql
2021-02-18 02:24:40.651391 (MainThread): Parsing macros\cross_db_utils\last_day.sql
2021-02-18 02:24:40.654924 (MainThread): Parsing macros\cross_db_utils\length.sql
2021-02-18 02:24:40.655888 (MainThread): Parsing macros\cross_db_utils\literal.sql
2021-02-18 02:24:40.657004 (MainThread): Parsing macros\cross_db_utils\position.sql
2021-02-18 02:24:40.658910 (MainThread): Parsing macros\cross_db_utils\replace.sql
2021-02-18 02:24:40.659969 (MainThread): Parsing macros\cross_db_utils\right.sql
2021-02-18 02:24:40.662743 (MainThread): Parsing macros\cross_db_utils\safe_cast.sql
2021-02-18 02:24:40.666012 (MainThread): Parsing macros\cross_db_utils\split_part.sql
2021-02-18 02:24:40.669052 (MainThread): Parsing macros\cross_db_utils\_is_relation.sql
2021-02-18 02:24:40.671062 (MainThread): Parsing macros\datetime\date_spine.sql
2021-02-18 02:24:40.676037 (MainThread): Parsing macros\geo\haversine_distance.sql
2021-02-18 02:24:40.677050 (MainThread): Parsing macros\materializations\insert_by_period_materialization.sql
2021-02-18 02:24:40.707084 (MainThread): Parsing macros\schema_tests\at_least_one.sql
2021-02-18 02:24:40.709112 (MainThread): Parsing macros\schema_tests\cardinality_equality.sql
2021-02-18 02:24:40.712163 (MainThread): Parsing macros\schema_tests\equality.sql
2021-02-18 02:24:40.716051 (MainThread): Parsing macros\schema_tests\equal_rowcount.sql
2021-02-18 02:24:40.718045 (MainThread): Parsing macros\schema_tests\expression_is_true.sql
2021-02-18 02:24:40.719043 (MainThread): Parsing macros\schema_tests\not_constant.sql
2021-02-18 02:24:40.720040 (MainThread): Parsing macros\schema_tests\recency.sql
2021-02-18 02:24:40.722126 (MainThread): Parsing macros\sql\generate_series.sql
2021-02-18 02:24:40.727148 (MainThread): Parsing macros\sql\get_column_values.sql
2021-02-18 02:24:40.730844 (MainThread): Parsing macros\sql\get_tables_by_prefix.sql
2021-02-18 02:24:40.733571 (MainThread): Parsing macros\sql\get_tables_by_prefix_sql.sql
2021-02-18 02:24:40.737429 (MainThread): Parsing macros\sql\groupby.sql
2021-02-18 02:24:40.738343 (MainThread): Parsing macros\sql\nullcheck.sql
2021-02-18 02:24:40.740338 (MainThread): Parsing macros\sql\nullcheck_table.sql
2021-02-18 02:24:40.740951 (MainThread): Parsing macros\sql\pivot.sql
2021-02-18 02:24:40.744824 (MainThread): Parsing macros\sql\star.sql
2021-02-18 02:24:40.747419 (MainThread): Parsing macros\sql\surrogate_key.sql
2021-02-18 02:24:40.749397 (MainThread): Parsing macros\sql\union.sql
2021-02-18 02:24:40.759231 (MainThread): Parsing macros\sql\unpivot.sql
2021-02-18 02:24:40.763968 (MainThread): Parsing macros\web\get_url_host.sql
2021-02-18 02:24:40.765928 (MainThread): Parsing macros\web\get_url_parameter.sql
2021-02-18 02:24:40.767939 (MainThread): Parsing macros\web\get_url_path.sql
2021-02-18 02:24:40.775904 (MainThread): * Deprecation Warning: dbt v0.17.0 introduces a new config format for the
dbt_project.yml file. Support for the existing version 1 format will be removed
in a future release of dbt. The following packages are currently configured with
config version 1:
 - dbtpoc
 - dbt_utils

For upgrading instructions, consult the documentation:
  https://docs.getdbt.com/docs/guides/migration-guide/upgrading-to-0-17-0

2021-02-18 02:24:40.777897 (MainThread): Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '930004db-0a42-4a69-9554-d867f6b312d7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892B688AC8>]}
2021-02-18 02:24:40.779893 (MainThread): Partial parsing not enabled
2021-02-18 02:24:40.838813 (MainThread): Acquiring new snowflake connection "model.dbtpoc.DimSupplier".
2021-02-18 02:24:40.856990 (MainThread): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:41.161193 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 254 macros, 0 operations, 0 seed files, 0 sources
2021-02-18 02:24:41.162676 (MainThread): 
2021-02-18 02:24:41.163658 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:24:41.166098 (ThreadPoolExecutor-0_0): Acquiring new snowflake connection "list_DBT_POC".
2021-02-18 02:24:41.187501 (ThreadPoolExecutor-0_0): Using snowflake connection "list_DBT_POC".
2021-02-18 02:24:41.187501 (ThreadPoolExecutor-0_0): On list_DBT_POC: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC"} */

    show terse schemas in database DBT_POC
    limit 10000
2021-02-18 02:24:41.187501 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-02-18 02:24:42.319683 (ThreadPoolExecutor-0_0): SQL status: SUCCESS 5 in 1.13 seconds
2021-02-18 02:24:42.328802 (ThreadPoolExecutor-0_0): On list_DBT_POC: Close
2021-02-18 02:24:42.578367 (ThreadPoolExecutor-1_0): Acquiring new snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:24:42.597437 (ThreadPoolExecutor-1_0): Using snowflake connection "list_DBT_POC_dbt_jkolpak".
2021-02-18 02:24:42.597437 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "connection_name": "list_DBT_POC_dbt_jkolpak"} */

    show terse objects in DBT_POC.dbt_jkolpak
2021-02-18 02:24:42.597437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2021-02-18 02:24:43.668015 (ThreadPoolExecutor-1_0): SQL status: SUCCESS 6 in 1.07 seconds
2021-02-18 02:24:43.680956 (ThreadPoolExecutor-1_0): On list_DBT_POC_dbt_jkolpak: Close
2021-02-18 02:24:43.912364 (MainThread): Using snowflake connection "master".
2021-02-18 02:24:43.912364 (MainThread): On master: BEGIN
2021-02-18 02:24:43.913353 (MainThread): Opening a new connection, currently in state init
2021-02-18 02:24:44.713206 (MainThread): SQL status: SUCCESS 1 in 0.80 seconds
2021-02-18 02:24:44.714166 (MainThread): On master: COMMIT
2021-02-18 02:24:44.714166 (MainThread): Using snowflake connection "master".
2021-02-18 02:24:44.714166 (MainThread): On master: COMMIT
2021-02-18 02:24:45.328465 (MainThread): SQL status: SUCCESS 1 in 0.61 seconds
2021-02-18 02:24:45.329043 (MainThread): On master: Close
2021-02-18 02:24:45.560411 (MainThread): 20:24:45 | Concurrency: 16 threads (target='dev')
2021-02-18 02:24:45.561253 (MainThread): 20:24:45 | 
2021-02-18 02:24:45.569228 (Thread-1): Began running node model.dbtpoc.FactLineItem
2021-02-18 02:24:45.571914 (Thread-1): 20:24:45 | 1 of 1 START incremental model dbt_jkolpak.FactLineItem.............. [RUN]
2021-02-18 02:24:45.574872 (Thread-1): Acquiring new snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:45.574872 (Thread-1): Compiling model.dbtpoc.FactLineItem
2021-02-18 02:24:45.612150 (Thread-1): Writing injected SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:24:45.614144 (Thread-1): finished collecting timing info
2021-02-18 02:24:45.667281 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:45.667281 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    

      create or replace temporary table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp  as
      (

SELECT L_ORDERKEY AS ORDER_KEY
    , L_LINENUMBER AS LINE_NUMBER
    , CONCAT(L_ORDERKEY, L_LINENUMBER) AS LINE_ORDER_KEY
    , L_QUANTITY AS QUANTITY
    , L_EXTENDEDPRICE AS EXTENDED_PRICE
    , L_DISCOUNT AS LINE_DISCOUNT
    , L_TAX AS LINE_TAX
    , CASE L_RETURNFLAG
        WHEN 'R' THEN 'Returned'
        WHEN 'A' THEN 'Available for Return'
        WHEN 'N' THEN 'Not Available for Return'
      END AS LINE_RETURN_FLAG  
    , L_SHIPDATE AS LINE_SHIP_DATE
    , L_RECEIPTDATE AS LINE_RECEIPT_DATE
    , L_COMMITDATE AS LINE_COMMITDATE
    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG
    , L_PARTKEY AS LINE_PART_KEY
    , L_SUPPKEY AS LINE_SUPPLIER_KEY 
FROM "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF1"."LINEITEM" L
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."PART" P ON L.L_PARTKEY = P.P_PARTKEY
LEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_KEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."ORDERS" O ON L.L_ORDERKEY = O.O_ORDERKEY
LEFT JOIN "SNOWFLAKE_SAMPLE_DATA"."TPCH_SF10"."CUSTOMER" C ON O.O_CUSTKEY = C.C_CUSTKEY



  -- this filter will only be applied on an incremental run
WHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)


      );
2021-02-18 02:24:45.667281 (Thread-1): Opening a new connection, currently in state init
2021-02-18 02:24:47.738951 (Thread-1): SQL status: SUCCESS 1 in 2.07 seconds
2021-02-18 02:24:47.753903 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:47.755041 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp
2021-02-18 02:24:47.926898 (Thread-1): SQL status: SUCCESS 14 in 0.17 seconds
2021-02-18 02:24:47.935484 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:47.935484 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:24:48.117923 (Thread-1): SQL status: SUCCESS 14 in 0.18 seconds
2021-02-18 02:24:48.123360 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:48.123360 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

    describe table DBT_POC.dbt_jkolpak.FactLineItem
2021-02-18 02:24:48.324287 (Thread-1): SQL status: SUCCESS 14 in 0.20 seconds
2021-02-18 02:24:48.363431 (Thread-1): Writing runtime SQL for node "model.dbtpoc.FactLineItem"
2021-02-18 02:24:48.366449 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:48.366449 (Thread-1): On model.dbtpoc.FactLineItem: BEGIN
2021-02-18 02:24:48.607860 (Thread-1): SQL status: SUCCESS 1 in 0.24 seconds
2021-02-18 02:24:48.608855 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:48.608855 (Thread-1): On model.dbtpoc.FactLineItem: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "dbtpoc", "target_name": "dev", "node_id": "model.dbtpoc.FactLineItem"} */

        
        
    

    

    merge into DBT_POC.dbt_jkolpak.FactLineItem as DBT_INTERNAL_DEST
        using DBT_POC.dbt_jkolpak.FactLineItem__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
            DBT_INTERNAL_SOURCE.LINE_ORDER_KEY = DBT_INTERNAL_DEST.LINE_ORDER_KEY
        

    
    when matched then update set
        "ORDER_KEY" = DBT_INTERNAL_SOURCE."ORDER_KEY","LINE_NUMBER" = DBT_INTERNAL_SOURCE."LINE_NUMBER","LINE_ORDER_KEY" = DBT_INTERNAL_SOURCE."LINE_ORDER_KEY","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","EXTENDED_PRICE" = DBT_INTERNAL_SOURCE."EXTENDED_PRICE","LINE_DISCOUNT" = DBT_INTERNAL_SOURCE."LINE_DISCOUNT","LINE_TAX" = DBT_INTERNAL_SOURCE."LINE_TAX","LINE_RETURN_FLAG" = DBT_INTERNAL_SOURCE."LINE_RETURN_FLAG","LINE_SHIP_DATE" = DBT_INTERNAL_SOURCE."LINE_SHIP_DATE","LINE_RECEIPT_DATE" = DBT_INTERNAL_SOURCE."LINE_RECEIPT_DATE","LINE_COMMITDATE" = DBT_INTERNAL_SOURCE."LINE_COMMITDATE","SHIP_RECEIPT_LAG" = DBT_INTERNAL_SOURCE."SHIP_RECEIPT_LAG","LINE_PART_KEY" = DBT_INTERNAL_SOURCE."LINE_PART_KEY","LINE_SUPPLIER_KEY" = DBT_INTERNAL_SOURCE."LINE_SUPPLIER_KEY"
    

    when not matched then insert
        ("ORDER_KEY", "LINE_NUMBER", "LINE_ORDER_KEY", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
    values
        ("ORDER_KEY", "LINE_NUMBER", "LINE_ORDER_KEY", "QUANTITY", "EXTENDED_PRICE", "LINE_DISCOUNT", "LINE_TAX", "LINE_RETURN_FLAG", "LINE_SHIP_DATE", "LINE_RECEIPT_DATE", "LINE_COMMITDATE", "SHIP_RECEIPT_LAG", "LINE_PART_KEY", "LINE_SUPPLIER_KEY")
2021-02-18 02:24:49.322462 (Thread-1): SQL status: SUCCESS 0 in 0.71 seconds
2021-02-18 02:24:49.324285 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:24:49.325163 (Thread-1): Using snowflake connection "model.dbtpoc.FactLineItem".
2021-02-18 02:24:49.325163 (Thread-1): On model.dbtpoc.FactLineItem: COMMIT
2021-02-18 02:24:49.627621 (Thread-1): SQL status: SUCCESS 1 in 0.30 seconds
2021-02-18 02:24:49.659563 (Thread-1): finished collecting timing info
2021-02-18 02:24:49.659694 (Thread-1): On model.dbtpoc.FactLineItem: Close
2021-02-18 02:24:50.034095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '930004db-0a42-4a69-9554-d867f6b312d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892BD8AE48>]}
2021-02-18 02:24:50.037208 (Thread-1): 20:24:50 | 1 of 1 OK created incremental model dbt_jkolpak.FactLineItem......... [SUCCESS 0 in 4.46s]
2021-02-18 02:24:50.039083 (Thread-1): Finished running node model.dbtpoc.FactLineItem
2021-02-18 02:24:50.113039 (MainThread): Acquiring new snowflake connection "master".
2021-02-18 02:24:50.114037 (MainThread): Using snowflake connection "master".
2021-02-18 02:24:50.114037 (MainThread): On master: BEGIN
2021-02-18 02:24:50.114037 (MainThread): Opening a new connection, currently in state closed
2021-02-18 02:24:50.990416 (MainThread): SQL status: SUCCESS 1 in 0.88 seconds
2021-02-18 02:24:50.990416 (MainThread): On master: COMMIT
2021-02-18 02:24:50.991411 (MainThread): Using snowflake connection "master".
2021-02-18 02:24:50.991411 (MainThread): On master: COMMIT
2021-02-18 02:24:51.398983 (MainThread): SQL status: SUCCESS 1 in 0.41 seconds
2021-02-18 02:24:51.398983 (MainThread): On master: Close
2021-02-18 02:24:51.621493 (MainThread): 20:24:51 | 
2021-02-18 02:24:51.622027 (MainThread): 20:24:51 | Finished running 1 incremental model in 10.46s.
2021-02-18 02:24:51.623292 (MainThread): Connection 'master' was properly closed.
2021-02-18 02:24:51.623292 (MainThread): Connection 'list_DBT_POC' was properly closed.
2021-02-18 02:24:51.624210 (MainThread): Connection 'list_DBT_POC_dbt_jkolpak' was properly closed.
2021-02-18 02:24:51.624210 (MainThread): Connection 'model.dbtpoc.FactLineItem' was properly closed.
2021-02-18 02:24:51.630838 (MainThread): 
2021-02-18 02:24:51.634038 (MainThread): Completed successfully
2021-02-18 02:24:51.635024 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-02-18 02:24:51.636021 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892BCA1A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892BCB5808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002892BE16C48>]}
2021-02-18 02:24:51.636021 (MainThread): Flushing usage events
