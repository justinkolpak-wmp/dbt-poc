{"results": [{"node": {"raw_sql": "{{ config(materialized='table') }}\r\n\r\nSELECT S_SUPPKEY AS SUPPLIER_KEY\r\n    , S_NAME AS SUPPLIER_NAME\r\n    , S_ADDRESS AS SUPPLIER_ADDRESS\r\n    , S_PHONE AS SUPPLIER_PHONE_NUMBER\r\n    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE\r\n    , S_COMMENT AS SUPPLIER_COMMENT\r\n    , N.N_NAME AS SUPPLIER_NATION\r\n    , R.R_NAME AS SUPPLIER_REGION\r\nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"SUPPLIER\" S\r\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"NATION\" N ON S.S_NATIONKEY = N.N_NATIONKEY\r\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"REGION\" R ON N.N_REGIONKEY = R.R_REGIONKEY", "compiled": true, "database": "DBT_POC", "schema": "dbt_jkolpak", "fqn": ["dbtpoc", "DimSupplier"], "unique_id": "model.dbtpoc.DimSupplier", "package_name": "dbtpoc", "root_path": "C:\\Users\\jkolpak\\dbt-venv\\dbt-poc", "path": "DimSupplier.sql", "original_file_path": "models\\DimSupplier.sql", "name": "DimSupplier", "resource_type": "model", "alias": "DimSupplier", "checksum": {"name": "sha256", "checksum": "8842e819095792cd011a3d922c7d9576406f422da855c1916ae27fe28bf4156a"}, "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [], "sources": [], "depends_on": {"macros": ["macro.dbt_snowflake.set_query_tag", "macro.dbt.run_hooks", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": []}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\run\\dbtpoc\\models\\DimSupplier.sql", "deferred": false, "compiled_sql": "\n\nSELECT S_SUPPKEY AS SUPPLIER_KEY\n    , S_NAME AS SUPPLIER_NAME\n    , S_ADDRESS AS SUPPLIER_ADDRESS\n    , S_PHONE AS SUPPLIER_PHONE_NUMBER\n    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE\n    , S_COMMENT AS SUPPLIER_COMMENT\n    , N.N_NAME AS SUPPLIER_NATION\n    , R.R_NAME AS SUPPLIER_REGION\nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"SUPPLIER\" S\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"NATION\" N ON S.S_NATIONKEY = N.N_NATIONKEY\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"REGION\" R ON N.N_REGIONKEY = R.R_REGIONKEY", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT S_SUPPKEY AS SUPPLIER_KEY\n    , S_NAME AS SUPPLIER_NAME\n    , S_ADDRESS AS SUPPLIER_ADDRESS\n    , S_PHONE AS SUPPLIER_PHONE_NUMBER\n    , S_ACCTBAL AS SUPPLIER_ACCOUNT_BALANCE\n    , S_COMMENT AS SUPPLIER_COMMENT\n    , N.N_NAME AS SUPPLIER_NATION\n    , R.R_NAME AS SUPPLIER_REGION\nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"SUPPLIER\" S\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"NATION\" N ON S.S_NATIONKEY = N.N_NATIONKEY\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"REGION\" R ON N.N_REGIONKEY = R.R_REGIONKEY"}, "error": null, "status": "SUCCESS 1", "execution_time": 4.032433032989502, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2021-02-18T01:44:29.424532Z", "completed_at": "2021-02-18T01:44:29.454579Z"}, {"name": "execute", "started_at": "2021-02-18T01:44:29.454579Z", "completed_at": "2021-02-18T01:44:33.225875Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(materialized='incremental') }}\r\n\r\nSELECT L_ORDERKEY AS ORDER_KEY\r\n    , L_LINENUMBER AS LINE_NUMBER\r\n    , L_QUANTITY AS QUANTITY\r\n    , L_EXTENDEDPRICE AS EXTENDED_PRICE\r\n    , L_DISCOUNT AS LINE_DISCOUNT\r\n    , L_TAX AS LINE_TAX\r\n    , CASE L_RETURNFLAG\r\n        WHEN 'R' THEN 'Returned'\r\n        WHEN 'A' THEN 'Available for Return'\r\n        WHEN 'N' THEN 'Not Available for Return'\r\n      END AS LINE_RETURN_FLAG  \r\n    , L_SHIPDATE AS LINE_SHIP_DATE\r\n    , L_RECEIPTDATE AS LINE_RECEIPT_DATE\r\n    , L_COMMITDATE AS LINE_COMMITDATE\r\n    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG\r\n    , L_PARTKEY AS LINE_PART_KEY\r\n    , L_SUPPKEY AS LINE_SUPPLIER_KEY \r\nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF1\".\"LINEITEM\" L\r\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"PART\" P ON L.L_PARTKEY = P.P_PARTKEY\r\nLEFT JOIN {{ref('DimSupplier')}} S ON L.L_SUPPKEY = S.SUPPLIER_NAME\r\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"ORDERS\" O ON L.L_ORDERKEY = O.O_ORDERKEY\r\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"CUSTOMER\" C ON O.O_CUSTKEY = C.C_CUSTKEY\r\n\r\n{% if is_incremental() %}\r\n\r\n  -- this filter will only be applied on an incremental run\r\nWHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from {{ this }})\r\n\r\n{% endif %}", "compiled": true, "database": "DBT_POC", "schema": "dbt_jkolpak", "fqn": ["dbtpoc", "FactLineItem"], "unique_id": "model.dbtpoc.FactLineItem", "package_name": "dbtpoc", "root_path": "C:\\Users\\jkolpak\\dbt-venv\\dbt-poc", "path": "FactLineItem.sql", "original_file_path": "models\\FactLineItem.sql", "name": "FactLineItem", "resource_type": "model", "alias": "FactLineItem", "checksum": {"name": "sha256", "checksum": "b4edd100c2b86c343fe692b42876526f5880a09800ee503b0e1cd3feb8554347"}, "config": {"enabled": true, "materialized": "incremental", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "alias": null, "schema": null, "database": null, "tags": [], "full_refresh": null, "transient": true}, "tags": [], "refs": [["DimSupplier"]], "sources": [], "depends_on": {"macros": ["macro.dbt.is_incremental", "macro.dbt_snowflake.set_query_tag", "macro.dbt.should_full_refresh", "macro.dbt.load_relation", "macro.dbt.make_temp_relation", "macro.dbt_snowflake.dbt_snowflake_validate_get_incremental_strategy", "macro.dbt.run_hooks", "macro.dbt.create_table_as", "macro.dbt.run_query", "macro.dbt_snowflake.dbt_snowflake_get_incremental_sql", "macro.dbt.statement", "macro.dbt.persist_docs", "macro.dbt_snowflake.unset_query_tag"], "nodes": ["model.dbtpoc.DimSupplier"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target\\run\\dbtpoc\\models\\FactLineItem.sql", "deferred": false, "compiled_sql": "\n\nSELECT L_ORDERKEY AS ORDER_KEY\n    , L_LINENUMBER AS LINE_NUMBER\n    , L_QUANTITY AS QUANTITY\n    , L_EXTENDEDPRICE AS EXTENDED_PRICE\n    , L_DISCOUNT AS LINE_DISCOUNT\n    , L_TAX AS LINE_TAX\n    , CASE L_RETURNFLAG\n        WHEN 'R' THEN 'Returned'\n        WHEN 'A' THEN 'Available for Return'\n        WHEN 'N' THEN 'Not Available for Return'\n      END AS LINE_RETURN_FLAG  \n    , L_SHIPDATE AS LINE_SHIP_DATE\n    , L_RECEIPTDATE AS LINE_RECEIPT_DATE\n    , L_COMMITDATE AS LINE_COMMITDATE\n    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG\n    , L_PARTKEY AS LINE_PART_KEY\n    , L_SUPPKEY AS LINE_SUPPLIER_KEY \nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF1\".\"LINEITEM\" L\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"PART\" P ON L.L_PARTKEY = P.P_PARTKEY\nLEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"ORDERS\" O ON L.L_ORDERKEY = O.O_ORDERKEY\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"CUSTOMER\" C ON O.O_CUSTKEY = C.C_CUSTKEY\n\n\n\n  -- this filter will only be applied on an incremental run\nWHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\nSELECT L_ORDERKEY AS ORDER_KEY\n    , L_LINENUMBER AS LINE_NUMBER\n    , L_QUANTITY AS QUANTITY\n    , L_EXTENDEDPRICE AS EXTENDED_PRICE\n    , L_DISCOUNT AS LINE_DISCOUNT\n    , L_TAX AS LINE_TAX\n    , CASE L_RETURNFLAG\n        WHEN 'R' THEN 'Returned'\n        WHEN 'A' THEN 'Available for Return'\n        WHEN 'N' THEN 'Not Available for Return'\n      END AS LINE_RETURN_FLAG  \n    , L_SHIPDATE AS LINE_SHIP_DATE\n    , L_RECEIPTDATE AS LINE_RECEIPT_DATE\n    , L_COMMITDATE AS LINE_COMMITDATE\n    , L_RECEIPTDATE - L_SHIPDATE AS SHIP_RECEIPT_LAG\n    , L_PARTKEY AS LINE_PART_KEY\n    , L_SUPPKEY AS LINE_SUPPLIER_KEY \nFROM \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF1\".\"LINEITEM\" L\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"PART\" P ON L.L_PARTKEY = P.P_PARTKEY\nLEFT JOIN DBT_POC.dbt_jkolpak.DimSupplier S ON L.L_SUPPKEY = S.SUPPLIER_NAME\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"ORDERS\" O ON L.L_ORDERKEY = O.O_ORDERKEY\nLEFT JOIN \"SNOWFLAKE_SAMPLE_DATA\".\"TPCH_SF10\".\"CUSTOMER\" C ON O.O_CUSTKEY = C.C_CUSTKEY\n\n\n\n  -- this filter will only be applied on an incremental run\nWHERE L_RECEIPTDATE > (select max(LINE_RECEIPT_DATE ) from DBT_POC.dbt_jkolpak.FactLineItem)\n\n"}, "error": null, "status": "SUCCESS 0", "execution_time": 5.55477499961853, "thread_id": "Thread-3", "timing": [{"name": "compile", "started_at": "2021-02-18T01:44:33.467006Z", "completed_at": "2021-02-18T01:44:33.489275Z"}, {"name": "execute", "started_at": "2021-02-18T01:44:33.490307Z", "completed_at": "2021-02-18T01:44:38.739387Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2021-02-18T01:44:40.874628Z", "elapsed_time": 15.945359706878662}